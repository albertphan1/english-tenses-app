<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Fun English - H·ªçc vui m·ªói ng√†y!</title>
  <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAIAAACyr5FlAAAL6klEQVR4nO3de3BU1R0H8N/ZRzbvJwSI0YBoEMJDQKkhLSBiQWvHWrQqsdoRWu3Y1qmDj7Gt07GKogw+ptppxTojw9SqLYqP+n6gVlChPEI0RgOBhJAlJGSz2SSb3T39g8Busvs7u0nu3nt39/uZ/JHkPs7v3vu755x77t274hf3OAkgEpuU0ugYwKQsRgcA5oXkABaSA1g2QpcDGKg5gIXkABaSA1hIDmDZCINgwEDNASwkB7BsaFSAg0EwYKFZARaSA1hIDmAhOYCFQTBgoeYAFpIDWEgOYGEQDFioOYCF5AAWbrwBCzUHsDAIBizUHMBCcgALyQEsDIIBCzUHsJAcwEJyAAvJASwMggELNQewcOMNWDady3vgzuLiIo0LfXOr+/lXXdquEyhJBsEkJcNWmA/6HMBCcgALyQEsJAewkmUQLDm2wmRQcwBL73EOtR17ep58tt3oKGCAuZIjpVgsNOOc9HMr0stK08YWWtMdlt6+gMsdaHH69tT27trX43IHjI3QfINgWsSz8pqC+ednclPvf/xoQ6N3xIvf87Cz+Uh/xEmzpqX/ZmURt+CWt7peftNFREJQ1fmZly/NLcy3hs6QmWHJzLCMH2ubXZF+zeV5r7/X9eb77n6fYUcINYfe8nKsq1YUTCt3qGdzpIkrluVWlDse3XCsr8+Y/LDIk6PP+vxEpU9Bo1l8NAuOK7b97taxUTPjlPIzHbeuLCKh6zE69ZOKVytGXfaOLbTe8csxRQXW6LOGmDLZcdF3s+MUklpKJodB5c4/LzM/d3iZccLyS3Iz0oXm8URlvkEwHeKRcnSl8IvHJ3iHQ8yblfHhtu54rFzBXB3SuTMz/r6+dFiLbP6P65W3h/cwh9lOh1hUzs1M9eTQh+Ffpevzy3c/dm/f2dN61BeQ8owS+9JFOXNmZCgWmVSWZrFQQN+Bj9RMDiNLd7kD6/5ytKklOFJSv99bv//YtT/Kv3gB2/G020TJOHvoUjqwGHCFpLlhFiEDcbsOjiYQoMeeams63B++7AuvdLq7VTXDhGKbzkcqFa9WDLR1W/f+g5EHZ30++dU3fYplMzP0PlipmBwGNivvf+JWTG1pVbUa6Q4kR/wZlRvHOvyHDqsOv7pZSXfoPdSRislhlEPNqrt9RNTrVeat7sNg5hoE27G754ln2jRYkXqjog6CjXhx5XLtx/3qNfvVN2Cl3i2iuT7xFqermYgFKVitqpNUEaR6tZ6egHoGf5TpejeIqdisqI89EWVkxKUG9/ujzGCmSpwoNZPDFm3kryAvFccGwyXnk2DqU9CRZlGUYrOKkvHK5BhxuxJ1hlEurrXkrDm8/aq9mJut2urpU9Nt0dqdFJGcydHToxowKBlnV0xdND9L63ASVXImh0eZHDMr0rlJ507PmFWhujuaUpIzOVqcPsXUstK0JZHuf5ZPdtx8PfvseAoy1yDYqJ/RGtB4SHUHi4iqlxecXmJ/7yN3S2u/3S5Kxtvnz8taWJktYulsqII0aPAtPpLzmq29w9/e4S9UPsq7oDJ7QaUxD+4miuRsVojo0y/0fqgu+SRtcny0zW2qBjMR6f4kWFQaFdTq9L39QdcI9khzS//ump6RRziarYtK34OVtJ94k0T/evW4+vGZcAebvA/92dmlfK5CEeToN02fPRPjT9I2K0TU55UPPu5sjvmh3O07PWsedXa6ot0fSxnJebVySqfLf98jrZcvy1uyMFsxKH7E2f/Cls4duz16xmZ+4oZfNRodgx4KC6xzZmbOnJY+bqw9N9uS5rD09gacbb6GA3079/bU1vWi9xpO3HDLAaNjAJNK5j4HjBKSA1hIDmCZ70kwMA3UHMBCcgALyQEsJAewbIa/5gZMCzUHsJAcwEJyAAuDYMBCzQGsJH/YZzT+9FtxRsnA77X1tPZvMpZJWhVhBsYkx41XiYXzos/2zn9p42Zz7a+UgmYFWAZ+HDKGTx7q/gHAwUIjHBKJYpJWRRjPFH2OdRvk3q/MtV/U/rDe4G9f0weaFWCZ5W2CsYRx322WU337ffVy7V/ljClicSWdVSayM8ntoboGueVdefBwhGXnThdLqmhiqUizU0cn1XwtX/9ACkEP3xU8PTZulm9/EjmQIZ84Co8kdObp5aJqLk0qFYX5ZLeTp4eOu6itQzYcon1fy4ZDkb/84EQRsW+RDgwaBJNhfw4zDLtN3HwtzZ8bbLPzcmjeLDG7QqzfIPfVB1cnBK38iVgwLzhncREtrhQLzheb3worVRFGbJNWXT2oLCLKyaKcLDp9gpg9jZYvFeuflrtqI6wr9i3SjSn6HKt/LiL2T2+5J9DFfFa+fBKVT4qwiN1GK68Wq9fIU2fnFd8ferROsNnoqks1fvfXnIrIZcUi9i3SjSmSY2S6PfT083JPnRw/hm6utpSOH/j/mAI6eyLVNRARFeTRDy8K7vHePnrmRbmjRmY4aNlC8YMLNU6OGecEf6+pkxtfkkfbKc1GeblUVCCmTqaKcqE4xrFskZ4SuEO6cbP8Yq/0eungYXrulUG1bumEgaNeNVdYQ97g8u835Kc7pddLnV30z1dlTZ3GdbUjLfj7gWZqcZLPR55eanFSTZ184XX5x0cDe/jrsli2SE+mqDnWPSUVuywiTw9t2xVcpLVNhjZMWSffCHf2xEFLbf18UCkfbKfpU4YXqtrh1uDvly0WlbNF0xHZ2kYtR+nAIXmgWfUS4xi3SE9GDYINPg9iHewK7i/nMRnwBxfxDv4+AiEGVpifGyyou4c8nkGlONsGRzI0DDl0arRJH26XSxdY83IG/l1UQEUFp2YT3R56f5vc/Eag3xdhPTFukZ4StVnpHvx6lZg6a2H7NqbXww1Hl5vufcy/fZf0RaohsjLpssVi1TWR9/lItijOTNGsxM/xkC8VzcqkdAf1hrxncGyh9iUebacnng040mhymThtHBWPEROK6ZwzRdrJ7sgFs8Wml8il+sYms0jy5KjfL2dXBOuHqvPEuyHDXIsuiFcvr89LtfWytp5O1FcTS8W9tw1UGEJQ8Rjhcptk9FElUQfBhi4SvrgkIvrkC7n8Ejp1wXLVpRZXV2B3rUx30LJFlulTwpKDC0MRYciki6rEvHNFTZ2s30/HXdLlpj4v5ecOGtoiIo9HRg44hi3SkylqjtU3RW6GnW20+v5RvYSpo5O2vCOvWDpwbDIz6Nc/i2M3y2ajqWeJqWepKqTmI4MuaswsUTuksXv5rcDWzyKcdD4fvfjaoF6fDlcDHZ305LMm6GrGxiw33jgx3utQNFP+AD31j8D/9oklVWLS6SLNTu2dVFMnX3svkJstrgxZqtsz2lsr73wsGw4Gpkym8kliTAHl5oisTPL7yeWm5iNy95fyo89kL//m7Ri3SDfiulXf6l6oWVz/Y8vF3ws2Ab9fF2hsNvnJoiuTvRg/DvJy6PabrJ/vkfu+lu3HZWcX2W102nix8DviwvnBzGhqkY1NCVPh68MUHdL4ElRWKspKxZWXsrN4vbThOWTGUCmQHNE0H5Ebngt825jkNegIJH9ydLro7of8cyrEtHJRVED5ucJqpd5eauuQjU1yx16550vpR60Ribjuxm+MjgFMKvnHOWDEkBzAQnIAC8kBrOQfBIMRQ80BLLPfeAMDoeYAFt4JBizUHMBCcgALyQEsJAewMAgGLNQcwEJyAAvJASwMggELNQewcOMNWMn/9HmMNt15e+if1WsfNioS80CzQhSWGRH/k4LEip/Wab7STXfdEfpn9YMPaV6EhoZEGyqxItc8Wu1rjvB9rdj7hlPHlliRax6txsnBxWfmvZyI9NnPWiZH4p6FiUW3/azvIFgiXjencMy4WgFWqidH9QOqHr56atJL9eQgPgNSPDNI2+RI3LMwPLbEijb2qcMiVlR/pdW6Tth0953h/6xes1bbUkCH/WyRJ19jqNXPirD4VqxZq3kp+NFhP4trta45IGmgQwosPAkGLNQcwEJyAAvJASwkB7DwcUhgoeYAFpIDWEgOYGEQDFj4xBuw0KwAC8kBLCQHsDAIBizUHMBCcgALyQEsDIIBCzUHsJAcwEJyAOv/Jmy8S5nchcUAAAAASUVORK5CYII=">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Fun English">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Nunito', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    .app-container { max-width: 500px; margin: 0 auto; min-height: 100vh; }
    
    /* Backgrounds for different themes */
    .bg-sunny { background: linear-gradient(180deg, #87CEEB 0%, #98D8C8 100%); }
    .bg-night { background: linear-gradient(180deg, #2C3E50 0%, #4A569D 100%); }
    .bg-park { background: linear-gradient(180deg, #87CEEB 0%, #90EE90 100%); }
    .bg-home { background: linear-gradient(180deg, #FFB6C1 0%, #FFECD2 100%); }
    .bg-school { background: linear-gradient(180deg, #87CEEB 0%, #DDA0DD 100%); }
    .bg-fun { background: linear-gradient(180deg, #667eea 0%, #764ba2 100%); }
    
    .screen { display: none; min-height: 100vh; padding: 20px; }
    .screen.active { display: block; }
    
    /* Sound toggle */
    .sound-toggle {
      position: fixed; top: 15px; right: 15px; width: 45px; height: 45px;
      border-radius: 50%; border: none; background: rgba(255,255,255,0.9);
      font-size: 1.3rem; cursor: pointer; z-index: 100;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    
    /* HOME SCREEN */
    .home-content { text-align: center; padding-top: 15px; }
    .mascot-large { font-size: 65px; animation: bounce 2s ease infinite; }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .app-title {
      font-size: 1.8rem; font-weight: 800; color: white;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2); margin: 8px 0 3px;
    }
    .app-tagline { color: rgba(255,255,255,0.9); font-size: 0.95rem; margin-bottom: 10px; }
    
    .topic-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
    .topic-card {
      background: white; border-radius: 15px; padding: 14px 10px;
      text-align: center; cursor: pointer; transition: all 0.3s;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      border: 3px solid transparent;
    }
    .topic-card:hover { transform: translateY(-3px); }
    .topic-card:active { transform: scale(0.95); }
    .topic-card .topic-icon { font-size: 32px; margin-bottom: 4px; }
    .topic-card .topic-name { font-size: 0.88rem; font-weight: 700; color: #333; }
    .topic-card.daily { border-color: #4CAF50; }
    .topic-card.yesterday { border-color: #FF9800; }
    .topic-card.stories { border-color: #E91E63; }
    .topic-card.games { border-color: #9C27B0; }
    .topic-card.quiz { border-color: #2196F3; }
    
    .streak-banner {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #5D4037; padding: 12px 20px; border-radius: 15px;
      margin-top: 25px; font-weight: 700;
      display: flex; align-items: center; justify-content: center; gap: 10px;
    }
    
    /* STORY SCREEN */
    .story-scene {
      background: white; border-radius: 25px; padding: 25px;
      margin-top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      min-height: 400px; position: relative;
    }
    .scene-image {
      font-size: 80px; text-align: center; margin-bottom: 20px;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    .scene-text {
      font-size: 1.4rem; text-align: center; color: #333;
      line-height: 1.6; margin-bottom: 25px;
    }
    .scene-text .highlight {
      background: linear-gradient(180deg, transparent 60%, #FFEB3B 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-green {
      background: linear-gradient(180deg, transparent 60%, #A5D6A7 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-orange {
      background: linear-gradient(180deg, transparent 60%, #FFCC80 60%);
      padding: 0 5px; font-weight: 700;
    }
    
    .scene-question {
      background: #FFF9C4; padding: 15px 20px; border-radius: 15px;
      text-align: center; font-size: 1.2rem; color: #5D4037;
      margin-bottom: 20px;
    }
    
    .choice-buttons { display: flex; flex-direction: column; gap: 12px; }
    .choice-btn {
      padding: 18px 25px; font-size: 1.2rem; font-weight: 600;
      border: 3px solid #E0E0E0; border-radius: 15px; background: white;
      cursor: pointer; font-family: 'Nunito', sans-serif; transition: all 0.2s;
      text-align: left;
    }
    .choice-btn:hover { border-color: #2196F3; background: #E3F2FD; }
    .choice-btn.correct {
      border-color: #4CAF50; background: #E8F5E9;
      animation: pulse 0.5s ease;
    }
    .choice-btn.wrong {
      border-color: #F44336; background: #FFEBEE;
      animation: shake 0.5s ease;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    .feedback-box {
      margin-top: 20px; padding: 15px; border-radius: 15px;
      text-align: center; animation: fadeIn 0.3s ease;
    }
    .feedback-box.correct { background: #E8F5E9; }
    .feedback-box.wrong { background: #FFF3E0; }
    .feedback-emoji { font-size: 30px; display: inline; vertical-align: middle; margin-right: 8px; }
    .feedback-text { font-size: 1.1rem; color: #333; margin-bottom: 10px; display: inline; vertical-align: middle; }
    .feedback-tip {
      background: white; padding: 12px 15px; border-radius: 10px;
      font-size: 1rem; color: #666; margin-bottom: 15px;
    }
    
    .next-btn {
      width: 100%; padding: 15px; font-size: 1.2rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif; transition: all 0.2s;
      background: linear-gradient(135deg, #667eea, #764ba2); color: white;
    }
    .next-btn:hover { transform: translateY(-2px); }
    
    /* Progress */
    .progress-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 15px;
    }
    .back-btn {
      background: rgba(255,255,255,0.9); border: none; padding: 10px 18px;
      border-radius: 25px; font-weight: 700; cursor: pointer;
      font-family: 'Nunito', sans-serif; color: #333;
    }
    .progress-dots { display: flex; gap: 5px; flex-wrap: nowrap; overflow: hidden; flex: 1; justify-content: center; margin: 0 10px; }
    .dot {
      width: 10px; height: 10px; min-width: 6px; border-radius: 50%;
      background: rgba(255,255,255,0.4); flex-shrink: 1;
    }
    .dot.active { background: white; }
    .dot.done { background: #4CAF50; }
    .star-count {
      background: rgba(255,255,255,0.9); padding: 8px 15px;
      border-radius: 20px; font-weight: 700; color: #FF9800;
    }
    
    /* RESULT SCREEN */
    .result-content { text-align: center; padding-top: 40px; }
    .result-card {
      background: white; border-radius: 25px; padding: 35px 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .result-emoji { font-size: 80px; margin-bottom: 15px; }
    .result-title { font-size: 1.8rem; font-weight: 800; color: #333; margin-bottom: 10px; }
    .result-stars { font-size: 45px; margin: 15px 0; }
    .result-message { font-size: 1.1rem; color: #666; margin-bottom: 25px; }
    .result-buttons { display: flex; flex-direction: column; gap: 12px; }
    .result-btn {
      padding: 15px 25px; font-size: 1.1rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif;
    }
    .result-btn.primary {
      background: linear-gradient(135deg, #4CAF50, #8BC34A); color: white;
    }
    .result-btn.secondary {
      background: #F5F5F5; color: #333;
    }
    
    /* LEARN SCREEN - Visual Patterns */
    .pattern-card {
      background: white; border-radius: 20px; padding: 25px;
      margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .pattern-title {
      display: flex; align-items: center; gap: 10px;
      font-size: 1.3rem; font-weight: 700; color: #333; margin-bottom: 20px;
    }
    .pattern-title .icon { font-size: 30px; }
    
    .example-row {
      display: flex; align-items: center; gap: 15px;
      padding: 15px; margin-bottom: 10px; border-radius: 12px;
      background: #F5F5F5;
    }
    .example-row .emoji { font-size: 35px; }
    .example-row .sentence { font-size: 1.1rem; color: #333; }
    .example-row .sentence strong { color: #4CAF50; }
    .example-row .sentence .past { color: #FF9800; }
    
    .tip-bubble {
      background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
      padding: 15px 20px; border-radius: 15px;
      display: flex; align-items: flex-start; gap: 12px;
      margin-top: 15px;
    }
    .tip-bubble .bulb { font-size: 25px; }
    .tip-bubble .tip-text { font-size: 1rem; color: #1565C0; }
    
    /* Visual comparison */
    .compare-box {
      display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
      margin: 20px 0;
    }
    .compare-side {
      padding: 20px 15px; border-radius: 15px; text-align: center;
    }
    .compare-side.now { background: #E8F5E9; }
    .compare-side.past { background: #FFF3E0; }
    .compare-side .label {
      font-weight: 700; margin-bottom: 10px; font-size: 1rem;
    }
    .compare-side.now .label { color: #2E7D32; }
    .compare-side.past .label { color: #E65100; }
    .compare-side .time-words {
      display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;
      margin-bottom: 12px;
    }
    .time-word {
      background: white; padding: 5px 12px; border-radius: 20px;
      font-size: 0.85rem; font-weight: 600;
    }
    .compare-side.now .time-word { color: #4CAF50; }
    .compare-side.past .time-word { color: #FF9800; }
    .compare-side .example {
      background: white; padding: 10px; border-radius: 10px;
      font-size: 0.95rem; color: #333;
    }
    
    /* Word cards for irregular verbs */
    .word-pairs { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .word-pair {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      background: #F5F5F5; padding: 12px; border-radius: 12px;
    }
    .word-pair .now { color: #4CAF50; font-weight: 700; }
    .word-pair .arrow { color: #999; }
    .word-pair .past { color: #FF9800; font-weight: 700; }
    .word-pair .meaning { color: #999; font-size: 0.85rem; }
    
    /* Matching game */
    .match-instruction {
      text-align: center; color: white; font-size: 1.1rem;
      margin-bottom: 20px; padding: 15px;
      background: rgba(255,255,255,0.2); border-radius: 15px;
    }
    .match-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
    }
    .match-card {
      padding: 18px 10px; border-radius: 15px; font-size: 1.1rem;
      font-weight: 700; cursor: pointer; text-align: center;
      font-family: 'Nunito', sans-serif; border: none;
      transition: all 0.2s;
    }
    .match-card.type-now { background: #E8F5E9; color: #2E7D32; }
    .match-card.type-past { background: #FFF3E0; color: #E65100; }
    .match-card.selected { transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    .match-card.matched { opacity: 0.5; cursor: default; }
    
    /* STUDY SCREEN STYLES */
    .study-header {
      text-align: center; padding: 15px 0; margin-bottom: 15px;
    }
    .study-title {
      font-size: 1.8rem; font-weight: 800; color: white;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    .study-subtitle { color: rgba(255,255,255,0.9); margin-top: 5px; }
    
    .group-selector {
      display: flex; flex-wrap: wrap; gap: 8px;
      justify-content: center; margin-bottom: 20px;
    }
    .group-btn {
      padding: 8px 16px; border-radius: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.15);
      color: white; font-weight: 600; cursor: pointer;
      font-family: 'Nunito', sans-serif; font-size: 0.85rem;
      transition: all 0.2s;
    }
    .group-btn:hover { background: rgba(255,255,255,0.25); }
    .group-btn.active {
      background: white; color: #667eea;
      border-color: white;
    }
    
    .verb-group-card {
      background: white; border-radius: 20px;
      margin-bottom: 15px; overflow: hidden;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .verb-group-header {
      padding: 15px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white; cursor: pointer;
      display: flex; justify-content: space-between; align-items: center;
    }
    .verb-group-header.expanded { border-radius: 0; }
    .verb-group-title {
      font-weight: 700; font-size: 1.1rem;
      display: flex; align-items: center; gap: 10px;
    }
    .verb-group-count {
      background: rgba(255,255,255,0.2);
      padding: 4px 12px; border-radius: 15px;
      font-size: 0.85rem;
    }
    .verb-group-arrow {
      transition: transform 0.3s;
      font-size: 1.2rem;
    }
    .verb-group-arrow.rotated { transform: rotate(180deg); }
    
    .verb-group-content {
      max-height: 0; overflow: hidden;
      transition: max-height 0.3s ease;
    }
    .verb-group-content.expanded {
      max-height: 2000px;
    }
    
    .verb-table {
      width: 100%; border-collapse: collapse;
    }
    .verb-table th {
      padding: 12px 10px;
      background: #f8f9fa;
      font-weight: 700; font-size: 0.85rem;
      color: #666; text-align: center;
      border-bottom: 2px solid #eee;
      position: sticky; top: 0;
    }
    .verb-table th:first-child { text-align: left; padding-left: 20px; }
    .verb-table td {
      padding: 12px 10px;
      border-bottom: 1px solid #f0f0f0;
      text-align: center; font-size: 0.95rem;
    }
    .verb-table td:first-child {
      text-align: left; padding-left: 20px;
      font-weight: 600; color: #4CAF50;
    }
    .verb-table td:nth-child(2) { color: #FF9800; font-weight: 600; }
    .verb-table td:nth-child(3) { color: #9C27B0; font-weight: 600; }
    .verb-table td:last-child { color: #666; font-size: 0.85rem; }
    
    .verb-table tr:hover { background: #f8f9fa; }
    .verb-table tr.mastered { background: #E8F5E9; }
    .verb-table tr.mastered td:first-child::before {
      content: '‚úì '; color: #4CAF50;
    }
    
    .study-tip-box {
      background: linear-gradient(135deg, #FFF9C4 0%, #FFECB3 100%);
      padding: 15px 20px; border-radius: 15px;
      margin-bottom: 20px;
      display: flex; align-items: flex-start; gap: 12px;
    }
    .study-tip-icon { font-size: 30px; }
    .study-tip-text { color: #5D4037; font-size: 0.95rem; line-height: 1.5; }
    
    .study-modes {
      display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
      margin-bottom: 20px;
    }
    .study-mode-btn {
      padding: 15px; border-radius: 15px;
      border: none; cursor: pointer;
      font-family: 'Nunito', sans-serif;
      font-weight: 700; font-size: 1rem;
      display: flex; flex-direction: column;
      align-items: center; gap: 5px;
      transition: all 0.2s;
    }
    .study-mode-btn:hover { transform: translateY(-3px); }
    .study-mode-btn .icon { font-size: 30px; }
    .study-mode-btn.quiz { background: #E3F2FD; color: #1565C0; }
    .study-mode-btn.practice { background: #E8F5E9; color: #2E7D32; }
    .study-mode-btn.speed { background: #FFF3E0; color: #E65100; }
    .study-mode-btn.memory { background: #F3E5F5; color: #7B1FA2; }
    
    /* Quick Quiz Modal */
    .quiz-overlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.7);
      display: flex; align-items: center; justify-content: center;
      z-index: 1000; padding: 20px;
    }
    .quiz-modal {
      background: white; border-radius: 25px;
      padding: 30px; max-width: 400px; width: 100%;
      text-align: center;
      animation: modalIn 0.3s ease;
    }
    @keyframes modalIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .quiz-question { font-size: 1.1rem; color: #333; margin-bottom: 10px; }
    .quiz-verb {
      font-size: 2.5rem; font-weight: 800;
      color: #4CAF50; margin: 20px 0;
    }
    .quiz-input {
      width: 100%; padding: 15px 20px;
      font-size: 1.3rem; font-family: 'Nunito', sans-serif;
      border: 3px solid #E0E0E0; border-radius: 15px;
      text-align: center; font-weight: 700;
      outline: none; transition: border-color 0.2s;
    }
    .quiz-input:focus { border-color: #667eea; }
    .quiz-input.correct { border-color: #4CAF50; background: #E8F5E9; }
    .quiz-input.wrong { border-color: #F44336; background: #FFEBEE; }
    .quiz-hint {
      margin-top: 10px; color: #999; font-size: 0.9rem;
    }
    .quiz-progress {
      display: flex; justify-content: center; gap: 8px;
      margin-top: 20px;
    }
    .quiz-dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: #E0E0E0;
    }
    .quiz-dot.done { background: #4CAF50; }
    .quiz-dot.wrong-dot { background: #F44336; }
    .quiz-dot.current { background: #667eea; transform: scale(1.2); }
    
    /* Speed Challenge */
    .speed-timer {
      font-size: 3rem; font-weight: 800;
      color: white; text-align: center;
      margin: 20px 0;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    .speed-timer.warning { color: #FFEB3B; animation: pulse 0.5s infinite; }
    .speed-timer.danger { color: #F44336; animation: shake 0.3s infinite; }
    
    .speed-score {
      background: rgba(255,255,255,0.2);
      padding: 10px 20px; border-radius: 15px;
      color: white; font-weight: 700;
      text-align: center; margin-bottom: 20px;
    }
    
    /* Memory Game */
    .memory-grid {
      display: grid; grid-template-columns: repeat(4, 1fr);
      gap: 10px; margin: 20px 0;
    }
    .memory-card {
      aspect-ratio: 1; border-radius: 12px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 1rem; font-weight: 700;
      color: white; transition: all 0.3s;
      position: relative;
    }
    .memory-card.flipped {
      background: white; color: #333;
    }
    .memory-card.matched {
      background: #4CAF50; color: white;
      animation: pulse 0.5s;
    }
    .memory-card .card-back {
      font-size: 1.5rem;
    }
    
    /* Pattern highlight colors */
    .pattern-important { background: linear-gradient(135deg, #E91E63, #F48FB1); }
    .pattern-perception { background: linear-gradient(135deg, #9C27B0, #CE93D8); }
    .pattern-no-change { background: linear-gradient(135deg, #607D8B, #90A4AE); }
    .pattern-vowel { background: linear-gradient(135deg, #2196F3, #90CAF9); }
    .pattern-drink { background: linear-gradient(135deg, #00BCD4, #80DEEA); }
    .pattern-ow-ew { background: linear-gradient(135deg, #4CAF50, #A5D6A7); }
    .pattern-ought { background: linear-gradient(135deg, #FF9800, #FFCC80); }
    .pattern-stand { background: linear-gradient(135deg, #795548, #BCAAA4); }
    .pattern-ee { background: linear-gradient(135deg, #3F51B5, #9FA8DA); }
    .pattern-d-t { background: linear-gradient(135deg, #009688, #80CBC4); }
    .pattern-t { background: linear-gradient(135deg, #FF5722, #FFAB91); }
    .pattern-misc { background: linear-gradient(135deg, #673AB7, #B39DDB); }
    
    /* Easy Match Game */
    .easy-match-container {
      background: white; border-radius: 20px;
      padding: 20px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .easy-match-header {
      text-align: center; margin-bottom: 20px;
    }
    .easy-match-title {
      font-size: 1.3rem; font-weight: 700; color: #333;
      margin-bottom: 5px;
    }
    .easy-match-hint {
      color: #666; font-size: 0.95rem;
    }
    .easy-match-columns {
      display: flex; gap: 15px;
    }
    .easy-match-column {
      flex: 1; display: flex; flex-direction: column; gap: 10px;
    }
    .easy-match-label {
      text-align: center; font-weight: 700; padding: 8px;
      border-radius: 10px; font-size: 0.9rem;
    }
    .easy-match-label.base { background: #E8F5E9; color: #2E7D32; }
    .easy-match-label.past { background: #FFF3E0; color: #E65100; }
    
    .easy-match-card {
      padding: 15px 12px; border-radius: 12px;
      text-align: center; cursor: pointer;
      transition: all 0.2s; border: 3px solid transparent;
      font-family: 'Nunito', sans-serif; font-weight: 600;
    }
    .easy-match-card.base-card {
      background: #E8F5E9; color: #2E7D32;
    }
    .easy-match-card.past-card {
      background: #FFF3E0; color: #E65100;
    }
    .easy-match-card:hover:not(.matched):not(.disabled) {
      transform: scale(1.03);
    }
    .easy-match-card.selected {
      border-color: #667eea;
      box-shadow: 0 4px 15px rgba(102,126,234,0.4);
      transform: scale(1.05);
    }
    .easy-match-card.matched {
      opacity: 0.4; cursor: default;
      text-decoration: line-through;
    }
    .easy-match-card.correct-flash {
      animation: correctFlash 0.5s ease;
      background: #4CAF50 !important;
      color: white !important;
      border-color: #4CAF50;
    }
    .easy-match-card.wrong-flash {
      animation: wrongFlash 0.5s ease;
      border-color: #F44336;
    }
    @keyframes correctFlash {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    @keyframes wrongFlash {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      75% { transform: translateX(8px); }
    }
    .easy-match-card .verb-text {
      font-size: 1.2rem; margin-bottom: 3px;
    }
    .easy-match-card .verb-meaning {
      font-size: 0.75rem; opacity: 0.8; font-weight: 400;
    }
    .easy-match-score {
      text-align: center; margin-top: 20px;
      padding: 15px; background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
      border-radius: 12px;
    }
    .easy-match-progress {
      display: flex; justify-content: center; gap: 6px;
      margin-bottom: 10px;
    }
    .easy-match-dot {
      width: 24px; height: 24px; border-radius: 50%;
      background: #E0E0E0; display: flex;
      align-items: center; justify-content: center;
      font-size: 0.7rem;
    }
    .easy-match-dot.done {
      background: #4CAF50; color: white;
    }
    .easy-match-level-select {
      display: flex; flex-direction: column; gap: 12px;
      margin-top: 15px;
    }
    .easy-match-level {
      display: flex; align-items: center; gap: 15px;
      background: white; padding: 18px 20px; border-radius: 15px;
      cursor: pointer; transition: all 0.2s;
      border: 3px solid transparent;
    }
    .easy-match-level:hover { transform: translateY(-2px); }
    .easy-match-level.easy { border-color: #4CAF50; }
    .easy-match-level.medium { border-color: #FF9800; }
    .easy-match-level.hard { border-color: #E91E63; }
    .easy-match-level .level-icon { font-size: 2rem; }
    .easy-match-level .level-info { flex: 1; }
    .easy-match-level .level-name { font-weight: 700; color: #333; }
    .easy-match-level .level-desc { font-size: 0.85rem; color: #666; }
    
    /* Triple Match Game */
    .triple-match-container {
      background: white; border-radius: 20px;
      padding: 15px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .triple-columns {
      display: flex; gap: 8px;
    }
    .triple-column {
      flex: 1; display: flex; flex-direction: column; gap: 8px;
    }
    .triple-label {
      text-align: center; font-weight: 700; padding: 6px 4px;
      border-radius: 10px; font-size: 0.6rem;
      line-height: 1.2;
    }
    .triple-label.inf { background: #E3F2FD; color: #1565C0; }
    .triple-label.past { background: #FFF3E0; color: #E65100; }
    .triple-label.pp { background: #F3E5F5; color: #7B1FA2; }
    
    .triple-card {
      padding: 12px 6px; border-radius: 10px;
      text-align: center; cursor: pointer;
      transition: all 0.2s; border: 3px solid transparent;
      font-family: 'Nunito', sans-serif; font-weight: 600;
      font-size: 0.9rem;
    }
    .triple-card.inf-card { background: #E3F2FD; color: #1565C0; }
    .triple-card.past-card { background: #FFF3E0; color: #E65100; }
    .triple-card.pp-card { background: #F3E5F5; color: #7B1FA2; }
    
    .triple-card:hover:not(.matched) { transform: scale(1.03); }
    .triple-card.selected {
      border-color: #333;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
      transform: scale(1.05);
    }
    .triple-card.locked {
      border-color: #4CAF50;
      background: #C8E6C9 !important;
      color: #2E7D32 !important;
    }
    .triple-card.matched {
      opacity: 0.35; cursor: default;
      text-decoration: line-through;
    }
    .triple-card.correct-flash {
      animation: tripleCorrect 0.6s ease;
      background: #4CAF50 !important;
      color: white !important;
    }
    @keyframes tripleCorrect {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }
    .triple-card .card-meaning {
      font-size: 0.65rem; font-weight: 400;
      opacity: 0.8; margin-top: 2px;
    }
    .triple-hint-bar {
      background: linear-gradient(135deg, #FFF9C4, #FFECB3);
      padding: 12px 15px; border-radius: 12px;
      margin-bottom: 12px; text-align: center;
      font-size: 0.9rem; color: #5D4037;
    }
    .triple-hint-bar .step {
      display: inline-block; padding: 3px 10px;
      border-radius: 15px; margin: 0 3px;
      font-weight: 700;
    }
    .triple-hint-bar .step.active { background: #4CAF50; color: white; }
    .triple-hint-bar .step.done { background: #81C784; color: white; }
    .triple-hint-bar .step.waiting { background: #E0E0E0; color: #999; }
    .triple-score-bar {
      display: flex; justify-content: space-between;
      align-items: center; margin-top: 15px;
      padding: 12px 15px; background: #F5F5F5;
      border-radius: 12px;
    }
    .triple-progress-dots {
      display: flex; gap: 5px;
    }
    .triple-dot {
      width: 22px; height: 22px; border-radius: 50%;
      background: #E0E0E0; display: flex;
      align-items: center; justify-content: center;
      font-size: 0.65rem; font-weight: 700;
    }
    .triple-dot.done { background: #4CAF50; color: white; }
    
    /* Context Learn */
    .context-container {
      background: white; border-radius: 20px;
      padding: 20px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .context-card {
      background: linear-gradient(135deg, #FFF8E1, #FFECB3);
      border-radius: 15px; padding: 20px;
      margin-bottom: 15px;
    }
    .context-title {
      font-size: 1.2rem; font-weight: 700;
      color: #E65100; margin-bottom: 15px;
      text-align: center;
    }
    .context-rule {
      display: flex; align-items: center; gap: 15px;
      padding: 12px 15px; background: white;
      border-radius: 12px; margin-bottom: 10px;
    }
    .context-emoji { font-size: 2rem; }
    .context-text { flex: 1; }
    .context-signal {
      font-weight: 700; color: #E65100;
      font-size: 1.1rem;
    }
    .context-explain {
      font-size: 0.85rem; color: #666;
      margin-top: 3px;
    }
    .context-example-box {
      background: white; border-radius: 12px;
      padding: 15px; margin-top: 15px;
    }
    .context-example {
      padding: 10px 15px; border-radius: 10px;
      margin-bottom: 8px; font-size: 1.05rem;
    }
    .context-example.present {
      background: #E8F5E9; border-left: 4px solid #4CAF50;
    }
    .context-example.past {
      background: #FFF3E0; border-left: 4px solid #FF9800;
    }
    .context-example .signal-word {
      text-decoration: underline;
      text-decoration-color: #FF9800;
      text-decoration-thickness: 2px;
      font-weight: 600;
    }
    .context-example .verb-word {
      font-weight: 700;
    }
    .context-example.present .verb-word { color: #2E7D32; }
    .context-example.past .verb-word { color: #E65100; }
    .context-nav {
      display: flex; justify-content: center; gap: 10px;
      margin-top: 20px;
    }
    .context-nav-btn {
      padding: 12px 25px; border-radius: 25px;
      border: none; font-weight: 700;
      font-family: 'Nunito', sans-serif;
      cursor: pointer; font-size: 1rem;
    }
    .context-progress {
      text-align: center; color: #666;
      font-size: 0.9rem; margin-bottom: 10px;
    }
    
    /* Sentence Quiz */
    .sentence-quiz-card {
      background: white; border-radius: 20px;
      padding: 25px 20px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .sentence-quiz-signal {
      text-align: center; margin-bottom: 15px;
    }
    .signal-badge {
      display: inline-block; padding: 8px 20px;
      border-radius: 20px; font-weight: 700;
      font-size: 1.1rem;
    }
    .signal-badge.present {
      background: #E8F5E9; color: #2E7D32;
    }
    .signal-badge.past {
      background: #FFF3E0; color: #E65100;
    }
    .sentence-quiz-sentence {
      font-size: 1.3rem; text-align: center;
      padding: 20px; margin: 15px 0;
      background: #F5F5F5; border-radius: 15px;
      line-height: 1.6;
    }
    .sentence-quiz-sentence .blank {
      display: inline-block; min-width: 80px;
      border-bottom: 3px solid #667eea;
      margin: 0 5px; color: #667eea;
      font-weight: 700;
    }
    .sentence-quiz-meaning {
      text-align: center; color: #666;
      font-size: 0.95rem; margin-bottom: 20px;
    }
    .sentence-quiz-choices {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .sentence-choice-btn {
      padding: 12px 10px; border-radius: 12px;
      border: 3px solid #E0E0E0;
      background: white; cursor: pointer;
      font-family: 'Nunito', sans-serif;
      font-size: 1.05rem; font-weight: 700;
      transition: all 0.2s;
    }
    .sentence-choice-btn:hover {
      border-color: #667eea; background: #F5F5FF;
    }
    .sentence-choice-btn.correct {
      border-color: #4CAF50; background: #E8F5E9;
      color: #2E7D32;
    }
    .sentence-choice-btn.wrong {
      border-color: #F44336; background: #FFEBEE;
      color: #C62828;
    }
    .sentence-choice-btn.show-correct {
      border-color: #4CAF50; background: #E8F5E9;
      color: #2E7D32;
    }
    .sentence-choice-btn .choice-label {
      font-size: 0.7rem; color: #999;
      margin-bottom: 2px; font-weight: 400;
    }
    .sentence-feedback {
      margin-top: 20px; padding: 15px;
      border-radius: 12px; text-align: center;
    }
    .sentence-feedback.correct { background: #E8F5E9; }
    .sentence-feedback.wrong { background: #FFF3E0; }
    .sentence-feedback .emoji { font-size: 2.5rem; margin-bottom: 8px; }
    .sentence-feedback .message { font-weight: 700; margin-bottom: 5px; }
    .sentence-feedback .explanation {
      font-size: 0.9rem; color: #666;
      margin-bottom: 15px;
    }
    
    .match-score {
      text-align: center; margin-top: 20px;
      background: white; padding: 15px; border-radius: 15px;
      font-size: 1.2rem; font-weight: 700;
    }
    
    /* Flashcards */
    .flashcard-container { perspective: 1000px; margin: 20px 0; }
    .flashcard {
      width: 100%; height: 200px; cursor: pointer;
      position: relative; transform-style: preserve-3d;
      transition: transform 0.6s;
    }
    .flashcard.flipped { transform: rotateY(180deg); }
    .flashcard-face {
      position: absolute; width: 100%; height: 100%;
      backface-visibility: hidden; border-radius: 20px;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 20px;
    }
    .flashcard-front { background: linear-gradient(135deg, #E8F5E9, #C8E6C9); }
    .flashcard-back {
      background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
      transform: rotateY(180deg);
    }
    .flashcard-word { font-size: 2.5rem; font-weight: 800; margin-bottom: 10px; }
    .flashcard-front .flashcard-word { color: #2E7D32; }
    .flashcard-back .flashcard-word { color: #E65100; }
    .flashcard-label { font-size: 1rem; color: #666; }
    .flashcard-meaning { font-size: 1.1rem; color: #666; margin-top: 10px; }
    .flashcard-hint { font-size: 0.9rem; color: #999; margin-top: 15px; }
    
    .flashcard-nav {
      display: flex; justify-content: center; gap: 15px; margin-top: 20px;
    }
    .flashcard-btn {
      padding: 12px 25px; border-radius: 25px; font-weight: 700;
      cursor: pointer; font-family: 'Nunito', sans-serif; border: none;
      background: white; color: #333;
    }
    .flashcard-btn:hover { background: #F5F5F5; }
    
    /* Confetti */
    .confetti-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 1000;
    }
    .confetti {
      position: absolute; width: 10px; height: 10px;
      animation: confettiFall 3s linear forwards;
    }
    @keyframes confettiFall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    
    /* Responsive */
    @media (max-width: 400px) {
      .app-title { font-size: 1.8rem; }
      .scene-text { font-size: 1.2rem; }
      .choice-btn { font-size: 1rem; padding: 15px 20px; }
    }
    
    /* Level Select */
    .level-content { text-align: center; padding-top: 30px; }
    .level-title { font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 10px; }
    .level-subtitle { color: rgba(255,255,255,0.8); margin-bottom: 25px; }
    .level-cards { display: flex; flex-direction: column; gap: 15px; padding: 0 10px; }
    .level-card {
      background: white; border-radius: 20px; padding: 20px;
      display: flex; align-items: center; gap: 15px;
      cursor: pointer; transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 3px solid transparent;
    }
    .level-card:hover { transform: translateY(-3px); }
    .level-card:active { transform: scale(0.98); }
    .level-card.easy { border-color: #4CAF50; }
    .level-card.medium { border-color: #FF9800; }
    .level-card.hard { border-color: #E91E63; }
    .level-card .level-icon { font-size: 40px; }
    .level-card .level-info { text-align: left; flex: 1; }
    .level-card .level-name { font-size: 1.2rem; font-weight: 700; color: #333; }
    .level-card .level-desc { font-size: 0.9rem; color: #666; }
    .level-card .level-time { 
      background: #f5f5f5; padding: 5px 12px; border-radius: 15px;
      font-size: 0.85rem; color: #888; font-weight: 600;
    }
    .level-card.easy .level-name { color: #2E7D32; }
    .level-card.medium .level-name { color: #E65100; }
    .level-card.hard .level-name { color: #C2185B; }

    /* Present Perfect Quiz */
    .pp-quiz-container { background:white; border-radius:20px; padding:25px; margin-top:15px; box-shadow:0 5px 20px rgba(0,0,0,0.15); }
    .pp-category-badge { display:inline-block; padding:6px 16px; border-radius:20px; font-size:0.85rem; font-weight:700; margin-bottom:15px; }
    .pp-cat-havhas { background:#E3F2FD; color:#1565C0; }
    .pp-cat-v3 { background:#F3E5F5; color:#7B1FA2; }
    .pp-cat-sinfor { background:#E8F5E9; color:#2E7D32; }
    .pp-cat-signal { background:#FFF3E0; color:#E65100; }
    .pp-cat-vs { background:#FCE4EC; color:#C2185B; }
    .pp-cat-neg { background:#FFEBEE; color:#C62828; }
    .pp-cat-ques { background:#E0F7FA; color:#00838F; }
    .pp-cat-mix { background:linear-gradient(135deg,#E3F2FD,#F3E5F5); color:#4A148C; }
    .pp-sentence-box { font-size:1.3rem; text-align:center; padding:22px 18px; margin:15px 0; background:linear-gradient(135deg,#F5F5F5,#FAFAFA); border-radius:15px; line-height:1.7; border:2px solid #E0E0E0; }
    /* Present Perfect Quiz - compact overrides */
    .pp-sentence-box .pp-signal, .scene-text .pp-signal { text-decoration:none; border-bottom:3px solid #FF5722; color:#E65100; font-weight:800; padding-bottom:1px; }
    .pp-sentence-box .pp-blank, .scene-text .pp-blank { display:inline-block; min-width:85px; border-bottom:3px dashed #00BCD4; margin:0 4px; color:#00BCD4; font-weight:800; padding:0 5px; }
    .pp-sentence-box .pp-filled, .scene-text .pp-filled { display:inline-block; min-width:85px; border-bottom:3px solid #4CAF50; margin:0 4px; color:#2E7D32; font-weight:800; padding:0 5px; background:#E8F5E9; border-radius:5px 5px 0 0; }
    .pp-sentence-box .pp-filled-wrong, .scene-text .pp-filled-wrong { border-bottom-color:#F44336; color:#C62828; background:#FFEBEE; }
    .pp-hint-vn { text-align:center; color:#999; font-size:0.92rem; margin-bottom:15px; font-style:italic; }
    .pp-choices { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    .pp-choices.three-cols { grid-template-columns:1fr 1fr 1fr; }
    .pp-choice-btn { padding:14px 10px; border-radius:14px; border:3px solid #E0E0E0; background:white; cursor:pointer; font-family:'Nunito',sans-serif; font-size:1.1rem; font-weight:700; transition:all 0.2s; text-align:center; }
    .pp-choice-btn:hover { border-color:#00BCD4; background:#E0F7FA; transform:translateY(-2px); }
    .pp-choice-btn:active { transform:scale(0.97); }
    .pp-choice-btn.pp-correct { border-color:#4CAF50; background:#E8F5E9; color:#2E7D32; animation:pulse 0.5s ease; }
    .pp-choice-btn.pp-wrong { border-color:#F44336; background:#FFEBEE; color:#C62828; animation:shake 0.5s ease; }
    .pp-choice-btn.pp-show-correct { border-color:#4CAF50; background:#C8E6C9; color:#1B5E20; }
    .pp-feedback-box { margin-top:18px; padding:18px; border-radius:15px; text-align:center; animation:fadeIn 0.3s ease; }
    .pp-feedback-box.correct { background:#E8F5E9; }
    .pp-feedback-box.wrong { background:#FFF3E0; }
    .pp-feedback-box .fb-emoji { font-size:2.8rem; margin-bottom:6px; }
    .pp-feedback-box .fb-msg { font-weight:700; font-size:1.1rem; margin-bottom:5px; }
    .pp-feedback-box .fb-explain { font-size:0.92rem; color:#555; margin-bottom:12px; line-height:1.5; text-align:left; padding:10px 12px; background:rgba(255,255,255,0.7); border-radius:10px; }
    .pp-level-card { background:white; border-radius:20px; padding:18px; display:flex; align-items:center; gap:15px; cursor:pointer; transition:all 0.3s; box-shadow:0 5px 15px rgba(0,0,0,0.1); border:3px solid transparent; margin-bottom:12px; }
    .pp-level-card:hover { transform:translateY(-3px); }
    .pp-level-card:active { transform:scale(0.98); }
    .pp-level-card .lv-icon { font-size:38px; }
    .pp-level-card .lv-info { flex:1; text-align:left; }
    .pp-level-card .lv-name { font-size:1.15rem; font-weight:700; color:#333; }
    .pp-level-card .lv-desc { font-size:0.82rem; color:#666; }
    .pp-level-card .lv-badge { background:#f5f5f5; padding:5px 12px; border-radius:15px; font-size:0.82rem; color:#888; font-weight:600; }
    .pp-progress-bar { height:8px; background:rgba(255,255,255,0.3); border-radius:4px; margin:10px 0; overflow:hidden; }
    .pp-progress-fill { height:100%; background:linear-gradient(90deg,#00BCD4,#4CAF50); border-radius:4px; transition:width 0.3s ease; }
    .pp-topic-selector { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-bottom:15px; }
    .pp-topic-btn { padding:8px 14px; border-radius:20px; border:2px solid rgba(255,255,255,0.3); background:rgba(255,255,255,0.15); color:white; font-weight:600; cursor:pointer; font-family:'Nunito',sans-serif; font-size:0.8rem; transition:all 0.2s; }
    .pp-topic-btn:hover { background:rgba(255,255,255,0.25); }
    .pp-topic-btn.active { background:white; color:#00838F; border-color:white; }
    .pp-result-card { background:white; border-radius:20px; padding:25px; text-align:center; box-shadow:0 5px 20px rgba(0,0,0,0.15); }
    .pp-result-stars { font-size:3rem; margin-bottom:10px; }
    .pp-result-score { font-size:2.5rem; font-weight:800; color:#00BCD4; }
    .pp-result-label { font-size:1rem; color:#666; margin-bottom:15px; }
    .pp-result-detail { display:flex; justify-content:center; gap:25px; margin:15px 0; }
    .pp-result-detail .rd-item { text-align:center; }
    .pp-result-detail .rd-num { font-size:1.8rem; font-weight:800; }
    .pp-result-detail .rd-label { font-size:0.82rem; color:#999; }
    .pp-review-item { background:#f9f9f9; border-radius:12px; padding:14px; margin-bottom:10px; text-align:left; }
    .pp-review-item.rv-correct { border-left:4px solid #4CAF50; }
    .pp-review-item.rv-wrong { border-left:4px solid #F44336; }
    .pp-review-item .rv-q { font-weight:600; margin-bottom:5px; }
    .pp-review-item .rv-a { font-size:0.9rem; color:#555; }
  </style>
</head>
<body>
  <div class="app-container bg-fun" id="appContainer">
    <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</button>
    <div id="confettiContainer" class="confetti-container"></div>
    
    <!-- HOME SCREEN -->
    <div id="homeScreen" class="screen active">
      <div class="home-content">
        <div class="mascot-large">ü¶â</div>
        <h1 class="app-title">Fun English!</h1>
        <p class="app-tagline">H·ªçc ti·∫øng Anh vui v·∫ª m·ªói ng√†y</p>
        
        <!-- Hi·ªÉn th·ªã t·ªïng sao -->
        <div id="starDisplay" style="display:flex;justify-content:center;gap:10px;margin:8px 0;flex-wrap:wrap">
          <div style="background:linear-gradient(135deg,#FFD700,#FFA000);padding:6px 14px;border-radius:15px;color:white;font-weight:700;font-size:0.85rem;box-shadow:0 2px 8px rgba(255,152,0,0.3)">
            ‚≠ê T·ªïng: <span id="totalStarsDisplay">0</span>
          </div>
          <div style="background:linear-gradient(135deg,#4CAF50,#2E7D32);padding:6px 14px;border-radius:15px;color:white;font-weight:700;font-size:0.85rem;box-shadow:0 2px 8px rgba(76,175,80,0.3)">
            üìÖ H√¥m nay: <span id="todayStarsDisplay">0</span>
          </div>
        </div>
        
        <div class="topic-grid">
          <div class="topic-card" onclick="showPresentPerfectQuiz()" style="border-color:#00BCD4;background:linear-gradient(135deg,#E0F7FA,#fff)">
            <div class="topic-icon">üíé</div>
            <div class="topic-name">Present Perfect</div>
          </div>
          <div class="topic-card" onclick="showSimpleTenseSelect()" style="border-color:#FF9800;background:linear-gradient(135deg,#FFF8E1,#fff)">
            <div class="topic-icon">‚òÄÔ∏èüåô</div>
            <div class="topic-name">Simple Tenses</div>
          </div>
          <div class="topic-card stories" onclick="showLevelSelect('stories')">
            <div class="topic-icon">üìñ</div>
            <div class="topic-name">Mix Stories</div>
          </div>
          <div class="topic-card quiz" onclick="startVerbSentenceQuiz()">
            <div class="topic-icon">üìù</div>
            <div class="topic-name">Tr·∫Øc nghi·ªám</div>
          </div>
          <div class="topic-card games" onclick="startTopic('games')">
            <div class="topic-icon">üéÆ</div>
            <div class="topic-name">Word Games</div>
          </div>
          <div class="topic-card" onclick="showLearnScreen()" style="border-color:#4CAF50">
            <div class="topic-icon">üìö</div>
            <div class="topic-name">H·ªçc ki·∫øn th·ª©c</div>
          </div>
        </div>
        
        <div id="motivationalMsg" style="margin-top:10px;padding:10px 15px;background:rgba(255,255,255,0.15);border-radius:12px;text-align:center;color:white;font-size:0.85rem;line-height:1.4;backdrop-filter:blur(5px)">
        </div>
      </div>
    </div>
    
    <!-- LEVEL SELECT SCREEN -->
    <div id="levelScreen" class="screen"></div>
    
    <!-- STORY SCREEN -->
    <div id="storyScreen" class="screen"></div>
    
    <!-- RESULT SCREEN -->
    <div id="resultScreen" class="screen"></div>
    
    <!-- LEARN SCREEN -->
    <div id="learnScreen" class="screen"></div>
    
    <!-- GAME SCREEN -->
    <div id="gameScreen" class="screen"></div>

    <div id="quizScreen" class="screen">
      <div class="container">
        <div id="quizArea"></div>
      </div>
    </div>
  </div>

<script>
// ============ DATA - Cambridge Style ============
// ============ DATA - Cambridge Style (Expanded with All Signal Words) ============
var STORIES = {
  daily: [
    // ===== EVERY DAY =====
    {
      bg: 'bg-sunny',
      scenes: [
        { image: 'üåÖüëß', text: 'Lily <span class="highlight-green">wakes up</span> at 7 <span class="highlight">every day</span>.', question: 'Every day, Lily ___ up at 7.', choices: ['wakes ‚òÄÔ∏è', 'woke üåô'], correct: 0, feedback: 'Yes! every day ‚Üí wakes', tip: '‚òÄÔ∏è every day = m·ªói ng√†y' },
        { image: 'üö´üç¨', text: 'She <span class="highlight-green">doesn\'t eat</span> candy <span class="highlight">every day</span>.', question: 'She ___ eat candy every day.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every day ‚Üí doesn\'t', tip: 'üö´ every day ‚Üí doesn\'t' },
        { image: '‚ùìüè´', text: '"<span class="highlight-green">Does she go</span> to school <span class="highlight">every day</span>?"', question: '___ she go to school every day?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! every day ‚Üí Does', tip: '‚ùì every day ‚Üí Does...?' },
        { image: 'üçéüë¶', text: 'Tom <span class="highlight-green">eats</span> an apple <span class="highlight">every day</span>.', question: 'Tom ___ an apple every day.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Wonderful! every day ‚Üí eats', tip: '‚òÄÔ∏è every day ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üçî', text: 'He <span class="highlight-green">doesn\'t eat</span> fast food <span class="highlight">every day</span>.', question: 'He doesn\'t ___ fast food every day.', choices: ['eat üö´', 'eats üö´'], correct: 0, feedback: 'Excellent! doesn\'t + eat (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìü•õ', text: '"<span class="highlight-green">Do you drink</span> milk <span class="highlight">every day</span>?"', question: '___ you drink milk every day?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì Do + you...?' }
      ]
    },
    // ===== EVERY MORNING =====
    {
      bg: 'bg-sunny',
      scenes: [
        { image: 'ü¶∑üëß', text: 'Lily <span class="highlight-green">brushes</span> her teeth <span class="highlight">every morning</span>.', question: 'Lily ___ her teeth every morning.', choices: ['brushes ‚òÄÔ∏è', 'brushed üåô'], correct: 0, feedback: 'Yes! every morning ‚Üí brushes', tip: '‚òÄÔ∏è every morning = m·ªói s√°ng' },
        { image: 'üö´‚òï', text: 'She <span class="highlight-green">doesn\'t drink</span> coffee <span class="highlight">every morning</span>.', question: 'She ___ drink coffee every morning.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every morning ‚Üí doesn\'t', tip: 'üö´ every morning ‚Üí doesn\'t' },
        { image: '‚ùìüç≥', text: '"<span class="highlight-green">Does Mom cook</span> breakfast <span class="highlight">every morning</span>?"', question: '___ Mom cook every morning?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! Mom (she) ‚Üí Does', tip: '‚ùì every morning ‚Üí Does...?' },
        { image: 'üèÉüë¶', text: 'Tom <span class="highlight-green">runs</span> in the park <span class="highlight">every morning</span>.', question: 'Tom ___ in the park every morning.', choices: ['runs ‚òÄÔ∏è', 'ran üåô'], correct: 0, feedback: 'Wonderful! every morning ‚Üí runs', tip: '‚òÄÔ∏è every morning ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üì∫', text: 'He <span class="highlight-green">doesn\'t watch</span> TV <span class="highlight">every morning</span>.', question: 'He doesn\'t ___ TV every morning.', choices: ['watch üö´', 'watches üö´'], correct: 0, feedback: 'Excellent! doesn\'t + watch (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüöå', text: '"<span class="highlight-green">Do they take</span> the bus <span class="highlight">every morning</span>?"', question: '___ they take the bus every morning?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì Do + they...?' }
      ]
    },
    // ===== EVERY NIGHT =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'üìñüëß', text: 'Lily <span class="highlight-green">reads</span> books <span class="highlight">every night</span>.', question: 'Lily ___ books every night.', choices: ['reads ‚òÄÔ∏è', 'read üåô'], correct: 0, feedback: 'Yes! every night ‚Üí reads', tip: '‚òÄÔ∏è every night = m·ªói t·ªëi' },
        { image: 'üö´üéÆ', text: 'She <span class="highlight-green">doesn\'t play</span> games <span class="highlight">every night</span>.', question: 'She ___ play games every night.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every night ‚Üí doesn\'t', tip: 'üö´ every night ‚Üí doesn\'t' },
        { image: '‚ùìüò¥', text: '"<span class="highlight-green">Does she sleep</span> early <span class="highlight">every night</span>?"', question: '___ she sleep early every night?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! she ‚Üí Does', tip: '‚ùì every night ‚Üí Does...?' },
        { image: 'üì∫üë®‚Äçüë©‚Äçüëß', text: 'The family <span class="highlight-green">watches</span> TV <span class="highlight">every night</span>.', question: 'The family ___ TV every night.', choices: ['watches ‚òÄÔ∏è', 'watched üåô'], correct: 0, feedback: 'Wonderful! every night ‚Üí watches', tip: '‚òÄÔ∏è every night ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üçï', text: 'They <span class="highlight-green">don\'t eat</span> pizza <span class="highlight">every night</span>.', question: 'They ___ eat pizza every night.', choices: ['don\'t üö´', 'didn\'t üö´', 'doesn\'t üö´'], correct: 0, feedback: 'Excellent! they ‚Üí don\'t', tip: 'üö´ They + don\'t' },
        { image: '‚ùìüéµ', text: '"<span class="highlight-green">Do you listen</span> to music <span class="highlight">every night</span>?"', question: '___ you listen to music every night?', choices: ['Do ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì every night ‚Üí Do...?' }
      ]
    },
    // ===== EVERY WEEK =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚öΩüë¶', text: 'Tom <span class="highlight-green">plays</span> football <span class="highlight">every week</span>.', question: 'Tom ___ football every week.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! every week ‚Üí plays', tip: '‚òÄÔ∏è every week = m·ªói tu·∫ßn' },
        { image: 'üö´üèä', text: 'He <span class="highlight-green">doesn\'t swim</span> <span class="highlight">every week</span>.', question: 'He ___ swim every week.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every week ‚Üí doesn\'t', tip: 'üö´ every week ‚Üí doesn\'t' },
        { image: '‚ùìüéæ', text: '"<span class="highlight-green">Does he play</span> tennis <span class="highlight">every week</span>?"', question: '___ he play tennis every week?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! he ‚Üí Does', tip: '‚ùì every week ‚Üí Does...?' },
        { image: 'üõíüë©', text: 'Mom <span class="highlight-green">goes</span> shopping <span class="highlight">every week</span>.', question: 'Mom ___ shopping every week.', choices: ['goes ‚òÄÔ∏è', 'went üåô'], correct: 0, feedback: 'Wonderful! every week ‚Üí goes', tip: '‚òÄÔ∏è every week ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üç∞', text: 'She <span class="highlight-green">doesn\'t buy</span> cake <span class="highlight">every week</span>.', question: 'She doesn\'t ___ cake every week.', choices: ['buy üö´', 'buys üö´'], correct: 0, feedback: 'Excellent! doesn\'t + buy (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüè†', text: '"<span class="highlight-green">Do they clean</span> the house <span class="highlight">every week</span>?"', question: '___ they clean the house every week?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì Do + they...?' }
      ]
    },
    // ===== ALWAYS =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üçéüëß', text: 'Lily <span class="highlight">always</span> <span class="highlight-green">eats</span> fruit.', question: 'Lily always ___ fruit.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! always ‚Üí eats', tip: '‚òÄÔ∏è always = lu√¥n lu√¥n' },
        { image: 'üö´üç≠', text: 'She <span class="highlight">always</span> <span class="highlight-green">doesn\'t forget</span> homework.', question: 'She always ___ forget homework.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! always ‚Üí doesn\'t', tip: 'üö´ always ‚Üí doesn\'t' },
        { image: '‚ùìüìö', text: '"<span class="highlight-green">Does she always study</span> hard?"', question: '___ she always study hard?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! always ‚Üí Does', tip: '‚ùì always ‚Üí Does...?' },
        { image: 'üòäüë¶', text: 'Tom is <span class="highlight">always</span> <span class="highlight-green">happy</span>.', question: 'Tom is always ___.', choices: ['happy ‚òÄÔ∏è', 'was happy üåô'], correct: 0, feedback: 'Wonderful! always ‚Üí is', tip: '‚òÄÔ∏è always ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üò†', text: 'He <span class="highlight">always</span> <span class="highlight-green">doesn\'t get</span> angry.', question: 'He always ___ get angry.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Excellent! always ‚Üí doesn\'t', tip: 'üö´ always ‚Üí doesn\'t' },
        { image: '‚ùìüôã', text: '"<span class="highlight-green">Do you always help</span> your friends?"', question: '___ you always help your friends?', choices: ['Do ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì always ‚Üí Do...?' }
      ]
    },
    // ===== USUALLY =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üö∂üëß', text: 'Lily <span class="highlight">usually</span> <span class="highlight-green">walks</span> to school.', question: 'Lily usually ___ to school.', choices: ['walks ‚òÄÔ∏è', 'walked üåô'], correct: 0, feedback: 'Yes! usually ‚Üí walks', tip: '‚òÄÔ∏è usually = th∆∞·ªùng th∆∞·ªùng' },
        { image: 'üö´üöå', text: 'She <span class="highlight">usually</span> <span class="highlight-green">doesn\'t take</span> the bus.', question: 'She usually ___ take the bus.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! usually ‚Üí doesn\'t', tip: 'üö´ usually ‚Üí doesn\'t' },
        { image: '‚ùìüèÉ', text: '"<span class="highlight-green">Does she usually run</span> in the morning?"', question: '___ she usually run in the morning?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! usually ‚Üí Does', tip: '‚ùì usually ‚Üí Does...?' },
        { image: 'üçöüë®', text: 'Dad <span class="highlight">usually</span> <span class="highlight-green">cooks</span> dinner.', question: 'Dad usually ___ dinner.', choices: ['cooks ‚òÄÔ∏è', 'cooked üåô'], correct: 0, feedback: 'Wonderful! usually ‚Üí cooks', tip: '‚òÄÔ∏è usually ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üçú', text: 'He <span class="highlight">usually</span> <span class="highlight-green">doesn\'t make</span> noodles.', question: 'He usually doesn\'t ___ noodles.', choices: ['make üö´', 'makes üö´'], correct: 0, feedback: 'Excellent! doesn\'t + make (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüç≥', text: '"<span class="highlight-green">Do they usually eat</span> together?"', question: '___ they usually eat together?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì usually ‚Üí Do...?' }
      ]
    },
    // ===== OFTEN =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'üéÆüëß', text: 'Lily <span class="highlight">often</span> <span class="highlight-green">plays</span> games.', question: 'Lily often ___ games.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! often ‚Üí plays', tip: '‚òÄÔ∏è often = th∆∞·ªùng xuy√™n' },
        { image: 'üö´üò¢', text: 'She <span class="highlight">often</span> <span class="highlight-green">doesn\'t cry</span>.', question: 'She often ___ cry.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! often ‚Üí doesn\'t', tip: 'üö´ often ‚Üí doesn\'t' },
        { image: '‚ùìüé®', text: '"<span class="highlight-green">Does she often draw</span> pictures?"', question: '___ she often draw pictures?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! often ‚Üí Does', tip: '‚ùì often ‚Üí Does...?' },
        { image: 'üìñüë¶', text: 'Tom <span class="highlight">often</span> <span class="highlight-green">reads</span> comics.', question: 'Tom often ___ comics.', choices: ['reads ‚òÄÔ∏è', 'read üåô'], correct: 0, feedback: 'Wonderful! often ‚Üí reads', tip: '‚òÄÔ∏è often ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üìö', text: 'He <span class="highlight">often</span> <span class="highlight-green">doesn\'t read</span> textbooks.', question: 'He often doesn\'t ___ textbooks.', choices: ['read üö´', 'reads üö´'], correct: 0, feedback: 'Excellent! doesn\'t + read (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüé¨', text: '"<span class="highlight-green">Do you often watch</span> movies?"', question: '___ you often watch movies?', choices: ['Do ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì often ‚Üí Do...?' }
      ]
    },
    // ===== SOMETIMES =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üç¶üëß', text: 'Lily <span class="highlight">sometimes</span> <span class="highlight-green">eats</span> ice cream.', question: 'Lily sometimes ___ ice cream.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! sometimes ‚Üí eats', tip: '‚òÄÔ∏è sometimes = ƒë√¥i khi' },
        { image: 'üö´üç´', text: 'She <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t eat</span> chocolate.', question: 'She sometimes ___ eat chocolate.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! sometimes ‚Üí doesn\'t', tip: 'üö´ sometimes ‚Üí doesn\'t' },
        { image: '‚ùìüéÇ', text: '"<span class="highlight-green">Does she sometimes bake</span> cakes?"', question: '___ she sometimes bake cakes?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! sometimes ‚Üí Does', tip: '‚ùì sometimes ‚Üí Does...?' },
        { image: 'üé∏üë¶', text: 'Tom <span class="highlight">sometimes</span> <span class="highlight-green">plays</span> guitar.', question: 'Tom sometimes ___ guitar.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Wonderful! sometimes ‚Üí plays', tip: '‚òÄÔ∏è sometimes ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üéπ', text: 'He <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t practice</span> piano.', question: 'He sometimes doesn\'t ___ piano.', choices: ['practice üö´', 'practices üö´'], correct: 0, feedback: 'Excellent! doesn\'t + practice (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüé§', text: '"<span class="highlight-green">Do they sometimes sing</span> songs?"', question: '___ they sometimes sing songs?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì sometimes ‚Üí Do...?' }
      ]
    }
  ],
  yesterday: [
    // ===== YESTERDAY =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'üåôüëß', text: 'Lily <span class="highlight-orange">woke up</span> late <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, Lily ___ up late.', choices: ['woke üåô', 'wakes ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! yesterday ‚Üí woke', tip: 'üåô yesterday = h√¥m qua' },
        { image: 'üö´üè´', text: 'She <span class="highlight-orange">didn\'t go</span> to school <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, she ___ go to school.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! yesterday ‚Üí didn\'t', tip: 'üö´ yesterday ‚Üí didn\'t' },
        { image: '‚ùìüõèÔ∏è', text: '"<span class="highlight-orange">Did she sleep</span> well <span class="highlight-orange">yesterday</span>?"', question: '___ she sleep well yesterday?', choices: ['Did ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Perfect! yesterday ‚Üí Did', tip: '‚ùì yesterday ‚Üí Did...?' },
        { image: 'üçïüë¶', text: 'Tom <span class="highlight-orange">ate</span> pizza <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, Tom ___ pizza.', choices: ['ate üåô', 'eats ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! yesterday ‚Üí ate', tip: 'üåô yesterday ‚Üí qu√° kh·ª©' },
        { image: 'üö´ü•ó', text: 'He <span class="highlight-orange">didn\'t eat</span> salad <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, he didn\'t ___ salad.', choices: ['eat üö´', 'ate üö´'], correct: 0, feedback: 'Excellent! didn\'t + eat (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüéÆ', text: '"<span class="highlight-orange">Did you play</span> games <span class="highlight-orange">yesterday</span>?"', question: 'Did you ___ games yesterday?', choices: ['play ‚ùì', 'played ‚ùì'], correct: 0, feedback: 'Great! Did + play (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST NIGHT =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'üì∫üë®‚Äçüë©‚Äçüëß', text: 'We <span class="highlight-orange">watched</span> a movie <span class="highlight-orange">last night</span>.', question: 'Last night, we ___ a movie.', choices: ['watched üåô', 'watch ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last night ‚Üí watched', tip: 'üåô last night = t·ªëi qua' },
        { image: 'üö´üìñ', text: 'Lily <span class="highlight-orange">didn\'t read</span> books <span class="highlight-orange">last night</span>.', question: 'Last night, Lily ___ read books.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! last night ‚Üí didn\'t', tip: 'üö´ last night ‚Üí didn\'t' },
        { image: '‚ùìüò¥', text: '"<span class="highlight-orange">Did you sleep</span> early <span class="highlight-orange">last night</span>?"', question: '___ you sleep early last night?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! last night ‚Üí Did', tip: '‚ùì last night ‚Üí Did...?' },
        { image: 'üçùüë®', text: 'Dad <span class="highlight-orange">cooked</span> pasta <span class="highlight-orange">last night</span>.', question: 'Last night, Dad ___ pasta.', choices: ['cooked üåô', 'cooks ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí cooked', tip: 'üåô last night ‚Üí qu√° kh·ª©' },
        { image: 'üö´üç∞', text: 'We <span class="highlight-orange">didn\'t have</span> dessert <span class="highlight-orange">last night</span>.', question: 'Last night, we didn\'t ___ dessert.', choices: ['have üö´', 'had üö´'], correct: 0, feedback: 'Excellent! didn\'t + have (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüéµ', text: '"<span class="highlight-orange">Did they listen</span> to music <span class="highlight-orange">last night</span>?"', question: 'Did they ___ to music last night?', choices: ['listen ‚ùì', 'listened ‚ùì'], correct: 0, feedback: 'Great! Did + listen (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST WEEK =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'üìùüëß', text: 'Lily <span class="highlight-orange">had</span> a test <span class="highlight-orange">last week</span>.', question: 'Last week, Lily ___ a test.', choices: ['had üåô', 'has ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last week ‚Üí had', tip: 'üåô last week = tu·∫ßn tr∆∞·ªõc' },
        { image: 'üö´üò∞', text: 'She <span class="highlight-orange">didn\'t fail</span> <span class="highlight-orange">last week</span>.', question: 'Last week, she ___ fail.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! last week ‚Üí didn\'t', tip: 'üö´ last week ‚Üí didn\'t' },
        { image: '‚ùìüíØ', text: '"<span class="highlight-orange">Did she get</span> 100 points <span class="highlight-orange">last week</span>?"', question: '___ she get 100 points last week?', choices: ['Did ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Perfect! last week ‚Üí Did', tip: '‚ùì last week ‚Üí Did...?' },
        { image: 'üèÜüë¶', text: 'Tom <span class="highlight-orange">won</span> a prize <span class="highlight-orange">last week</span>.', question: 'Last week, Tom ___ a prize.', choices: ['won üåô', 'wins ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last week ‚Üí won', tip: 'üåô last week ‚Üí qu√° kh·ª©' },
        { image: 'üö´üéÆ', text: 'He <span class="highlight-orange">didn\'t play</span> games <span class="highlight-orange">last week</span>.', question: 'Last week, he didn\'t ___ games.', choices: ['play üö´', 'played üö´'], correct: 0, feedback: 'Excellent! didn\'t + play (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüìö', text: '"<span class="highlight-orange">Did they study</span> hard <span class="highlight-orange">last week</span>?"', question: 'Did they ___ hard last week?', choices: ['study ‚ùì', 'studied ‚ùì'], correct: 0, feedback: 'Great! Did + study (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST MONTH =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üéÇüëß', text: 'Lily <span class="highlight-orange">celebrated</span> her birthday <span class="highlight-orange">last month</span>.', question: 'Last month, Lily ___ her birthday.', choices: ['celebrated üåô', 'celebrates ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last month ‚Üí celebrated', tip: 'üåô last month = th√°ng tr∆∞·ªõc' },
        { image: 'üö´üéÅ', text: 'She <span class="highlight-orange">didn\'t get</span> a bike <span class="highlight-orange">last month</span>.', question: 'Last month, she ___ get a bike.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! last month ‚Üí didn\'t', tip: 'üö´ last month ‚Üí didn\'t' },
        { image: '‚ùìüéâ', text: '"<span class="highlight-orange">Did friends come</span> to the party <span class="highlight-orange">last month</span>?"', question: '___ friends come to the party last month?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! last month ‚Üí Did', tip: '‚ùì last month ‚Üí Did...?' },
        { image: 'üè†üë®‚Äçüë©‚Äçüëß', text: 'We <span class="highlight-orange">moved</span> to a new house <span class="highlight-orange">last month</span>.', question: 'Last month, we ___ to a new house.', choices: ['moved üåô', 'move ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last month ‚Üí moved', tip: 'üåô last month ‚Üí qu√° kh·ª©' },
        { image: 'üö´üêï', text: 'We <span class="highlight-orange">didn\'t buy</span> a dog <span class="highlight-orange">last month</span>.', question: 'Last month, we didn\'t ___ a dog.', choices: ['buy üö´', 'bought üö´'], correct: 0, feedback: 'Excellent! didn\'t + buy (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüå≥', text: '"<span class="highlight-orange">Did they plant</span> trees <span class="highlight-orange">last month</span>?"', question: 'Did they ___ trees last month?', choices: ['plant ‚ùì', 'planted ‚ùì'], correct: 0, feedback: 'Great! Did + plant (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST YEAR =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚úàÔ∏èüë®‚Äçüë©‚Äçüëß', text: 'We <span class="highlight-orange">went</span> to Japan <span class="highlight-orange">last year</span>.', question: 'Last year, we ___ to Japan.', choices: ['went üåô', 'go ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last year ‚Üí went', tip: 'üåô last year = nƒÉm ngo√°i' },
        { image: 'üö´üèîÔ∏è', text: 'We <span class="highlight-orange">didn\'t climb</span> a mountain <span class="highlight-orange">last year</span>.', question: 'Last year, we ___ climb a mountain.', choices: ['didn\'t üö´', 'don\'t üö´', 'doesn\'t üö´'], correct: 0, feedback: 'Great! last year ‚Üí didn\'t', tip: 'üö´ last year ‚Üí didn\'t' },
        { image: '‚ùìüåä', text: '"<span class="highlight-orange">Did you swim</span> in the sea <span class="highlight-orange">last year</span>?"', question: '___ you swim in the sea last year?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! last year ‚Üí Did', tip: '‚ùì last year ‚Üí Did...?' },
        { image: 'üéìüëß', text: 'Lily <span class="highlight-orange">finished</span> grade 2 <span class="highlight-orange">last year</span>.', question: 'Last year, Lily ___ grade 2.', choices: ['finished üåô', 'finishes ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last year ‚Üí finished', tip: 'üåô last year ‚Üí qu√° kh·ª©' },
        { image: 'üö´üèÜ', text: 'Tom <span class="highlight-orange">didn\'t win</span> any prize <span class="highlight-orange">last year</span>.', question: 'Last year, Tom didn\'t ___ any prize.', choices: ['win üö´', 'won üö´'], correct: 0, feedback: 'Excellent! didn\'t + win (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüéÑ', text: '"<span class="highlight-orange">Did they visit</span> grandma <span class="highlight-orange">last year</span>?"', question: 'Did they ___ grandma last year?', choices: ['visit ‚ùì', 'visited ‚ùì'], correct: 0, feedback: 'Great! Did + visit (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== ...AGO =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'üéíüëß', text: 'Lily <span class="highlight-orange">started</span> school <span class="highlight-orange">2 years ago</span>.', question: '2 years ago, Lily ___ school.', choices: ['started üåô', 'starts ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! ...ago ‚Üí started', tip: 'üåô ...ago = c√°ch ƒë√¢y...' },
        { image: 'üö´üò¢', text: 'She <span class="highlight-orange">didn\'t cry</span> <span class="highlight-orange">2 years ago</span>.', question: '2 years ago, she ___ cry.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! ...ago ‚Üí didn\'t', tip: 'üö´ ...ago ‚Üí didn\'t' },
        { image: '‚ùìüë´', text: '"<span class="highlight-orange">Did she make</span> friends <span class="highlight-orange">2 years ago</span>?"', question: '___ she make friends 2 years ago?', choices: ['Did ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Perfect! ...ago ‚Üí Did', tip: '‚ùì ...ago ‚Üí Did...?' },
        { image: 'üêïüë¶', text: 'Tom <span class="highlight-orange">got</span> a dog <span class="highlight-orange">3 months ago</span>.', question: '3 months ago, Tom ___ a dog.', choices: ['got üåô', 'gets ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! ...ago ‚Üí got', tip: 'üåô ...ago ‚Üí qu√° kh·ª©' },
        { image: 'üö´üê±', text: 'He <span class="highlight-orange">didn\'t get</span> a cat <span class="highlight-orange">3 months ago</span>.', question: '3 months ago, he didn\'t ___ a cat.', choices: ['get üö´', 'got üö´'], correct: 0, feedback: 'Excellent! didn\'t + get (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüè†', text: '"<span class="highlight-orange">Did they move</span> <span class="highlight-orange">5 years ago</span>?"', question: 'Did they ___ 5 years ago?', choices: ['move ‚ùì', 'moved ‚ùì'], correct: 0, feedback: 'Great! Did + move (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== IN 2023 =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üë∂', text: 'My sister <span class="highlight-orange">was born</span> <span class="highlight-orange">in 2020</span>.', question: 'In 2020, my sister ___ born.', choices: ['was üåô', 'is ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! in 2020 ‚Üí was', tip: 'üåô in + nƒÉm = qu√° kh·ª©' },
        { image: 'üö´üè´', text: 'I <span class="highlight-orange">didn\'t go</span> to school <span class="highlight-orange">in 2020</span>.', question: 'In 2020, I ___ go to school.', choices: ['didn\'t üö´', 'don\'t üö´', 'doesn\'t üö´'], correct: 0, feedback: 'Great! in 2020 ‚Üí didn\'t', tip: 'üö´ in + nƒÉm ‚Üí didn\'t' },
        { image: '‚ùìüè†', text: '"<span class="highlight-orange">Did you stay</span> home <span class="highlight-orange">in 2020</span>?"', question: '___ you stay home in 2020?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! in 2020 ‚Üí Did', tip: '‚ùì in + nƒÉm ‚Üí Did...?' },
        { image: 'üéÆüë¶', text: 'Tom <span class="highlight-orange">got</span> a new game <span class="highlight-orange">in 2023</span>.', question: 'In 2023, Tom ___ a new game.', choices: ['got üåô', 'gets ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! in 2023 ‚Üí got', tip: 'üåô in + nƒÉm ‚Üí qu√° kh·ª©' },
        { image: 'üö´üì±', text: 'He <span class="highlight-orange">didn\'t have</span> a phone <span class="highlight-orange">in 2021</span>.', question: 'In 2021, he didn\'t ___ a phone.', choices: ['have üö´', 'had üö´'], correct: 0, feedback: 'Excellent! didn\'t + have (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüåç', text: '"<span class="highlight-orange">Did they travel</span> <span class="highlight-orange">in 2022</span>?"', question: 'Did they ___ in 2022?', choices: ['travel ‚ùì', 'traveled ‚ùì'], correct: 0, feedback: 'Great! Did + travel (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    }
  ],
  stories: [
    // ===== MIX: Every day vs Yesterday =====
    {
      bg: 'bg-home',
      scenes: [
        { image: '‚òÄÔ∏èüç≥', text: '<span class="highlight">Every day</span>, Lily <span class="highlight-green">eats</span> breakfast.', question: 'every day ‚Üí Lily ___ breakfast.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! every day ‚Üí eats', tip: '‚òÄÔ∏è every day ‚Üí hi·ªán t·∫°i' },
        { image: 'üåôü•û', text: '<span class="highlight-orange">Yesterday</span>, she <span class="highlight-orange">ate</span> pancakes.', question: 'yesterday ‚Üí she ___ pancakes.', choices: ['ate üåô', 'eats ‚òÄÔ∏è'], correct: 0, feedback: 'Great! yesterday ‚Üí ate', tip: 'üåô yesterday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'She <span class="highlight-green">doesn\'t drink</span> coffee <span class="highlight">every morning</span>.', question: 'every morning ‚Üí she ___ drink coffee.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! every morning ‚Üí doesn\'t', tip: '‚òÄÔ∏è every morning ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'She <span class="highlight-orange">didn\'t drink</span> milk <span class="highlight-orange">last night</span>.', question: 'last night ‚Üí she ___ drink milk.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí didn\'t', tip: 'üåô last night ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> she go to school <span class="highlight">every day</span>?"', question: 'every day ‚Üí ___ she go to school?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! every day ‚Üí Does', tip: '‚òÄÔ∏è every day ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> she go to school <span class="highlight-orange">yesterday</span>?"', question: 'yesterday ‚Üí ___ she go to school?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! yesterday ‚Üí Did', tip: 'üåô yesterday ‚Üí Did...?' }
      ]
    },
    // ===== MIX: Always/Usually vs Last week =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚òÄÔ∏è‚öΩ', text: 'Tom <span class="highlight">always</span> <span class="highlight-green">plays</span> football.', question: 'always ‚Üí Tom ___ football.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! always ‚Üí plays', tip: '‚òÄÔ∏è always ‚Üí hi·ªán t·∫°i' },
        { image: 'üåô‚öΩ', text: 'He <span class="highlight-orange">played</span> in a match <span class="highlight-orange">last Saturday</span>.', question: 'last Saturday ‚Üí he ___ in a match.', choices: ['played üåô', 'plays ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last Saturday ‚Üí played', tip: 'üåô last Saturday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'He <span class="highlight">usually</span> <span class="highlight-green">doesn\'t lose</span>.', question: 'usually ‚Üí he ___ lose.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! usually ‚Üí doesn\'t', tip: '‚òÄÔ∏è usually ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'But he <span class="highlight-orange">didn\'t win</span> <span class="highlight-orange">last week</span>.', question: 'last week ‚Üí he ___ win.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last week ‚Üí didn\'t', tip: 'üåô last week ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> he <span class="highlight">often</span> score goals?"', question: 'often ‚Üí ___ he score goals?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! often ‚Üí Does', tip: '‚òÄÔ∏è often ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> he score <span class="highlight-orange">last month</span>?"', question: 'last month ‚Üí ___ he score?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last month ‚Üí Did', tip: 'üåô last month ‚Üí Did...?' }
      ]
    },
    // ===== MIX: Sometimes vs ...ago =====
    {
      bg: 'bg-home',
      scenes: [
        { image: '‚òÄÔ∏èüéÆ', text: 'Lily <span class="highlight">sometimes</span> <span class="highlight-green">plays</span> video games.', question: 'sometimes ‚Üí Lily ___ video games.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! sometimes ‚Üí plays', tip: '‚òÄÔ∏è sometimes ‚Üí hi·ªán t·∫°i' },
        { image: 'üåôüéÆ', text: 'She <span class="highlight-orange">played</span> a new game <span class="highlight-orange">2 days ago</span>.', question: '2 days ago ‚Üí she ___ a new game.', choices: ['played üåô', 'plays ‚òÄÔ∏è'], correct: 0, feedback: 'Great! ...ago ‚Üí played', tip: 'üåô ...ago ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'She <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t do</span> homework on time.', question: 'sometimes ‚Üí she ___ do homework on time.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! sometimes ‚Üí doesn\'t', tip: '‚òÄÔ∏è sometimes ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'She <span class="highlight-orange">didn\'t finish</span> her project <span class="highlight-orange">a week ago</span>.', question: 'a week ago ‚Üí she ___ finish her project.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! ...ago ‚Üí didn\'t', tip: 'üåô ...ago ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> she <span class="highlight">often</span> help Mom?"', question: 'often ‚Üí ___ she help Mom?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! often ‚Üí Does', tip: '‚òÄÔ∏è often ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> she help <span class="highlight-orange">in 2023</span>?"', question: 'in 2023 ‚Üí ___ she help?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! in 2023 ‚Üí Did', tip: 'üåô in 2023 ‚Üí Did...?' }
      ]
    },
    // ===== MIX: Every week vs Last year =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚òÄÔ∏èüèä', text: 'We <span class="highlight-green">go</span> swimming <span class="highlight">every week</span>.', question: 'every week ‚Üí we ___ swimming.', choices: ['go ‚òÄÔ∏è', 'went üåô'], correct: 0, feedback: 'Yes! every week ‚Üí go', tip: '‚òÄÔ∏è every week ‚Üí hi·ªán t·∫°i' },
        { image: 'üåôüèä', text: 'We <span class="highlight-orange">went</span> to the beach <span class="highlight-orange">last year</span>.', question: 'last year ‚Üí we ___ to the beach.', choices: ['went üåô', 'go ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last year ‚Üí went', tip: 'üåô last year ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'We <span class="highlight-green">don\'t swim</span> in winter <span class="highlight">every year</span>.', question: 'every year ‚Üí we ___ swim in winter.', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! every year ‚Üí don\'t', tip: '‚òÄÔ∏è every year ‚Üí don\'t' },
        { image: 'üö´üåô', text: 'We <span class="highlight-orange">didn\'t travel</span> <span class="highlight-orange">last summer</span>.', question: 'last summer ‚Üí we ___ travel.', choices: ['didn\'t üåô', 'don\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last summer ‚Üí didn\'t', tip: 'üåô last summer ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Do</span> you <span class="highlight">usually</span> go on vacation?"', question: 'usually ‚Üí ___ you go on vacation?', choices: ['Do ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! usually ‚Üí Do', tip: '‚òÄÔ∏è usually ‚Üí Do...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> you visit grandma <span class="highlight-orange">last holiday</span>?"', question: 'last holiday ‚Üí ___ you visit grandma?', choices: ['Did üåô', 'Do ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last holiday ‚Üí Did', tip: 'üåô last holiday ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - Animals =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'üêï‚òÄÔ∏è', text: 'Dogs <span class="highlight">always</span> <span class="highlight-green">love</span> bones.', question: 'always ‚Üí dogs ___ bones.', choices: ['love ‚òÄÔ∏è', 'loved üåô'], correct: 0, feedback: 'Yes! always ‚Üí love', tip: '‚òÄÔ∏è always ‚Üí hi·ªán t·∫°i' },
        { image: 'üêïüåô', text: 'My dog <span class="highlight-orange">ate</span> a big bone <span class="highlight-orange">yesterday</span>.', question: 'yesterday ‚Üí my dog ___ a big bone.', choices: ['ate üåô', 'eats ‚òÄÔ∏è'], correct: 0, feedback: 'Great! yesterday ‚Üí ate', tip: 'üåô yesterday ‚Üí qu√° kh·ª©' },
        { image: 'üö´üê±‚òÄÔ∏è', text: 'Cats <span class="highlight-green">don\'t like</span> water.', question: 'Cats ___ like water. (fact)', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! Fact ‚Üí don\'t', tip: '‚òÄÔ∏è S·ª± th·∫≠t ‚Üí don\'t' },
        { image: 'üö´üê±üåô', text: 'My cat <span class="highlight-orange">didn\'t eat</span> fish <span class="highlight-orange">last night</span>.', question: 'last night ‚Üí my cat ___ eat fish.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí didn\'t', tip: 'üåô last night ‚Üí didn\'t' },
        { image: '‚ùìüê¶‚òÄÔ∏è', text: '"<span class="highlight-green">Do</span> birds <span class="highlight">usually</span> fly south in winter?"', question: 'usually ‚Üí ___ birds fly south?', choices: ['Do ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! usually ‚Üí Do', tip: '‚òÄÔ∏è usually ‚Üí Do...?' },
        { image: '‚ùìüê¶üåô', text: '"<span class="highlight-orange">Did</span> you see birds <span class="highlight-orange">3 days ago</span>?"', question: '3 days ago ‚Üí ___ you see birds?', choices: ['Did üåô', 'Do ‚òÄÔ∏è'], correct: 0, feedback: 'Great! ...ago ‚Üí Did', tip: 'üåô ...ago ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - School =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'üè´‚òÄÔ∏è', text: 'We <span class="highlight-green">go</span> to school <span class="highlight">every day</span>.', question: 'every day ‚Üí we ___ to school.', choices: ['go ‚òÄÔ∏è', 'went üåô'], correct: 0, feedback: 'Yes! every day ‚Üí go', tip: '‚òÄÔ∏è every day ‚Üí hi·ªán t·∫°i' },
        { image: 'üè´üåô', text: 'We <span class="highlight-orange">had</span> a field trip <span class="highlight-orange">last Friday</span>.', question: 'last Friday ‚Üí we ___ a field trip.', choices: ['had üåô', 'have ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last Friday ‚Üí had', tip: 'üåô last Friday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'We <span class="highlight-green">don\'t have</span> school on Sunday.', question: 'We ___ have school on Sunday.', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! Fact ‚Üí don\'t', tip: '‚òÄÔ∏è Quy t·∫Øc ‚Üí don\'t' },
        { image: 'üö´üåô', text: 'We <span class="highlight-orange">didn\'t have</span> homework <span class="highlight-orange">yesterday</span>.', question: 'yesterday ‚Üí we ___ have homework.', choices: ['didn\'t üåô', 'don\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! yesterday ‚Üí didn\'t', tip: 'üåô yesterday ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> the teacher <span class="highlight">always</span> give tests?"', question: 'always ‚Üí ___ the teacher give tests?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! always ‚Üí Does', tip: '‚òÄÔ∏è always ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> you pass the test <span class="highlight-orange">last month</span>?"', question: 'last month ‚Üí ___ you pass the test?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last month ‚Üí Did', tip: 'üåô last month ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - Food =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üçé‚òÄÔ∏è', text: 'I <span class="highlight">usually</span> <span class="highlight-green">eat</span> fruit for breakfast.', question: 'usually ‚Üí I ___ fruit for breakfast.', choices: ['eat ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! usually ‚Üí eat', tip: '‚òÄÔ∏è usually ‚Üí hi·ªán t·∫°i' },
        { image: 'üçïüåô', text: 'I <span class="highlight-orange">ate</span> pizza <span class="highlight-orange">last weekend</span>.', question: 'last weekend ‚Üí I ___ pizza.', choices: ['ate üåô', 'eat ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last weekend ‚Üí ate', tip: 'üåô last weekend ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'I <span class="highlight-green">don\'t eat</span> spicy food <span class="highlight">every day</span>.', question: 'every day ‚Üí I ___ eat spicy food.', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! every day ‚Üí don\'t', tip: '‚òÄÔ∏è every day ‚Üí don\'t' },
        { image: 'üö´üåô', text: 'I <span class="highlight-orange">didn\'t eat</span> breakfast <span class="highlight-orange">yesterday</span>.', question: 'yesterday ‚Üí I ___ eat breakfast.', choices: ['didn\'t üåô', 'don\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! yesterday ‚Üí didn\'t', tip: 'üåô yesterday ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Do</span> you <span class="highlight">sometimes</span> eat ice cream?"', question: 'sometimes ‚Üí ___ you eat ice cream?', choices: ['Do ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! sometimes ‚Üí Do', tip: '‚òÄÔ∏è sometimes ‚Üí Do...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> you try the new restaurant <span class="highlight-orange">2 weeks ago</span>?"', question: '2 weeks ago ‚Üí ___ you try the new restaurant?', choices: ['Did üåô', 'Do ‚òÄÔ∏è'], correct: 0, feedback: 'Great! ...ago ‚Üí Did', tip: 'üåô ...ago ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - Family =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üë®‚Äçüë©‚Äçüëß‚òÄÔ∏è', text: 'My family <span class="highlight">often</span> <span class="highlight-green">eats</span> dinner together.', question: 'often ‚Üí my family ___ dinner together.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! often ‚Üí eats', tip: '‚òÄÔ∏è often ‚Üí hi·ªán t·∫°i' },
        { image: 'üë®‚Äçüë©‚Äçüëßüåô', text: 'We <span class="highlight-orange">went</span> to a restaurant <span class="highlight-orange">last Sunday</span>.', question: 'last Sunday ‚Üí we ___ to a restaurant.', choices: ['went üåô', 'go ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last Sunday ‚Üí went', tip: 'üåô last Sunday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'Dad <span class="highlight-green">doesn\'t work</span> on weekends.', question: 'Dad ___ work on weekends.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! Fact ‚Üí doesn\'t', tip: '‚òÄÔ∏è Quy t·∫Øc ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'Mom <span class="highlight-orange">didn\'t cook</span> <span class="highlight-orange">last night</span>.', question: 'last night ‚Üí Mom ___ cook.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí didn\'t', tip: 'üåô last night ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> your sister <span class="highlight">always</span> help with chores?"', question: 'always ‚Üí ___ your sister help with chores?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! always ‚Üí Does', tip: '‚òÄÔ∏è always ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> grandma visit <span class="highlight-orange">last month</span>?"', question: 'last month ‚Üí ___ grandma visit?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last month ‚Üí Did', tip: 'üåô last month ‚Üí Did...?' }
      ]
    }
  ]
};
var WORD_GAMES = {
  matching: [
    { now: 'go', past: 'went', meaning: 'ƒëi' },
    { now: 'eat', past: 'ate', meaning: 'ƒÉn' },
    { now: 'see', past: 'saw', meaning: 'th·∫•y' },
    { now: 'have', past: 'had', meaning: 'c√≥' },
    { now: 'make', past: 'made', meaning: 'l√†m' },
    { now: 'come', past: 'came', meaning: 'ƒë·∫øn' },
    { now: 'take', past: 'took', meaning: 'l·∫•y' },
    { now: 'give', past: 'gave', meaning: 'cho' },
    { now: 'run', past: 'ran', meaning: 'ch·∫°y' },
    { now: 'swim', past: 'swam', meaning: 'b∆°i' },
    { now: 'drink', past: 'drank', meaning: 'u·ªëng' },
    { now: 'sing', past: 'sang', meaning: 'h√°t' },
    { now: 'sleep', past: 'slept', meaning: 'ng·ªß' },
    { now: 'write', past: 'wrote', meaning: 'vi·∫øt' },
    { now: 'read', past: 'read', meaning: 'ƒë·ªçc' },
    { now: 'buy', past: 'bought', meaning: 'mua' },
    { now: 'get', past: 'got', meaning: 'ƒë∆∞·ª£c' },
    { now: 'sit', past: 'sat', meaning: 'ng·ªìi' },
    { now: 'stand', past: 'stood', meaning: 'ƒë·ª©ng' },
    { now: 'fly', past: 'flew', meaning: 'bay' },
    { now: 'do', past: 'did', meaning: 'l√†m' },
    { now: 'say', past: 'said', meaning: 'n√≥i' },
    { now: 'tell', past: 'told', meaning: 'k·ªÉ' },
    { now: 'think', past: 'thought', meaning: 'nghƒ©' },
    { now: 'know', past: 'knew', meaning: 'bi·∫øt' },
    { now: 'put', past: 'put', meaning: 'ƒë·∫∑t' },
    { now: 'cut', past: 'cut', meaning: 'c·∫Øt' },
    { now: 'draw', past: 'drew', meaning: 'v·∫Ω' },
    { now: 'grow', past: 'grew', meaning: 'l·ªõn l√™n' },
    { now: 'throw', past: 'threw', meaning: 'n√©m' },
    { now: 'catch', past: 'caught', meaning: 'b·∫Øt' },
    { now: 'teach', past: 'taught', meaning: 'd·∫°y' },
    { now: 'bring', past: 'brought', meaning: 'mang' },
    { now: 'find', past: 'found', meaning: 't√¨m th·∫•y' },
    { now: 'feel', past: 'felt', meaning: 'c·∫£m th·∫•y' },
    { now: 'leave', past: 'left', meaning: 'r·ªùi ƒëi' },
    { now: 'meet', past: 'met', meaning: 'g·∫∑p' },
    { now: 'send', past: 'sent', meaning: 'g·ª≠i' },
    { now: 'build', past: 'built', meaning: 'x√¢y' },
    { now: 'wear', past: 'wore', meaning: 'm·∫∑c' }
  ]
};

// ============ STATE ============
var soundEnabled = true;
var currentTopic = '';
var currentStory = 0;
var currentScene = 0;
var stars = 0;
var totalQuestions = 0;
var correctAnswers = 0;
var questionsPerRound = 6; // S·ªë c√¢u m·ªói l∆∞·ª£t
var allQuestions = []; // M·∫£ng ch·ª©a c√¢u h·ªèi ƒë√£ tr·ªôn
var currentQuestionIndex = 0;

// H·ªá th·ªëng t√≠ch l≈©y sao
var totalStars = 0;
var todayStars = 0;
var streakDays = 0;
var todayMistakes = []; // Theo d√µi c√¢u sai h√¥m nay

// Load sao t·ª´ localStorage
function loadStarData() {
  try {
    var saved = localStorage.getItem('verbStarData');
    if (saved) {
      var data = JSON.parse(saved);
      totalStars = data.totalStars || 0;
      
      // Ki·ªÉm tra ng√†y h√¥m nay
      var today = new Date().toDateString();
      if (data.lastDate === today) {
        todayStars = data.todayStars || 0;
        todayMistakes = data.todayMistakes || [];
      } else {
        todayStars = 0;
        todayMistakes = []; // Reset c√¢u sai m·ªói ng√†y m·ªõi
        // Ki·ªÉm tra streak
        var lastDate = new Date(data.lastDate);
        var todayDate = new Date(today);
        var diffDays = Math.floor((todayDate - lastDate) / (1000 * 60 * 60 * 24));
        if (diffDays === 1) {
          streakDays = (data.streakDays || 0) + 1;
        } else if (diffDays > 1) {
          streakDays = 1;
        } else {
          streakDays = data.streakDays || 1;
        }
      }
      streakDays = data.streakDays || 1;
    }
  } catch(e) {
    console.log('Cannot load star data');
  }
}

// L∆∞u sao v√†o localStorage
function saveStarData() {
  try {
    var data = {
      totalStars: totalStars,
      todayStars: todayStars,
      lastDate: new Date().toDateString(),
      streakDays: streakDays,
      todayMistakes: todayMistakes
    };
    localStorage.setItem('verbStarData', JSON.stringify(data));
  } catch(e) {
    console.log('Cannot save star data');
  }
}

// Th√™m c√¢u sai v√†o danh s√°ch
function addMistake(mistakeData) {
  // Ki·ªÉm tra xem ƒë√£ c√≥ c√¢u t∆∞∆°ng t·ª± ch∆∞a (tr√°nh tr√πng l·∫∑p)
  var isDuplicate = todayMistakes.some(function(m) {
    return m.sentence === mistakeData.sentence && m.correctAnswer === mistakeData.correctAnswer;
  });
  
  if (!isDuplicate) {
    mistakeData.timestamp = new Date().toLocaleTimeString('vi-VN', {hour: '2-digit', minute: '2-digit'});
    todayMistakes.push(mistakeData);
    saveStarData();
  }
}

// X√≥a m·ªôt c√¢u sai kh·ªèi danh s√°ch (khi ƒë√£ √¥n t·∫≠p ƒë√∫ng)
function removeMistake(index) {
  if (index >= 0 && index < todayMistakes.length) {
    todayMistakes.splice(index, 1);
    saveStarData();
  }
}

// Th√™m sao
function addStars(count) {
  stars += count;
  totalStars += count;
  todayStars += count;
  saveStarData();
}

// Matching game state
var matchCards = [];
var selectedCard = null;
var matchedPairs = [];

// Flashcard state
var flashcardIndex = 0;
var isFlipped = false;

// ============ LEVEL SELECT ============
function showSimpleTenseSelect() {
  playSound('click');
  var html = '<div class="level-content">' +
    '<div style="text-align:left;margin-bottom:10px"><button class="back-btn" onclick="goHome()">‚Üê Home</button></div>' +
    '<div style="font-size:50px;margin-bottom:10px">‚òÄÔ∏èüåô</div>' +
    '<div class="level-title">Simple Tenses</div>' +
    '<div class="level-subtitle">Ch·ªçn ch·ªß ƒë·ªÅ con mu·ªën luy·ªán:</div>' +
    '<div class="level-cards">' +
    '<div class="level-card easy" onclick="showLevelSelect(\'daily\')">' +
    '<div class="level-icon">‚òÄÔ∏è</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Every Day</div>' +
    '<div class="level-desc">Present Simple - Th√¨ hi·ªán t·∫°i ƒë∆°n</div>' +
    '</div></div>' +
    '<div class="level-card medium" onclick="showLevelSelect(\'yesterday\')">' +
    '<div class="level-icon">üåô</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Yesterday</div>' +
    '<div class="level-desc">Past Simple - Th√¨ qu√° kh·ª© ƒë∆°n</div>' +
    '</div></div>' +
    '</div></div>';
  document.getElementById('quizArea').innerHTML = html;
  showScreen('quizScreen');
}

function showLevelSelect(topic) {
  playSound('click');
  currentTopic = topic;
  
  var topicName = topic === 'daily' ? 'Every Day' : 
                  topic === 'yesterday' ? 'Yesterday' : 'Mix Stories';
  
  var html = '<div class="level-content">' +
    '<div style="text-align:left;margin-bottom:10px"><button class="back-btn" onclick="goHome()">‚Üê Home</button></div>' +
    '<div style="font-size:60px;margin-bottom:15px">' + 
    (topic === 'daily' ? '‚òÄÔ∏è' : topic === 'yesterday' ? 'üåô' : 'üìñ') + '</div>' +
    '<div class="level-title">' + topicName + '</div>' +
    '<div class="level-subtitle">Ch·ªçn s·ªë c√¢u h·ªèi con mu·ªën l√†m:</div>' +
    
    '<div class="level-cards">' +
    '<div class="level-card easy" onclick="startWithLevel(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Nhanh</div>' +
    '<div class="level-desc">Luy·ªán t·∫≠p nh·∫π nh√†ng</div>' +
    '</div>' +
    '<div class="level-time">5 c√¢u ‚Ä¢ 3 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card medium" onclick="startWithLevel(8)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info">' +
    '<div class="level-name">V·ª´a ph·∫£i</div>' +
    '<div class="level-desc">√în t·∫≠p c∆° b·∫£n</div>' +
    '</div>' +
    '<div class="level-time">8 c√¢u ‚Ä¢ 5 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card hard" onclick="startWithLevel(10)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Th·ª≠ th√°ch</div>' +
    '<div class="level-desc">Ki·ªÉm tra ki·∫øn th·ª©c</div>' +
    '</div>' +
    '<div class="level-time">10 c√¢u ‚Ä¢ 8 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card" onclick="startWithLevel(15)" style="border-color:#9C27B0">' +
    '<div class="level-icon">üèÜ</div>' +
    '<div class="level-info">' +
    '<div class="level-name" style="color:#7B1FA2">Si√™u sao</div>' +
    '<div class="level-desc">D√†nh cho cao th·ªß!</div>' +
    '</div>' +
    '<div class="level-time">15 c√¢u ‚Ä¢ 12 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card" onclick="startWithLevel(20)" style="border-color:#FF6D00;background:linear-gradient(135deg,#FFF8E1,#FFECB3)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info">' +
    '<div class="level-name" style="color:#E65100">Huy·ªÅn tho·∫°i</div>' +
    '<div class="level-desc">Boss cu·ªëi ƒë√¢y r·ªìi! üëæ</div>' +
    '</div>' +
    '<div class="level-time">20 c√¢u ‚Ä¢ 15 ph√∫t</div>' +
    '</div>' +
    '</div>'; // close level-cards
  
  // Growth mindset motivation
  var stMotivMessages = [
    'üí™ M·ªói l·∫ßn luy·ªán t·∫≠p l√† m·ªói l·∫ßn n√£o b·ªô m·∫°nh h∆°n!',
    'üå± Sai kh√¥ng sao ‚Äî ƒë√≥ l√† c√°ch con h·ªçc ƒë∆∞·ª£c!',
    'üî• Con kh√¥ng c·∫ßn ho√†n h·∫£o, ch·ªâ c·∫ßn c·ªë g·∫Øng m·ªói ng√†y!',
    'üß† N√£o con ƒëang t·∫°o th√™m k·∫øt n·ªëi m·ªói khi con luy·ªán t·∫≠p!',
    '‚≠ê ƒêi·ªÅu quan tr·ªçng kh√¥ng ph·∫£i l√† ƒëi·ªÉm s·ªë ‚Äî m√† l√† s·ª± n·ªó l·ª±c!',
    'üöÄ M·ªói c√¢u h·ªèi l√† m·ªôt b∆∞·ªõc ti·∫øn ‚Äî d√π ƒë√∫ng hay sai!',
    'üåà Con ƒë√£ d≈©ng c·∫£m khi b·∫•m v√†o ƒë√¢y ‚Äî b·∫Øt ƒë·∫ßu th√¥i!',
    'üéØ Luy·ªán t·∫≠p ƒë·ªÅu ƒë·∫∑n quan tr·ªçng h∆°n l√†m ƒë√∫ng h·∫øt!',
    'üí° Khi con th·∫•y kh√≥, nghƒ©a l√† n√£o con ƒëang l·ªõn l√™n!',
    'üèÉ Kh√¥ng ai gi·ªèi ngay t·ª´ ƒë·∫ßu ‚Äî t·∫•t c·∫£ ƒë·ªÅu nh·ªù luy·ªán t·∫≠p!'
  ];
  var stMotiv = stMotivMessages[Math.floor(Math.random() * stMotivMessages.length)];
  html += '<div style="text-align:center;margin-top:15px;padding:14px;background:rgba(255,255,255,0.15);border-radius:15px;color:white;font-size:0.95rem">' +
    stMotiv + '</div>';

  html += '</div>'; // close level-content

  document.getElementById('levelScreen').innerHTML = html;
  showScreen('levelScreen');
}

function startWithLevel(numQuestions) {
  playSound('click');
  questionsPerRound = numQuestions;
  
  // Thu th·∫≠p t·∫•t c·∫£ c√¢u h·ªèi t·ª´ topic
  allQuestions = [];
  
  if (currentTopic === 'daily') {
    // Every Day: ch·ªâ d√πng c√¢u hi·ªán t·∫°i
    allQuestions = generateStoriesFromTemplates(numQuestions, false);
  } else if (currentTopic === 'yesterday') {
    // Yesterday: ch·ªâ d√πng c√¢u qu√° kh·ª©
    allQuestions = generateStoriesFromTemplates(numQuestions, true);
  } else if (currentTopic === 'stories') {
    // Mix Stories: mix c·∫£ hai
    allQuestions = generateMixStoryQuestions(numQuestions);
  }
  
  // ƒê·∫£m b·∫£o ch·ªâ l·∫•y ƒë√∫ng s·ªë c√¢u h·ªèi y√™u c·∫ßu
  allQuestions = allQuestions.slice(0, numQuestions);
  
  // Reset state
  currentQuestionIndex = 0;
  stars = 0;
  correctAnswers = 0;
  totalQuestions = numQuestions;
  
  // B·∫Øt ƒë·∫ßu hi·ªÉn th·ªã c√¢u h·ªèi
  showQuestion();
}

// Generate questions cho Daily ho·∫∑c Yesterday
function generateStoriesFromTemplates(count, isPastOnly) {
  var questions = [];
  var usedTemplates = [];
  
  var signalList = isPastOnly ? SIGNAL_WORDS.past : SIGNAL_WORDS.present;
  var bg = isPastOnly ? 'bg-night' : 'bg-sunny';
  
  for (var i = 0; i < count; i++) {
    var templateIndex;
    do {
      templateIndex = Math.floor(Math.random() * SENTENCE_TEMPLATES.length);
    } while (usedTemplates.indexOf(templateIndex) >= 0 && usedTemplates.length < SENTENCE_TEMPLATES.length);
    usedTemplates.push(templateIndex);
    
    var template = SENTENCE_TEMPLATES[templateIndex];
    var verbForms = getVerbForms(template.verb);
    var sentenceType = template.type || 'affirm';
    
    var signalObj = signalList[Math.floor(Math.random() * signalList.length)];
    
    var correctAnswer, wrongAnswer;
    var subject = template.subject.toLowerCase();
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(subject) >= 0;
    
    if (sentenceType === 'affirm') {
      correctAnswer = isPastOnly ? verbForms.past : getPresentForm(verbForms.base, template.subject);
      wrongAnswer = isPastOnly ? getPresentForm(verbForms.base, template.subject) : verbForms.past;
    } else if (sentenceType === 'negative') {
      if (isPastOnly) {
        correctAnswer = "didn't";
        wrongAnswer = isThirdPerson ? "doesn't" : "don't";
      } else {
        correctAnswer = isThirdPerson ? "doesn't" : "don't";
        wrongAnswer = "didn't";
      }
    } else if (sentenceType === 'question') {
      if (isPastOnly) {
        correctAnswer = "Did";
        wrongAnswer = isThirdPerson ? "Does" : "Do";
      } else {
        correctAnswer = isThirdPerson ? "Does" : "Do";
        wrongAnswer = "Did";
      }
    } else if (sentenceType === 'question_verb') {
      // C√¢u h·ªèi ƒë√£ c√≥ Do/Does/Did, c·∫ßn ƒëi·ªÅn ƒë·ªông t·ª´ g·ªëc
      correctAnswer = verbForms.base;
      // Wrong answer: d·∫°ng qu√° kh·ª© (V2) ho·∫∑c V-s/es
      wrongAnswer = verbForms.past;
    }
    
    // Hi·ªÉn th·ªã c√¢u v·ªõi ch·ªó tr·ªëng v√† g·∫°ch ch√¢n d·∫•u hi·ªáu
    var underlinedSignal = '<span style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:600">' + signalObj.signal + '</span>';
    var displayText = template.template
      .replace('{signal}', underlinedSignal)
      .replace('___', '<span style="color:#667eea;font-weight:700;border-bottom:2px solid #667eea;padding:0 8px">____</span>');
    
    var choices, correctIdx;
    
    // X·ª≠ l√Ω ƒë·∫∑c bi·ªát cho question_verb: 3 l·ª±a ch·ªçn
    if (sentenceType === 'question_verb') {
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, 'She'); // V-s/es
      
      choices = [
        { text: vBase, correct: true },
        { text: vPast, correct: false },
        { text: vPresent, correct: false }
      ];
      
      // Lo·∫°i b·ªè ƒë√°p √°n tr√πng
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      
      // Th√™m ƒë√°p √°n g√¢y nhi·ªÖu n·∫øu thi·∫øu
      var extraVerbs = ['went', 'goes', 'ate', 'eats', 'took', 'takes', 'saw', 'sees'];
      var ei = 0;
      while (choices.length < 3 && ei < extraVerbs.length) {
        if (choices.findIndex(function(c) { return c.text === extraVerbs[ei]; }) < 0) {
          choices.push({ text: extraVerbs[ei], correct: false });
        }
        ei++;
      }
      
      choices = shuffle(choices);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      choices = choices.map(function(c) { return c.text; });
    } else if (sentenceType === 'affirm') {
      // C√¢u kh·∫≥ng ƒë·ªãnh: 3 l·ª±a ch·ªçn - V g·ªëc, V-s/es, V2
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, template.subject);
      var vPresentThird = getPresentForm(verbForms.base, 'She'); // V-s/es cho ng√¥i 3
      
      choices = [
        { text: correctAnswer, correct: true },
        { text: wrongAnswer, correct: false },
        { text: vBase, correct: false }
      ];
      
      // Th√™m c√°c d·∫°ng kh√°c n·∫øu ch∆∞a c√≥
      if (choices.findIndex(function(c) { return c.text === vPast; }) < 0) {
        choices.push({ text: vPast, correct: false });
      }
      if (choices.findIndex(function(c) { return c.text === vPresentThird; }) < 0) {
        choices.push({ text: vPresentThird, correct: false });
      }
      
      // Lo·∫°i b·ªè ƒë√°p √°n tr√πng
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      
      // N·∫øu v·∫´n ch∆∞a ƒë·ªß 3, th√™m t·ª´ ƒë·ªông t·ª´ ph·ªï bi·∫øn kh√°c
      var extraVerbs = ['went', 'goes', 'go', 'ate', 'eats', 'eat', 'took', 'takes', 'take', 'saw', 'sees', 'see'];
      var ej = 0;
      while (choices.length < 3 && ej < extraVerbs.length) {
        var extra = extraVerbs[ej];
        if (choices.findIndex(function(c) { return c.text === extra; }) < 0 && extra !== correctAnswer) {
          choices.push({ text: extra, correct: false });
        }
        ej++;
      }
      
      // Ch·ªâ l·∫•y 3 ƒë√°p √°n (1 ƒë√∫ng + 2 sai)
      var correctChoice = choices.find(function(c) { return c.correct; });
      var wrongChoices = choices.filter(function(c) { return !c.correct; }).slice(0, 2);
      choices = [correctChoice].concat(wrongChoices);
      
      choices = shuffle(choices);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      choices = choices.map(function(c) { return c.text; });
    } else {
      // negative, question: 2 l·ª±a ch·ªçn (kh√¥ng c√≥ icon)
      choices = [correctAnswer, wrongAnswer];
      
      correctIdx = 0;
      if (Math.random() > 0.5) {
        choices = [choices[1], choices[0]];
        correctIdx = 1;
      }
    }
    
    var feedback = '';
    var tip = '';
    if (sentenceType === 'affirm') {
      feedback = 'ƒê√∫ng! ' + signalObj.signal + ' ‚Üí ' + correctAnswer;
      tip = isPastOnly ? 'üåô ' + signalObj.signal + ' ‚Üí qu√° kh·ª©' : '‚òÄÔ∏è ' + signalObj.signal + ' ‚Üí hi·ªán t·∫°i';
    } else if (sentenceType === 'negative') {
      feedback = isPastOnly ? 'ƒê√∫ng! Ph·ªß ƒë·ªãnh qu√° kh·ª© ‚Üí didn\'t' : 'ƒê√∫ng! Ph·ªß ƒë·ªãnh hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPastOnly ? 'üö´üåô didn\'t + ƒë·ªông t·ª´ g·ªëc' : 'üö´‚òÄÔ∏è ' + correctAnswer + ' + ƒë·ªông t·ª´ g·ªëc';
    } else if (sentenceType === 'question') {
      feedback = isPastOnly ? 'ƒê√∫ng! C√¢u h·ªèi qu√° kh·ª© ‚Üí Did' : 'ƒê√∫ng! C√¢u h·ªèi hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPastOnly ? '‚ùìüåô Did + S + V g·ªëc?' : '‚ùì‚òÄÔ∏è ' + correctAnswer + ' + S + V g·ªëc?';
    } else if (sentenceType === 'question_verb') {
      feedback = 'ƒê√∫ng! Sau Do/Does/Did d√πng V g·ªëc: ' + correctAnswer;
      tip = '‚ö†Ô∏è Do/Does/Did + V g·ªëc (kh√¥ng chia)';
    }
    
    // Th√™m th√¥ng tin cho feedback chi ti·∫øt
    var subjectInfo = '';
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(template.subject.toLowerCase()) >= 0;
    if (isThirdPerson) {
      subjectInfo = template.subject + ' (ng√¥i 3) ‚Üí th√™m s/es';
    } else {
      subjectInfo = template.subject + ' ‚Üí gi·ªØ nguy√™n V g·ªëc';
    }
    
    questions.push({
      bg: bg,
      image: template.emoji || '',
      text: displayText,
      question: '',
      choices: choices,
      correct: correctIdx,
      feedback: feedback,
      tip: tip,
      sentenceType: sentenceType,
      subject: template.subject,
      isThirdPerson: isThirdPerson,
      isPast: isPastOnly,
      signal: signalObj.signal,
      correctAnswer: correctAnswer,
      verb: verbForms.base
    });
  }
  
  return shuffle(questions);
}

// Generate questions for Mix Stories from SENTENCE_TEMPLATES
function generateMixStoryQuestions(count) {
  var questions = [];
  var usedTemplates = [];
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  for (var i = 0; i < count; i++) {
    var templateIndex;
    do {
      templateIndex = Math.floor(Math.random() * SENTENCE_TEMPLATES.length);
    } while (usedTemplates.indexOf(templateIndex) >= 0 && usedTemplates.length < SENTENCE_TEMPLATES.length);
    usedTemplates.push(templateIndex);
    
    var template = SENTENCE_TEMPLATES[templateIndex];
    var verbForms = getVerbForms(template.verb);
    var sentenceType = template.type || 'affirm';
    
    var isPast = Math.random() > 0.5;
    var signalList = isPast ? SIGNAL_WORDS.past : SIGNAL_WORDS.present;
    var signalObj = signalList[Math.floor(Math.random() * signalList.length)];
    
    var correctAnswer, wrongAnswer;
    var subject = template.subject.toLowerCase();
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(subject) >= 0;
    
    var bg = isPast ? 'bg-night' : 'bg-sunny';
    
    if (sentenceType === 'affirm') {
      correctAnswer = isPast ? verbForms.past : getPresentForm(verbForms.base, template.subject);
      wrongAnswer = isPast ? getPresentForm(verbForms.base, template.subject) : verbForms.past;
    } else if (sentenceType === 'negative') {
      if (isPast) {
        correctAnswer = "didn't";
        wrongAnswer = isThirdPerson ? "doesn't" : "don't";
      } else {
        correctAnswer = isThirdPerson ? "doesn't" : "don't";
        wrongAnswer = "didn't";
      }
    } else if (sentenceType === 'question') {
      if (isPast) {
        correctAnswer = "Did";
        wrongAnswer = isThirdPerson ? "Does" : "Do";
      } else {
        correctAnswer = isThirdPerson ? "Does" : "Do";
        wrongAnswer = "Did";
      }
    } else if (sentenceType === 'question_verb') {
      // ƒê√£ c√≥ Do/Does/Did, c·∫ßn ƒëi·ªÅn ƒë·ªông t·ª´ g·ªëc
      correctAnswer = verbForms.base;
      wrongAnswer = isPast ? verbForms.past : getPresentForm(verbForms.base, 'She');
    }
    
    var sentence = template.template.replace('{signal}', signalObj.signal);
    
    // Hi·ªÉn th·ªã c√¢u v·ªõi ch·ªó tr·ªëng v√† g·∫°ch ch√¢n d·∫•u hi·ªáu (KH√îNG hi·ªán ƒë√°p √°n)
    var underlinedSignal = '<span style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:600">' + signalObj.signal + '</span>';
    var displayText = template.template
      .replace('{signal}', underlinedSignal)
      .replace('___', '<span style="color:#667eea;font-weight:700;border-bottom:2px solid #667eea;padding:0 8px">____</span>');
    
    var questionText = sentence;
    var choices, correctIdx;
    
    // X·ª≠ l√Ω ƒë·∫∑c bi·ªát cho question_verb: 3 l·ª±a ch·ªçn
    if (sentenceType === 'question_verb') {
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, 'She'); // V-s/es
      
      choices = [
        { text: vBase, correct: true },
        { text: vPast, correct: false },
        { text: vPresent, correct: false }
      ];
      // Lo·∫°i b·ªè tr√πng v√† th√™m ƒë√°p √°n n·∫øu c·∫ßn
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      var extraVerbs = ['went', 'goes', 'go', 'ate', 'eats', 'eat'];
      var ei = 0;
      while (choices.length < 3 && ei < extraVerbs.length) {
        if (choices.findIndex(function(c) { return c.text === extraVerbs[ei]; }) < 0) {
          choices.push({ text: extraVerbs[ei], correct: false });
        }
        ei++;
      }
      choices = shuffle(choices).slice(0, 3);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      if (correctIdx < 0) { choices[0].correct = true; correctIdx = 0; }
      choices = choices.map(function(c) { return c.text; });
    } else if (sentenceType === 'affirm') {
      // C√¢u kh·∫≥ng ƒë·ªãnh: 3 l·ª±a ch·ªçn
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, template.subject);
      var vPresentThird = getPresentForm(verbForms.base, 'She');
      
      choices = [
        { text: correctAnswer, correct: true },
        { text: wrongAnswer, correct: false },
        { text: vBase, correct: false }
      ];
      
      // Th√™m c√°c d·∫°ng kh√°c
      if (choices.findIndex(function(c) { return c.text === vPast; }) < 0) {
        choices.push({ text: vPast, correct: false });
      }
      if (choices.findIndex(function(c) { return c.text === vPresentThird; }) < 0) {
        choices.push({ text: vPresentThird, correct: false });
      }
      
      // Lo·∫°i b·ªè ƒë√°p √°n tr√πng
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      
      // Th√™m t·ª´ ƒë·ªông t·ª´ kh√°c n·∫øu c·∫ßn
      var extraVerbs = ['went', 'goes', 'go', 'ate', 'eats', 'eat', 'took', 'takes', 'take'];
      var ej = 0;
      while (choices.length < 3 && ej < extraVerbs.length) {
        if (choices.findIndex(function(c) { return c.text === extraVerbs[ej]; }) < 0 && extraVerbs[ej] !== correctAnswer) {
          choices.push({ text: extraVerbs[ej], correct: false });
        }
        ej++;
      }
      
      // Ch·ªâ l·∫•y 3 ƒë√°p √°n
      var correctChoice = choices.find(function(c) { return c.correct; });
      var wrongChoices = choices.filter(function(c) { return !c.correct; }).slice(0, 2);
      choices = [correctChoice].concat(wrongChoices);
      
      choices = shuffle(choices);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      choices = choices.map(function(c) { return c.text; });
    } else {
      // negative, question: 2 l·ª±a ch·ªçn (kh√¥ng c√≥ icon)
      choices = [correctAnswer, wrongAnswer];
      
      correctIdx = 0;
      if (Math.random() > 0.5) {
        choices = [choices[1], choices[0]];
        correctIdx = 1;
      }
    }
    
    var feedback = '';
    var tip = '';
    if (sentenceType === 'affirm') {
      feedback = 'ƒê√∫ng! ' + signalObj.signal + ' ‚Üí ' + correctAnswer;
      tip = isPast ? 'üåô ' + signalObj.signal + ' ‚Üí qu√° kh·ª©' : '‚òÄÔ∏è ' + signalObj.signal + ' ‚Üí hi·ªán t·∫°i';
    } else if (sentenceType === 'negative') {
      feedback = isPast ? 'ƒê√∫ng! Ph·ªß ƒë·ªãnh qu√° kh·ª© ‚Üí didn\'t' : 'ƒê√∫ng! Ph·ªß ƒë·ªãnh hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPast ? 'üö´üåô didn\'t + ƒë·ªông t·ª´ g·ªëc' : 'üö´‚òÄÔ∏è ' + correctAnswer + ' + ƒë·ªông t·ª´ g·ªëc';
    } else if (sentenceType === 'question') {
      feedback = isPast ? 'ƒê√∫ng! C√¢u h·ªèi qu√° kh·ª© ‚Üí Did' : 'ƒê√∫ng! C√¢u h·ªèi hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPast ? '‚ùìüåô Did + S + V g·ªëc?' : '‚ùì‚òÄÔ∏è ' + correctAnswer + ' + S + V g·ªëc?';
    } else if (sentenceType === 'question_verb') {
      feedback = 'ƒê√∫ng! Sau Do/Does/Did ‚Üí ƒë·ªông t·ª´ G·ªêC';
      tip = '‚ö†Ô∏è Do/Does/Did + V g·ªëc';
    }
    
    // Th√™m th√¥ng tin chi ti·∫øt
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(template.subject.toLowerCase()) >= 0;
    
    questions.push({
      bg: bg,
      image: template.emoji || '',
      text: displayText,
      question: '',
      choices: choices,
      correct: correctIdx,
      feedback: feedback,
      tip: tip,
      sentenceVn: template.vn,
      sentenceType: sentenceType,
      subject: template.subject,
      isThirdPerson: isThirdPerson,
      isPast: isPast,
      signal: signalObj.signal,
      correctAnswer: correctAnswer,
      verb: verbForms.base
    });
  }
  
  return shuffle(questions);
}

function showQuestion() {
  if (currentQuestionIndex >= totalQuestions) {
    showResult();
    return;
  }
  
  var q = allQuestions[currentQuestionIndex];
  if (!q) {
    showResult();
    return;
  }
  
  document.getElementById('appContainer').className = 'app-container ' + q.bg;
  
  var dotsHtml = '';
  for (var i = 0; i < totalQuestions; i++) {
    var dotClass = 'dot';
    if (i < currentQuestionIndex) dotClass += ' done';
    else if (i === currentQuestionIndex) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚≠ê ' + stars + '</div>' +
    '</div>' +
    '<div class="story-scene">';
  
  // Ch·ªâ hi·ªán image n·∫øu c√≥
  if (q.image && q.image.length > 0) {
    html += '<div class="scene-image">' + q.image + '</div>';
  }
  
  html += '<div class="scene-text">' + q.text + '</div>';
  
  // Ch·ªâ hi·ªán question n·∫øu c√≥ n·ªôi dung
  if (q.question && q.question.length > 0) {
    html += '<div class="scene-question">' + q.question + '</div>';
  }
  
  html += '<div class="choice-buttons">';
  
  q.choices.forEach(function(choice, i) {
    html += '<button class="choice-btn" id="choice' + i + '" onclick="checkQuestionAnswer(' + i + ')">' + choice + '</button>';
  });
  
  html += '</div><div id="feedbackArea"></div></div>';
  
  document.getElementById('storyScreen').innerHTML = html;
  showScreen('storyScreen');
}

function checkQuestionAnswer(index) {
  var q = allQuestions[currentQuestionIndex];
  var correct = index === q.correct;
  
  // Disable all buttons
  document.querySelectorAll('.choice-btn').forEach(function(btn, i) {
    btn.disabled = true;
    if (i === q.correct) btn.classList.add('correct');
    if (i === index && !correct) btn.classList.add('wrong');
  });
  
  if (correct) {
    addStars(1);
    correctAnswers++;
    playSound('correct');
    showConfetti();
  } else {
    playSound('wrong');
  }
  
  // L·∫•y ƒë√°p √°n ƒë√∫ng (b·ªè emoji)
  var correctAnswerText = q.choices[q.correct].replace(/ ?[üåô‚òÄÔ∏è]/g, '').trim();
  
  var feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="feedback-text">' + (correct ? '‚úÖ Ch√≠nh x√°c!' : '‚ùå Ch∆∞a ƒë√∫ng!') + '</div>';
  
  // T·∫°o gi·∫£i th√≠ch chi ti·∫øt
  var explanation = '';
  
  if (q.sentenceType === 'affirm') {
    if (q.isPast) {
      explanation = 'üåô <strong>' + q.signal + '</strong> ‚Üí th√¨ QU√Å KH·ª®<br>' +
        'üëâ ' + q.subject + ' + <strong>V2</strong> (' + q.verb + ' ‚Üí ' + correctAnswerText + ')';
    } else {
      if (q.isThirdPerson) {
        explanation = '‚òÄÔ∏è <strong>' + q.signal + '</strong> ‚Üí th√¨ HI·ªÜN T·∫†I<br>' +
          'üëâ ' + q.subject + ' (ng√¥i 3) + <strong>V-s/es</strong> (' + q.verb + ' ‚Üí ' + correctAnswerText + ')';
      } else {
        explanation = '‚òÄÔ∏è <strong>' + q.signal + '</strong> ‚Üí th√¨ HI·ªÜN T·∫†I<br>' +
          'üëâ ' + q.subject + ' + <strong>V g·ªëc</strong> (' + q.verb + ' ‚Üí ' + correctAnswerText + ')';
      }
    }
  } else if (q.sentenceType === 'negative') {
    if (q.isPast) {
      explanation = 'üö´üåô Ph·ªß ƒë·ªãnh QU√Å KH·ª®<br>' +
        'üëâ ' + q.subject + ' + <strong>didn\'t</strong> + V g·ªëc';
    } else {
      var helper = q.isThirdPerson ? "doesn't" : "don't";
      explanation = 'üö´‚òÄÔ∏è Ph·ªß ƒë·ªãnh HI·ªÜN T·∫†I<br>' +
        'üëâ ' + q.subject + (q.isThirdPerson ? ' (ng√¥i 3)' : '') + ' + <strong>' + helper + '</strong> + V g·ªëc';
    }
  } else if (q.sentenceType === 'question') {
    if (q.isPast) {
      explanation = '‚ùìüåô C√¢u h·ªèi QU√Å KH·ª®<br>' +
        'üëâ <strong>Did</strong> + ' + q.subject + ' + V g·ªëc?';
    } else {
      var helper = q.isThirdPerson ? "Does" : "Do";
      explanation = '‚ùì‚òÄÔ∏è C√¢u h·ªèi HI·ªÜN T·∫†I<br>' +
        'üëâ <strong>' + helper + '</strong> + ' + q.subject + ' + V g·ªëc?';
    }
  } else if (q.sentenceType === 'question_verb') {
    explanation = '‚ö†Ô∏è Sau <strong>Do/Does/Did</strong> lu√¥n d√πng <strong>V g·ªëc</strong><br>' +
      'üëâ ' + q.verb + ' (kh√¥ng chia th√†nh ' + q.verb + 's hay V2)';
  } else {
    explanation = q.tip;
  }
  
  feedbackHtml += '<div class="feedback-tip" style="text-align:left;line-height:1.6">' + explanation + '</div>';
  
  if (!correct) {
    feedbackHtml += '<div style="margin-top:10px;padding:12px;background:#E8F5E9;border-radius:10px;color:#2E7D32;font-weight:600">' +
      '‚úÖ ƒê√°p √°n ƒë√∫ng: <strong>' + correctAnswerText + '</strong></div>';
  }
  
  feedbackHtml += '<button class="next-btn" onclick="nextQuestion()">' +
    (currentQuestionIndex < totalQuestions - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  document.getElementById('feedbackArea').innerHTML = feedbackHtml;
}

function nextQuestion() {
  currentQuestionIndex++;
  showQuestion();
}

// ============ SOUND ============
function playSound(type) {
  if (!soundEnabled) return;
  try {
    var ctx = new (window.AudioContext || window.webkitAudioContext)();
    var osc = ctx.createOscillator();
    var gain = ctx.createGain();
    osc.connect(gain);
    gain.connect(ctx.destination);
    
    if (type === 'correct') {
      osc.frequency.setValueAtTime(523, ctx.currentTime);
      osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1);
      osc.frequency.setValueAtTime(784, ctx.currentTime + 0.2);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.4);
    } else if (type === 'wrong') {
      osc.frequency.setValueAtTime(330, ctx.currentTime);
      osc.frequency.setValueAtTime(294, ctx.currentTime + 0.15);
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.3);
    } else if (type === 'click') {
      osc.frequency.setValueAtTime(800, ctx.currentTime);
      gain.gain.setValueAtTime(0.1, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.05);
    } else if (type === 'complete') {
      [523, 659, 784, 1047].forEach(function(freq, i) {
        var o = ctx.createOscillator();
        var g = ctx.createGain();
        o.connect(g); g.connect(ctx.destination);
        o.frequency.setValueAtTime(freq, ctx.currentTime + i * 0.15);
        g.gain.setValueAtTime(0.2, ctx.currentTime + i * 0.15);
        g.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + i * 0.15 + 0.2);
        o.start(ctx.currentTime + i * 0.15);
        o.stop(ctx.currentTime + i * 0.15 + 0.2);
      });
    } else if (type === 'flip') {
      osc.frequency.setValueAtTime(600, ctx.currentTime);
      osc.frequency.setValueAtTime(900, ctx.currentTime + 0.05);
      gain.gain.setValueAtTime(0.15, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.1);
    }
  } catch(e) {}
}

function toggleSound() {
  soundEnabled = !soundEnabled;
  document.getElementById('soundToggle').textContent = soundEnabled ? 'üîä' : 'üîá';
}

// ============ CONFETTI ============
function showConfetti() {
  var container = document.getElementById('confettiContainer');
  container.innerHTML = '';
  var colors = ['#FFD700','#FF6B6B','#4CAF50','#2196F3','#E91E63'];
  for (var i = 0; i < 30; i++) {
    var c = document.createElement('div');
    c.className = 'confetti';
    c.style.left = Math.random() * 100 + '%';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
    c.style.animationDelay = Math.random() * 0.5 + 's';
    container.appendChild(c);
  }
  setTimeout(function() { container.innerHTML = ''; }, 3000);
}

// ============ NAVIGATION ============
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(function(s) {
    s.classList.remove('active');
  });
  document.getElementById(id).classList.add('active');
}

function goHome() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  updateStarDisplay();
  showMotivationalMessage();
  showScreen('homeScreen');
}

// C·∫≠p nh·∫≠t hi·ªÉn th·ªã sao
function updateStarDisplay() {
  var totalEl = document.getElementById('totalStarsDisplay');
  var todayEl = document.getElementById('todayStarsDisplay');
  if (totalEl) totalEl.textContent = totalStars;
  if (todayEl) todayEl.textContent = todayStars;
  
  // C·∫≠p nh·∫≠t streak banner
  var streakText = document.getElementById('streakText');
  if (streakText) {
    if (todayStars === 0) {
      streakText.textContent = 'B·∫Øt ƒë·∫ßu h·ªçc n√†o!';
    } else if (todayStars < 10) {
      streakText.textContent = 'Con ƒëang c·ªë g·∫Øng! Ti·∫øp t·ª•c nh√©! üí™';
    } else if (todayStars < 30) {
      streakText.textContent = 'ChƒÉm ch·ªâ qu√°! ' + todayStars + ' sao h√¥m nay! ‚≠ê';
    } else if (todayStars < 50) {
      streakText.textContent = 'N·ªó l·ª±c tuy·ªát v·ªùi! ' + todayStars + ' sao! üåü';
    } else {
      streakText.textContent = 'Si√™u sao! ' + todayStars + ' sao! üèÜüëë';
    }
  }
}

// Kh·ªüi t·∫°o khi load trang
var MOTIVATIONAL_MESSAGES = [
  "üå± Ki√™n tr√¨ m·ªói ng√†y ‚Äî con ƒëang ti·∫øn b·ªô t·ª´ng b∆∞·ªõc r·ªìi ƒë·∫•y!",
  "üí™ Sai kh√¥ng sao, quan tr·ªçng l√† con kh√¥ng b·ªè cu·ªôc!",
  "üöÄ H√¥m nay con h·ªçc th√™m m·ªôt ch√∫t, mai con s·∫Ω bay xa h∆°n!",
  "üß© M·ªói c√¢u con l√†m ƒë√∫ng l√† m·ªôt m·∫£nh gh√©p ho√†n th√†nh!",
  "‚è∞ 10 ph√∫t m·ªói ng√†y, m·ªôt nƒÉm sau con s·∫Ω b·∫•t ng·ªù v·ªõi ch√≠nh m√¨nh!",
  "üê¢ Ch·∫≠m m√† ch·∫Øc ‚Äî con r√πa lu√¥n v·ªÅ ƒë√≠ch!",
  "üåà Kh√≥ h√¥m nay, d·ªÖ ng√†y mai ‚Äî c·ª© ti·∫øp t·ª•c th√¥i!",
  "üî• M·ªói l·∫ßn luy·ªán t·∫≠p, n√£o con l·∫°i m·∫°nh th√™m m·ªôt ch√∫t!",
  "üéØ M·ªói ng√†y luy·ªán t·∫≠p l√† m·ªói ng√†y ti·∫øn b·ªô!",
  "üåü Con ƒë√£ d√°m b·∫Øt ƒë·∫ßu ‚Äî ƒë√≥ l√† ƒëi·ªÅu tuy·ªát v·ªùi nh·∫•t r·ªìi!",
  "üèÉ ƒê·ª´ng so v·ªõi ai, h√£y so v·ªõi con c·ªßa ng√†y h√¥m qua!",
  "üé∏ H·ªçc ti·∫øng Anh gi·ªëng nh∆∞ t·∫≠p ƒë√†n ‚Äî c√†ng ch∆°i c√†ng hay!",
  "üß† N√£o con ƒëang ghi nh·ªõ d√π con kh√¥ng bi·∫øt ƒë·∫•y ‚Äî c·ª© ti·∫øp t·ª•c nh√©!",
  "üåª H·∫°t gi·ªëng h√¥m nay, c√¢y l·ªõn ng√†y mai ‚Äî con ƒëang gieo tr·ªìng r·ªìi!",
  "üíé Ki·∫øn th·ª©c l√† kho b√°u kh√¥ng ai l·∫•y ƒë∆∞·ª£c c·ªßa con!",
  "üêù ChƒÉm ch·ªâ nh∆∞ ong ‚Äî t·ª´ng ch√∫t m·∫≠t ng·ªçt s·∫Ω th√†nh!",
  "üìà Nh√¨n l·∫°i tu·∫ßn tr∆∞·ªõc xem ‚Äî con ƒë√£ bi·∫øt th√™m bao nhi√™u t·ª´ r·ªìi!",
  "üéÆ H·ªçc m√† vui, vui m√† h·ªçc ‚Äî c·ª© th·∫ø th√¥i n√†o!",
  "ü¶ã H√¥m nay con l√† s√¢u chƒÉm ch·ªâ, mai con s·∫Ω l√† b∆∞·ªõm xinh!",
  "‚ú® M·ªói ng√†y h·ªçc l√† m·ªôt ng√†y con tr·ªü n√™n ƒë·∫∑c bi·ªát h∆°n!"
];

function showMotivationalMessage() {
  var el = document.getElementById('motivationalMsg');
  if (el) {
    el.textContent = MOTIVATIONAL_MESSAGES[Math.floor(Math.random() * MOTIVATIONAL_MESSAGES.length)];
  }
}

window.addEventListener('load', function() {
  loadStarData();
  updateStarDisplay();
  showMotivationalMessage();
});

// ============ SHUFFLE ============
function shuffle(arr) {
  var a = arr.slice();
  for (var i = a.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    var t = a[i]; a[i] = a[j]; a[j] = t;
  }
  return a;
}

// ============ LEARN SCREEN ============
function showLearnScreen() {
  playSound('click');
  document.getElementById('appContainer').className = 'app-container bg-sunny';
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.2rem">üìö H·ªçc ki·∫øn th·ª©c</div>' +
    '<div></div></div>' +
    
    // === D·∫§U HI·ªÜU NH·∫¨N BI·∫æT ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">üîç</span> D·∫•u hi·ªáu nh·∫≠n bi·∫øt</div>' +
    '<div class="compare-box">' +
    '<div class="compare-side now">' +
    '<div class="label">‚òÄÔ∏è HI·ªÜN T·∫†I</div>' +
    '<div class="time-words">' +
    '<span class="time-word">every day</span>' +
    '<span class="time-word">every morning</span>' +
    '<span class="time-word">every night</span>' +
    '<span class="time-word">every week</span>' +
    '<span class="time-word">always</span>' +
    '<span class="time-word">usually</span>' +
    '<span class="time-word">often</span>' +
    '<span class="time-word">sometimes</span>' +
    '</div>' +
    '</div>' +
    '<div class="compare-side past">' +
    '<div class="label">üåô QU√Å KH·ª®</div>' +
    '<div class="time-words">' +
    '<span class="time-word">yesterday</span>' +
    '<span class="time-word">last night</span>' +
    '<span class="time-word">last week</span>' +
    '<span class="time-word">last month</span>' +
    '<span class="time-word">last year</span>' +
    '<span class="time-word">...ago</span>' +
    '<span class="time-word">in 2023</span>' +
    '</div>' +
    '</div></div>' +
    '<div class="tip-bubble"><span class="bulb">üí°</span>' +
    '<span class="tip-text"><strong>M·∫πo nh·ªõ:</strong><br>' +
    'üëâ Th·∫•y <strong>"every"</strong> ‚Üí Hi·ªán t·∫°i<br>' +
    'üëâ Th·∫•y <strong>"yesterday/last/ago"</strong> ‚Üí Qu√° kh·ª©</span></div>' +
    '</div>' +
    
    // === C√ÇU KH·∫≤NG ƒê·ªäNH ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">‚úÖ</span> C√¢u kh·∫≥ng ƒë·ªãnh</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">‚òÄÔ∏è Hi·ªán t·∫°i:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <strong>goes</strong> to school every day.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <strong>plays</strong> football every weekend.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <strong>eat</strong> breakfast every morning.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px;font-size:0.9rem">' +
    '‚ö†Ô∏è <strong>He/She/It</strong> ‚Üí th√™m <strong>s/es</strong> (goes, plays, watches)' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">üåô Qu√° kh·ª©:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <span class="past">went</span> to school yesterday.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <span class="past">played</span> football last week.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <span class="past">ate</span> pizza last night.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px;font-size:0.9rem">' +
    '‚ö†Ô∏è ƒê·ªông t·ª´ ƒë·ªïi sang d·∫°ng qu√° kh·ª© (went, played, ate...)' +
    '</div></div>' +
    '</div>' +
    
    // === C√ÇU PH·ª¶ ƒê·ªäNH ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">üö´</span> C√¢u ph·ªß ƒë·ªãnh (Kh√¥ng l√†m g√¨)</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">‚òÄÔ∏è Hi·ªán t·∫°i:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <strong>doesn\'t go</strong> to school on Sunday.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <strong>doesn\'t like</strong> vegetables.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <strong>don\'t eat</strong> meat.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem;margin-bottom:5px">üìå <strong>I/You/We/They</strong> ‚Üí <span style="background:#FFCDD2;padding:2px 6px;border-radius:4px">don\'t</span> + ƒë·ªông t·ª´ g·ªëc</div>' +
    '<div style="font-size:0.9rem">üìå <strong>He/She/It</strong> ‚Üí <span style="background:#FFCDD2;padding:2px 6px;border-radius:4px">doesn\'t</span> + ƒë·ªông t·ª´ g·ªëc</div>' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">üåô Qu√° kh·ª©:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <span class="past">didn\'t go</span> to school yesterday.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <span class="past">didn\'t watch</span> TV last night.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <span class="past">didn\'t play</span> games yesterday.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem">üìå <strong>T·∫•t c·∫£</strong> ‚Üí <span style="background:#FFCC80;padding:2px 6px;border-radius:4px">didn\'t</span> + ƒë·ªông t·ª´ <strong>G·ªêC</strong></div>' +
    '</div></div>' +
    '<div class="tip-bubble" style="background:#FFEBEE"><span class="bulb">‚ö†Ô∏è</span>' +
    '<span class="tip-text"><strong>Quan tr·ªçng:</strong> Sau don\'t / doesn\'t / didn\'t ‚Üí ƒë·ªông t·ª´ gi·ªØ nguy√™n d·∫°ng G·ªêC!<br>' +
    '‚ùå She doesn\'t <s>goes</s> ‚Üí ‚úÖ She doesn\'t <strong>go</strong><br>' +
    '‚ùå He didn\'t <s>went</s> ‚Üí ‚úÖ He didn\'t <strong>go</strong></span></div>' +
    '</div>' +
    
    // === C√ÇU H·ªéI ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">‚ùì</span> C√¢u h·ªèi (C√≥ l√†m kh√¥ng?)</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">‚òÄÔ∏è Hi·ªán t·∫°i:</div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><strong>Do you</strong> like pizza? - Yes, I do!</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><strong>Does she</strong> go to school? - Yes, she does!</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><strong>Do they</strong> play games? - No, they don\'t.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem;margin-bottom:5px">üìå <span style="background:#BBDEFB;padding:2px 6px;border-radius:4px">Do</span> + I/you/we/they + ƒë·ªông t·ª´ g·ªëc?</div>' +
    '<div style="font-size:0.9rem">üìå <span style="background:#BBDEFB;padding:2px 6px;border-radius:4px">Does</span> + he/she/it + ƒë·ªông t·ª´ g·ªëc?</div>' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">üåô Qu√° kh·ª©:</div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><span class="past">Did you</span> go to school yesterday? - Yes, I did!</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><span class="past">Did she</span> eat pizza? - No, she didn\'t.</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><span class="past">Did they</span> watch TV? - Yes, they did!</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem">üìå <span style="background:#FFCC80;padding:2px 6px;border-radius:4px">Did</span> + t·∫•t c·∫£ + ƒë·ªông t·ª´ <strong>G·ªêC</strong>?</div>' +
    '</div></div>' +
    '<div class="tip-bubble" style="background:#E3F2FD"><span class="bulb">‚ö†Ô∏è</span>' +
    '<span class="tip-text"><strong>Quan tr·ªçng:</strong> Sau Do / Does / Did ‚Üí ƒë·ªông t·ª´ gi·ªØ nguy√™n d·∫°ng G·ªêC!<br>' +
    '‚ùå Does she <s>goes</s>? ‚Üí ‚úÖ Does she <strong>go</strong>?<br>' +
    '‚ùå Did you <s>went</s>? ‚Üí ‚úÖ Did you <strong>go</strong>?</span></div>' +
    '</div>' +
    
    // === B·∫¢NG T√ìM T·∫ÆT ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">üìã</span> B·∫£ng t√≥m t·∫Øt</div>' +
    '<table style="width:100%;border-collapse:collapse;font-size:0.9rem">' +
    '<tr style="background:#E3F2FD"><th style="padding:10px;border:1px solid #ddd"></th><th style="padding:10px;border:1px solid #ddd">‚òÄÔ∏è Hi·ªán t·∫°i</th><th style="padding:10px;border:1px solid #ddd">üåô Qu√° kh·ª©</th></tr>' +
    '<tr><td style="padding:10px;border:1px solid #ddd;font-weight:700">D·∫•u hi·ªáu</td><td style="padding:10px;border:1px solid #ddd">every day, always</td><td style="padding:10px;border:1px solid #ddd">yesterday, last...</td></tr>' +
    '<tr style="background:#E8F5E9"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚úÖ She</td><td style="padding:10px;border:1px solid #ddd">She <strong>goes</strong></td><td style="padding:10px;border:1px solid #ddd">She <strong>went</strong></td></tr>' +
    '<tr style="background:#FFEBEE"><td style="padding:10px;border:1px solid #ddd;font-weight:700">üö´ She</td><td style="padding:10px;border:1px solid #ddd">She <strong>doesn\'t go</strong></td><td style="padding:10px;border:1px solid #ddd">She <strong>didn\'t go</strong></td></tr>' +
    '<tr style="background:#E3F2FD"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚ùì She</td><td style="padding:10px;border:1px solid #ddd"><strong>Does</strong> she <strong>go</strong>?</td><td style="padding:10px;border:1px solid #ddd"><strong>Did</strong> she <strong>go</strong>?</td></tr>' +
    '<tr style="background:#E8F5E9"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚úÖ They</td><td style="padding:10px;border:1px solid #ddd">They <strong>go</strong></td><td style="padding:10px;border:1px solid #ddd">They <strong>went</strong></td></tr>' +
    '<tr style="background:#FFEBEE"><td style="padding:10px;border:1px solid #ddd;font-weight:700">üö´ They</td><td style="padding:10px;border:1px solid #ddd">They <strong>don\'t go</strong></td><td style="padding:10px;border:1px solid #ddd">They <strong>didn\'t go</strong></td></tr>' +
    '<tr style="background:#E3F2FD"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚ùì They</td><td style="padding:10px;border:1px solid #ddd"><strong>Do</strong> they <strong>go</strong>?</td><td style="padding:10px;border:1px solid #ddd"><strong>Did</strong> they <strong>go</strong>?</td></tr>' +
    '</table>' +
    '</div>' +
    
    // === QUY T·∫ÆC V√ÄNG ===
    '<div class="pattern-card" style="background:linear-gradient(135deg,#FFF9C4,#FFECB3)">' +
    '<div class="pattern-title"><span class="icon">‚≠ê</span> QUY T·∫ÆC V√ÄNG</div>' +
    '<div style="text-align:center;padding:15px">' +
    '<p style="font-size:1.2rem;font-weight:700;color:#F57F17;margin-bottom:15px">' +
    'Sau <span style="background:#FF8A65;color:white;padding:5px 12px;border-radius:8px">don\'t / doesn\'t / didn\'t</span></p>' +
    '<p style="font-size:1.2rem;font-weight:700;color:#F57F17;margin-bottom:15px">' +
    'Sau <span style="background:#64B5F6;color:white;padding:5px 12px;border-radius:8px">Do / Does / Did</span></p>' +
    '<p style="font-size:1.5rem;font-weight:800;color:#E65100">' +
    '‚Üí ƒê·ªông t·ª´ lu√¥n ·ªü <span style="background:#FFEB3B;padding:5px 15px;border-radius:8px">D·∫†NG G·ªêC</span>!</p>' +
    '</div></div>' +
    
    '<button class="next-btn" onclick="goHome()" style="margin-top:20px">üè† V·ªÅ trang ch·ªß</button>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

// ============ TOPIC START ============
function startTopic(topic) {
  playSound('click');
  currentTopic = topic;
  
  if (topic === 'games') {
    showGameMenu();
  } else if (STORIES[topic]) {
    currentStory = Math.floor(Math.random() * STORIES[topic].length);
    currentScene = 0;
    stars = 0;
    correctAnswers = 0;
    totalQuestions = STORIES[topic][currentStory].scenes.length;
    showStory();
  }
}

// ============ STORY ============
function showStory() {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  
  document.getElementById('appContainer').className = 'app-container ' + story.bg;
  
  var dotsHtml = '';
  for (var i = 0; i < story.scenes.length; i++) {
    var dotClass = 'dot';
    if (i < currentScene) dotClass += ' done';
    else if (i === currentScene) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚≠ê ' + stars + '</div>' +
    '</div>' +
    '<div class="story-scene">' +
    '<div class="scene-image">' + scene.image + '</div>' +
    '<div class="scene-text">' + scene.text + '</div>' +
    '<div class="scene-question">' + scene.question + '</div>' +
    '<div class="choice-buttons">';
  
  scene.choices.forEach(function(choice, i) {
    html += '<button class="choice-btn" id="choice' + i + '" onclick="checkAnswer(' + i + ')">' + choice + '</button>';
  });
  
  html += '</div><div id="feedbackArea"></div></div>';
  
  document.getElementById('storyScreen').innerHTML = html;
  showScreen('storyScreen');
}

function checkAnswer(index) {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  var correct = index === scene.correct;
  
  // Disable all buttons
  document.querySelectorAll('.choice-btn').forEach(function(btn, i) {
    btn.disabled = true;
    if (i === scene.correct) btn.classList.add('correct');
    if (i === index && !correct) btn.classList.add('wrong');
  });
  
  if (correct) {
    addStars(1);
    correctAnswers++;
    playSound('correct');
    showConfetti();
  } else {
    playSound('wrong');
  }
  
  var feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="feedback-text">' + scene.feedback + '</div>' +
    '<div class="feedback-tip">' + scene.tip + '</div>' +
    '<button class="next-btn" onclick="nextScene()">' +
    (currentScene < story.scenes.length - 1 ? 'Next ‚Üí' : 'Finish! üèÜ') +
    '</button></div>';
  
  document.getElementById('feedbackArea').innerHTML = feedbackHtml;
}

function nextScene() {
  var story = STORIES[currentTopic][currentStory];
  
  if (currentScene < story.scenes.length - 1) {
    currentScene++;
    showStory();
  } else {
    showResult();
  }
}

// ============ RESULT ============
function showResult() {
  playSound('complete');
  showConfetti();
  
  var percentage = Math.round((correctAnswers / totalQuestions) * 100);
  
  // Save best score per topic
  var bestKey = 'bestScore_' + currentTopic;
  var oldBest = parseInt(localStorage.getItem(bestKey) || '0');
  if (percentage > oldBest) localStorage.setItem(bestKey, percentage);
  
  var starCount = Math.min(3, Math.floor(percentage / 33) + (percentage > 0 ? 1 : 0));
  var starsHtml = '';
  for (var i = 0; i < 3; i++) {
    starsHtml += i < starCount ? '‚≠ê' : '‚òÜ';
  }
  
  // Bonus sao khi ho√†n th√†nh
  var bonusStars = 0;
  if (percentage >= 80) bonusStars = 5;
  else if (percentage >= 60) bonusStars = 3;
  else if (percentage >= 40) bonusStars = 2;
  else bonusStars = 1;
  addStars(bonusStars);
  
  var emoji = percentage >= 80 ? 'üèÜ' : percentage >= 50 ? 'üåü' : 'üí™';
  var titles80 = ['Con ƒë√£ luy·ªán t·∫≠p r·∫•t chƒÉm ch·ªâ!','S·ª± ki√™n nh·∫´n c·ªßa con ƒë∆∞·ª£c ƒë·ªÅn ƒë√°p!','Con ƒë√£ n·ªó l·ª±c h·∫øt m√¨nh!'];var titles50 = ['Con ƒëang ti·∫øn b·ªô t·ª´ng b∆∞·ªõc!','M·ªói c√¢u ƒë√∫ng l√† m·ªôt b∆∞·ªõc ti·∫øn!','Con ƒë√£ c·ªë g·∫Øng r·∫•t nhi·ªÅu!'];var titlesLow = ['M·ªói l·∫ßn th·ª≠ l√† m·ªói l·∫ßn h·ªçc!','Sai c≈©ng l√† c√°ch ƒë·ªÉ hi·ªÉu h∆°n!','ƒê·ª´ng b·ªè cu·ªôc, con ƒëang tr√™n ƒë∆∞·ªùng ti·∫øn b·ªô!'];var title = percentage >= 80 ? titles80[Math.floor(Math.random()*3)] : percentage >= 50 ? titles50[Math.floor(Math.random()*3)] : titlesLow[Math.floor(Math.random()*3)];
  var msgs80 = ['S·ª± c·ªë g·∫Øng c·ªßa con th·∫≠t ƒë√°ng khen! üéâ','Con ƒë√£ d√†nh th·ªùi gian luy·ªán t·∫≠p v√† c√≥ k·∫øt qu·∫£! üëè','C·ª© ti·∫øp t·ª•c th·∫ø n√†y nh√©! üåü'];var msgs50 = ['Con ƒë√£ d≈©ng c·∫£m th·ª≠ s·ª©c! üëç','L·∫ßn sau s·∫Ω v·ªØng h∆°n n·ªØa! üí™','M·ªói l·∫ßn luy·ªán, con l·∫°i nh·ªõ th√™m! üìö'];var message = percentage >= 80 ? msgs80[Math.floor(Math.random()*3)] : 
                percentage >= 50 ? msgs50[Math.floor(Math.random()*3)] : 
                'Luy·ªán t·∫≠p th√™m con s·∫Ω ti·∫øn b·ªô h∆°n! üí™';
  
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="result-content"><div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + title + '</div>' +
    '<div class="result-stars">' + starsHtml + '</div>' +
    '<div style="background:linear-gradient(135deg,#FFD700,#FFA000);padding:12px;border-radius:12px;margin:10px 0;color:white;font-weight:700;text-align:center">' +
    'üéÅ Bonus: +' + bonusStars + ' sao! (T·ªïng: ' + totalStars + ' ‚≠ê)' +
    '</div>' +
    '<div style="background:#f5f5f5;padding:15px;border-radius:12px;margin:15px 0">' +
    '<div style="display:flex;justify-content:space-around;text-align:center">' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#4CAF50">' + correctAnswers + '</div><div style="font-size:0.85rem;color:#666">ƒê√∫ng ‚úì</div></div>' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#F44336">' + (totalQuestions - correctAnswers) + '</div><div style="font-size:0.85rem;color:#666">Sai ‚úó</div></div>' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#2196F3">' + percentage + '%</div><div style="font-size:0.85rem;color:#666">T·ª∑ l·ªá</div></div>' +
    '</div></div>' +
    '<div class="result-message">' + message + '</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="showLevelSelect(\'' + currentTopic + '\')">Ch∆°i l·∫°i üîÑ</button>' +
    '<button class="result-btn secondary" onclick="goHome()">V·ªÅ nh√† üè†</button>' +
    '</div></div></div>';
  
  document.getElementById('resultScreen').innerHTML = html;
  showScreen('resultScreen');
}

// ============ GAME MENU ============
function showGameMenu() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.2rem">üéÆ Word Games</div>' +
    '<div></div></div>' +
    
    '<div class="topic-grid">' +
    '<div class="topic-card" onclick="startMatchingGame()" style="border-color:#9C27B0">' +
    '<div class="topic-icon">üéØ</div>' +
    '<div class="topic-name">Matching</div>' +
    '</div>' +
    '<div class="topic-card" onclick="startFlashcards()" style="border-color:#FF9800">' +
    '<div class="topic-icon">üé¥</div>' +
    '<div class="topic-name">Flashcards</div>' +
    '</div>' +
    '<div class="topic-card" onclick="showLearnScreen()" style="border-color:#4CAF50">' +
    '<div class="topic-icon">üìñ</div>' +
    '<div class="topic-name">Horrible List</div>' +
    '</div>' +
    '</div>' +
    
    // Visual learning section
    '<div class="pattern-card" style="margin-top:20px">' +
    '<div class="pattern-title"><span class="icon">üí°</span> Nh·ªõ nhanh!</div>' +
    '<div class="compare-box">' +
    '<div class="compare-side now">' +
    '<div class="label">‚òÄÔ∏è Hi·ªán t·∫°i</div>' +
    '<div class="time-words"><span class="time-word">every day</span><span class="time-word">always</span></div>' +
    '<div class="example">I <strong>go</strong> to school.</div>' +
    '</div>' +
    '<div class="compare-side past">' +
    '<div class="label">üåô Qu√° kh·ª©</div>' +
    '<div class="time-words"><span class="time-word">yesterday</span><span class="time-word">last week</span></div>' +
    '<div class="example">I <strong style="color:#E65100">went</strong> to school.</div>' +
    '</div></div>' +
    '<div class="tip-bubble"><span class="bulb">üí°</span>' +
    '<span class="tip-text">Th·∫•y <strong>every</strong> ‚Üí d√πng t·ª´ hi·ªán t·∫°i<br>' +
    'Th·∫•y <strong>yesterday/last</strong> ‚Üí d√πng t·ª´ qu√° kh·ª©!</span></div>' +
    '</div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

// ============ MATCHING GAME ============
function startMatchingGame() {
  playSound('click');
  
  var words = shuffle(WORD_GAMES.matching).slice(0, 6);
  matchCards = [];
  selectedCard = null;
  matchedPairs = [];
  
  words.forEach(function(w, i) {
    matchCards.push({ id: 'now-' + i, text: w.now, type: 'now', pairId: i });
    matchCards.push({ id: 'past-' + i, text: w.past, type: 'past', pairId: i });
  });
  matchCards = shuffle(matchCards);
  
  renderMatchingGame();
}

function renderMatchingGame() {
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üéØ Match the pairs!</div>' +
    '<div></div></div>' +
    
    '<div class="match-instruction">üü¢ Ch·ªçn t·ª´ hi·ªán t·∫°i ‚Üí üü† Ch·ªçn t·ª´ qu√° kh·ª© c·ªßa n√≥!</div>' +
    
    '<div class="match-grid">';
  
  matchCards.forEach(function(card) {
    var isSelected = selectedCard && selectedCard.id === card.id;
    var isMatched = matchedPairs.indexOf(card.pairId) >= 0;
    html += '<button class="match-card type-' + card.type + 
      (isSelected ? ' selected' : '') + 
      (isMatched ? ' matched' : '') + '" ' +
      (isMatched ? 'disabled' : 'onclick="selectMatchCard(\'' + card.id + '\')"') + '>' +
      card.text + '</button>';
  });
  
  html += '</div>' +
    '<div class="match-score">‚úÖ ' + matchedPairs.length + ' / 6</div>';
  
  if (matchedPairs.length >= 6) {
    html += '<div style="text-align:center;margin-top:20px">' +
      '<div style="font-size:50px;margin-bottom:10px">üéâ</div>' +
      '<div style="color:white;font-size:1.3rem;font-weight:700;margin-bottom:15px">Con ƒë√£ ho√†n th√†nh r·ªìi!</div>' +
      '<button class="next-btn" onclick="startMatchingGame()">Play Again üîÑ</button></div>';
  }
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function selectMatchCard(cardId) {
  playSound('click');
  
  var card = matchCards.find(function(c) { return c.id === cardId; });
  
  if (!selectedCard) {
    selectedCard = card;
    renderMatchingGame();
  } else {
    if (selectedCard.id === card.id) {
      selectedCard = null;
      renderMatchingGame();
      return;
    }
    
    if (selectedCard.pairId === card.pairId && selectedCard.type !== card.type) {
      matchedPairs.push(card.pairId);
      playSound('correct');
      if (matchedPairs.length >= 6) {
        playSound('complete');
        showConfetti();
      }
    } else {
      playSound('wrong');
    }
    selectedCard = null;
    renderMatchingGame();
  }
}

// ============ FLASHCARDS ============
function startFlashcards() {
  playSound('click');
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}

function renderFlashcards() {
  var words = WORD_GAMES.matching;
  var word = words[flashcardIndex];
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üé¥ ' + (flashcardIndex + 1) + ' / ' + words.length + '</div>' +
    '<div></div></div>' +
    
    '<div style="color:white;text-align:center;margin-bottom:8px;font-size:1.1rem">' +
    'üëÜ Ch·∫°m th·∫ª ƒë·ªÉ l·∫≠t!</div>' +
    
    '<div style="background:rgba(255,255,255,0.2);padding:10px 15px;border-radius:12px;margin-bottom:15px;text-align:center">' +
    '<span style="font-size:1.1rem">üîä <strong style="color:#FFEB3B">ƒê·ªçc TO</strong> ƒë·ªÉ nh·ªõ l√¢u nh√© con!</span>' +
    '</div>' +
    
    '<div class="flashcard-container">' +
    '<div class="flashcard' + (isFlipped ? ' flipped' : '') + '" onclick="flipCard()">' +
    '<div class="flashcard-face flashcard-front">' +
    '<div class="flashcard-label">‚òÄÔ∏è Hi·ªán t·∫°i</div>' +
    '<div class="flashcard-word">' + word.now + '</div>' +
    '<div class="flashcard-meaning">(' + word.meaning + ')</div>' +
    '<div class="flashcard-hint" style="margin-top:10px;padding:8px 12px;background:#E8F5E9;border-radius:8px;color:#2E7D32">' +
    'üó£Ô∏è ƒê·ªçc to: "<strong>' + word.now + '</strong>"</div>' +
    '</div>' +
    '<div class="flashcard-face flashcard-back">' +
    '<div class="flashcard-label">üåô Qu√° kh·ª©</div>' +
    '<div class="flashcard-word">' + word.past + '</div>' +
    '<div class="flashcard-meaning">' + word.now + ' ‚Üí ' + word.past + '</div>' +
    '<div class="flashcard-hint" style="margin-top:10px;padding:8px 12px;background:#FFF3E0;border-radius:8px;color:#E65100">' +
    'üó£Ô∏è ƒê·ªçc to: "<strong>' + word.now + '</strong> ‚Üí <strong>' + word.past + '</strong>"</div>' +
    '</div></div></div>' +
    
    '<div class="flashcard-nav">' +
    '<button class="flashcard-btn" onclick="prevFlashcard()">‚Üê Tr∆∞·ªõc</button>' +
    '<button class="flashcard-btn" onclick="shuffleFlashcards()">üîÄ Tr·ªôn</button>' +
    '<button class="flashcard-btn" onclick="nextFlashcard()">Sau ‚Üí</button>' +
    '</div>' +
    
    '<div class="pattern-card" style="margin-top:20px">' +
    '<div style="text-align:center;margin-bottom:10px;color:#666;font-size:0.9rem">üó£Ô∏è ƒê·ªçc to c√¢u n√†y nha:</div>' +
    '<div class="example-row">' +
    '<span class="emoji">‚òÄÔ∏è</span>' +
    '<span class="sentence">I <strong>' + word.now + '</strong> every day.</span>' +
    '</div>' +
    '<div class="example-row">' +
    '<span class="emoji">üåô</span>' +
    '<span class="sentence">I <span class="past">' + word.past + '</span> yesterday.</span>' +
    '</div></div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function flipCard() {
  playSound('flip');
  isFlipped = !isFlipped;
  renderFlashcards();
}

function prevFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex > 0 ? flashcardIndex - 1 : WORD_GAMES.matching.length - 1;
  renderFlashcards();
}

function nextFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex < WORD_GAMES.matching.length - 1 ? flashcardIndex + 1 : 0;
  renderFlashcards();
}

function shuffleFlashcards() {
  WORD_GAMES.matching = shuffle(WORD_GAMES.matching);
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}

// ============ IRREGULAR VERBS DATA (t·ª´ h√¨nh ·∫£nh) ============
var IRREGULAR_VERBS = {
  groups: [
    {
      id: 'important',
      name: '1. ƒê·ªông t·ª´ quan tr·ªçng',
      pattern: 'IMPORTANT VERBS',
      color: 'pattern-important',
      tip: 'üåü ƒê√¢y l√† nh·ªØng ƒë·ªông t·ª´ d√πng NHI·ªÄU NH·∫§T! H·ªçc thu·ªôc nh√≥m n√†y tr∆∞·ªõc nh√©!',
      verbs: [
        { base: 'be', past: 'was/were', pp: 'been', vn: 'th√¨, l√†, ·ªü' },
        { base: 'do', past: 'did', pp: 'done', vn: 'l√†m' },
        { base: 'have', past: 'had', pp: 'had', vn: 'c√≥' },
        { base: 'come', past: 'came', pp: 'come', vn: 'ƒë·∫øn' },
        { base: 'get', past: 'got', pp: 'got', vn: 'ƒë∆∞·ª£c, l·∫•y' },
        { base: 'go', past: 'went', pp: 'gone', vn: 'ƒëi' },
        { base: 'make', past: 'made', pp: 'made', vn: 'l√†m, ch·∫ø t·∫°o' },
        { base: 'say', past: 'said', pp: 'said', vn: 'n√≥i' },
        { base: 'tell', past: 'told', pp: 'told', vn: 'k·ªÉ, b·∫£o' }
      ]
    },
    {
      id: 'perception',
      name: '2. Gi√°c quan',
      pattern: 'PERCEPTION VERBS',
      color: 'pattern-perception',
      tip: 'üëÄüëÇüëÉ Nh√≥m n√†y li√™n quan ƒë·∫øn c√°c gi√°c quan: nh√¨n, nghe, ng·ª≠i',
      verbs: [
        { base: 'hear', past: 'heard', pp: 'heard', vn: 'nghe' },
        { base: 'see', past: 'saw', pp: 'seen', vn: 'th·∫•y, nh√¨n' },
        { base: 'smell', past: 'smelt', pp: 'smelt', vn: 'ng·ª≠i' }
      ]
    },
    {
      id: 'nochange',
      name: '3. Kh√¥ng ƒë·ªïi',
      pattern: 'NO CHANGE',
      color: 'pattern-no-change',
      tip: 'üòé EASY! C·∫£ 3 d·∫°ng gi·ªëng h·ªát nhau - kh√¥ng c·∫ßn nh·ªõ g√¨ c·∫£!',
      verbs: [
        { base: 'cost', past: 'cost', pp: 'cost', vn: 't·ªën (ti·ªÅn)' },
        { base: 'cut', past: 'cut', pp: 'cut', vn: 'c·∫Øt' },
        { base: 'hit', past: 'hit', pp: 'hit', vn: 'ƒë√°nh, ƒë·∫≠p' },
        { base: 'hurt', past: 'hurt', pp: 'hurt', vn: 'ƒëau, l√†m ƒëau' },
        { base: 'let', past: 'let', pp: 'let', vn: 'ƒë·ªÉ, cho ph√©p' },
        { base: 'put', past: 'put', pp: 'put', vn: 'ƒë·∫∑t, ƒë·ªÉ' },
        { base: 'read', past: 'read', pp: 'read', vn: 'ƒë·ªçc (ph√°t √¢m kh√°c)' },
        { base: 'shut', past: 'shut', pp: 'shut', vn: 'ƒë√≥ng' }
      ]
    },
    {
      id: 'vowel',
      name: '4. I ‚Üí O ‚Üí E/EN',
      pattern: 'I - E / O - E / I - EN',
      color: 'pattern-vowel',
      tip: 'üî§ Quy lu·∫≠t nguy√™n √¢m: i ‚Üí o ‚Üí e/en. V√≠ d·ª•: drIve ‚Üí drOve ‚Üí drivEN',
      verbs: [
        { base: 'bite', past: 'bit', pp: 'bitten', vn: 'c·∫Øn' },
        { base: 'break', past: 'broke', pp: 'broken', vn: 'v·ª°, b·∫ª g√£y' },
        { base: 'choose', past: 'chose', pp: 'chosen', vn: 'ch·ªçn' },
        { base: 'drive', past: 'drove', pp: 'driven', vn: 'l√°i xe' },
        { base: 'eat', past: 'ate', pp: 'eaten', vn: 'ƒÉn' },
        { base: 'fall', past: 'fell', pp: 'fallen', vn: 'ng√£, r∆°i' },
        { base: 'give', past: 'gave', pp: 'given', vn: 'cho, t·∫∑ng' },
        { base: 'forget', past: 'forgot', pp: 'forgotten', vn: 'qu√™n' },
        { base: 'forgive', past: 'forgave', pp: 'forgiven', vn: 'tha th·ª©' },
        { base: 'freeze', past: 'froze', pp: 'frozen', vn: 'ƒë√¥ng ƒë√°' },
        { base: 'hide', past: 'hid', pp: 'hidden', vn: 'gi·∫•u, tr·ªën' },
        { base: 'ride', past: 'rode', pp: 'ridden', vn: 'c∆∞·ª°i, ƒëi (xe)' },
        { base: 'rise', past: 'rose', pp: 'risen', vn: 'm·ªçc, n·ªïi l√™n' },
        { base: 'shake', past: 'shook', pp: 'shaken', vn: 'l·∫Øc' },
        { base: 'speak', past: 'spoke', pp: 'spoken', vn: 'n√≥i' },
        { base: 'steal', past: 'stole', pp: 'stolen', vn: 'ƒÉn c·∫Øp' },
        { base: 'take', past: 'took', pp: 'taken', vn: 'l·∫•y, mang' },
        { base: 'wake', past: 'woke', pp: 'woken', vn: 'th·ª©c d·∫≠y' },
        { base: 'write', past: 'wrote', pp: 'written', vn: 'vi·∫øt' }
      ]
    },
    {
      id: 'drink',
      name: '5. I ‚Üí U*-A ‚Üí U',
      pattern: 'I / U* - A / U',
      color: 'pattern-drink',
      tip: 'üéµ Nh·ªõ theo nh·ªãp: drINK ‚Üí drANK ‚Üí drUNK. V·∫ßn nh∆∞ b√†i h√°t!',
      verbs: [
        { base: 'begin', past: 'began', pp: 'begun', vn: 'b·∫Øt ƒë·∫ßu' },
        { base: 'drink', past: 'drank', pp: 'drunk', vn: 'u·ªëng' },
        { base: 'ring', past: 'rang', pp: 'rung', vn: 'reo, rung chu√¥ng' },
        { base: 'sing', past: 'sang', pp: 'sung', vn: 'h√°t' },
        { base: 'swim', past: 'swam', pp: 'swum', vn: 'b∆°i' },
        { base: 'swing', past: 'swung', pp: 'swung', vn: 'ƒëung ƒë∆∞a' }
      ]
    },
    {
      id: 'owewown',
      name: '6. OW ‚Üí EW ‚Üí OWN',
      pattern: 'AW - OW / EW / OWN',
      color: 'pattern-ow-ew',
      tip: 'üí® Quy lu·∫≠t: OW ‚Üí EW ‚Üí OWN. V√≠ d·ª•: blOW ‚Üí blEW ‚Üí blOWN',
      verbs: [
        { base: 'blow', past: 'blew', pp: 'blown', vn: 'th·ªïi' },
        { base: 'draw', past: 'drew', pp: 'drawn', vn: 'v·∫Ω' },
        { base: 'fly', past: 'flew', pp: 'flown', vn: 'bay' },
        { base: 'grow', past: 'grew', pp: 'grown', vn: 'l·ªõn l√™n, tr·ªìng' },
        { base: 'know', past: 'knew', pp: 'known', vn: 'bi·∫øt' },
        { base: 'throw', past: 'threw', pp: 'thrown', vn: 'n√©m' }
      ]
    },
    {
      id: 'ought',
      name: '7. -AUGHT / -OUGHT',
      pattern: '-AUGHT / -OUGHT',
      color: 'pattern-ought',
      tip: 'üéØ K·∫øt th√∫c b·∫±ng -OUGHT ho·∫∑c -AUGHT. Ph√°t √¢m: /…îÀêt/',
      verbs: [
        { base: 'bring', past: 'brought', pp: 'brought', vn: 'mang ƒë·∫øn' },
        { base: 'buy', past: 'bought', pp: 'bought', vn: 'mua' },
        { base: 'catch', past: 'caught', pp: 'caught', vn: 'b·∫Øt' },
        { base: 'fight', past: 'fought', pp: 'fought', vn: 'chi·∫øn ƒë·∫•u' },
        { base: 'teach', past: 'taught', pp: 'taught', vn: 'd·∫°y' },
        { base: 'think', past: 'thought', pp: 'thought', vn: 'nghƒ©' }
      ]
    },
    {
      id: 'stand',
      name: '8. -STAND ‚Üí -STOOD',
      pattern: '-STAND / -STOOD / -STOOD',
      color: 'pattern-stand',
      tip: 'üßç Li√™n quan ƒë·∫øn ƒê·ª®NG: stand ‚Üí stood ‚Üí stood',
      verbs: [
        { base: 'stand', past: 'stood', pp: 'stood', vn: 'ƒë·ª©ng' },
        { base: 'understand', past: 'understood', pp: 'understood', vn: 'hi·ªÉu' }
      ]
    },
    {
      id: 'ee',
      name: '9. -EE- ‚Üí -E- ‚Üí -E-',
      pattern: '-EE- / -E- / -E-',
      color: 'pattern-ee',
      tip: 'üìñ Nguy√™n √¢m EE r√∫t ng·∫Øn th√†nh E. V√≠ d·ª•: fEEd ‚Üí fEd ‚Üí fEd',
      verbs: [
        { base: 'bleed', past: 'bled', pp: 'bled', vn: 'ch·∫£y m√°u' },
        { base: 'feed', past: 'fed', pp: 'fed', vn: 'cho ƒÉn' },
        { base: 'feel', past: 'felt', pp: 'felt', vn: 'c·∫£m th·∫•y' },
        { base: 'keep', past: 'kept', pp: 'kept', vn: 'gi·ªØ' },
        { base: 'meet', past: 'met', pp: 'met', vn: 'g·∫∑p' },
        { base: 'sleep', past: 'slept', pp: 'slept', vn: 'ng·ªß' },
        { base: 'sweep', past: 'swept', pp: 'swept', vn: 'qu√©t' }
      ]
    },
    {
      id: 'dt',
      name: '10. -D ‚Üí -T ‚Üí -T',
      pattern: '-D / -T / -T',
      color: 'pattern-d-t',
      tip: 'üîÑ ƒê·ªïi D th√†nh T. V√≠ d·ª•: senD ‚Üí senT ‚Üí senT',
      verbs: [
        { base: 'build', past: 'built', pp: 'built', vn: 'x√¢y d·ª±ng' },
        { base: 'lend', past: 'lent', pp: 'lent', vn: 'cho m∆∞·ª£n' },
        { base: 'send', past: 'sent', pp: 'sent', vn: 'g·ª≠i' },
        { base: 'spend', past: 'spent', pp: 'spent', vn: 'ti√™u (ti·ªÅn/th·ªùi gian)' }
      ]
    },
    {
      id: 't',
      name: '11. K·∫øt th√∫c -T',
      pattern: '-T / -T',
      color: 'pattern-t',
      tip: '‚ú® Past v√† PP ƒë·ªÅu k·∫øt th√∫c b·∫±ng -T',
      verbs: [
        { base: 'burn', past: 'burnt', pp: 'burnt', vn: 'ch√°y, ƒë·ªët' },
        { base: 'dream', past: 'dreamt', pp: 'dreamt', vn: 'm∆°' },
        { base: 'learn', past: 'learnt', pp: 'learnt', vn: 'h·ªçc' },
        { base: 'leave', past: 'left', pp: 'left', vn: 'r·ªùi ƒëi' },
        { base: 'light', past: 'lit', pp: 'lit', vn: 'th·∫Øp s√°ng' },
        { base: 'lose', past: 'lost', pp: 'lost', vn: 'm·∫•t, thua' },
        { base: 'mean', past: 'meant', pp: 'meant', vn: 'c√≥ nghƒ©a' },
        { base: 'shoot', past: 'shot', pp: 'shot', vn: 'b·∫Øn' },
        { base: 'sit', past: 'sat', pp: 'sat', vn: 'ng·ªìi' },
        { base: 'spell', past: 'spelt', pp: 'spelt', vn: 'ƒë√°nh v·∫ßn' }
      ]
    },
    {
      id: 'misc',
      name: '12. H·ªón h·ª£p',
      pattern: 'MISCELLANEOUS',
      color: 'pattern-misc',
      tip: 'üé≤ Nh√≥m ƒë·∫∑c bi·ªát - c·∫ßn nh·ªõ ri√™ng t·ª´ng t·ª´!',
      verbs: [
        { base: 'become', past: 'became', pp: 'become', vn: 'tr·ªü th√†nh' },
        { base: 'find', past: 'found', pp: 'found', vn: 't√¨m th·∫•y' },
        { base: 'hang', past: 'hung', pp: 'hung', vn: 'treo' },
        { base: 'hold', past: 'held', pp: 'held', vn: 'c·∫ßm, gi·ªØ' },
        { base: 'lay', past: 'laid', pp: 'laid', vn: 'ƒë·∫∑t, ƒë·ªÉ' },
        { base: 'lie', past: 'lay', pp: 'lain', vn: 'n·∫±m' },
        { base: 'pay', past: 'paid', pp: 'paid', vn: 'tr·∫£ ti·ªÅn' },
        { base: 'run', past: 'ran', pp: 'run', vn: 'ch·∫°y' },
        { base: 'sell', past: 'sold', pp: 'sold', vn: 'b√°n' },
        { base: 'shine', past: 'shone', pp: 'shone', vn: 'chi·∫øu s√°ng' },
        { base: 'show', past: 'showed', pp: 'shown', vn: 'cho xem' },
        { base: 'wear', past: 'wore', pp: 'worn', vn: 'm·∫∑c' },
        { base: 'win', past: 'won', pp: 'won', vn: 'th·∫Øng' }
      ]
    }
  ]
};

// Study state
var currentStudyGroup = 'all';
var expandedGroups = ['important'];
var studyQuizState = {
  active: false,
  verbs: [],
  currentIndex: 0,
  score: 0,
  answers: [],
  mode: 'past' // 'past' or 'pp'
};
var speedGameState = {
  active: false,
  timer: 30,
  score: 0,
  currentVerb: null,
  intervalId: null
};

// ============ STUDY SCREEN ============
function showLearnScreen() {
  playSound('click');
  
  // Hi·ªÉn th·ªã s·ªë c√¢u sai h√¥m nay
  var mistakeCount = todayMistakes.length;
  var mistakeBadge = mistakeCount > 0 ? 
    '<span style="background:#F44336;color:white;border-radius:50%;padding:2px 8px;font-size:0.8rem;margin-left:5px">' + mistakeCount + '</span>' : '';
  
  var html = '<div class="progress-header" style="margin-bottom:10px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üìö H·ªçc T·∫≠p</div>' +
    '<div></div></div>' +
    
    '<div class="study-header">' +
    '<div class="study-title">üìñ Horrible List</div>' +
    '<div class="study-subtitle">Danh s√°ch ƒë·ªông t·ª´ b·∫•t quy t·∫Øc</div>' +
    '</div>' +
    
    '<div class="study-tip-box">' +
    '<div class="study-tip-icon">üí°</div>' +
    '<div class="study-tip-text">' +
    '<strong>M·∫πo h·ªçc nhanh:</strong> H·ªçc theo nh√≥m c√≥ quy lu·∫≠t gi·ªëng nhau s·∫Ω d·ªÖ nh·ªõ h∆°n! ' +
    'B·∫Øt ƒë·∫ßu v·ªõi nh√≥m <strong>"Kh√¥ng ƒë·ªïi"</strong> v√¨ c·∫£ 3 d·∫°ng gi·ªëng nhau.' +
    '</div></div>' +
    
    // Study modes - TH√äM N√öT √îN T·∫¨P C√ÇU SAI
    '<div class="study-modes">' +
    '<button class="study-mode-btn" onclick="showTodayMistakes()" style="background:' + (mistakeCount > 0 ? '#FFEBEE' : '#F5F5F5') + ';color:' + (mistakeCount > 0 ? '#C62828' : '#999') + '">' +
    '<span class="icon">üîÑ</span>' +
    '<span>√în c√¢u sai' + mistakeBadge + '</span>' +
    '</button>' +
    '<button class="study-mode-btn" onclick="showContextLearn()" style="background:#FCE4EC;color:#C2185B">' +
    '<span class="icon">üìö</span>' +
    '<span>Ng·ªØ c·∫£nh</span>' +
    '</button>' +
    '<button class="study-mode-btn" onclick="startEasyMatch()" style="background:#E8F5E9;color:#2E7D32">' +
    '<span class="icon">üéØ</span>' +
    '<span>Easy Match</span>' +
    '</button>' +
    '<button class="study-mode-btn" onclick="startTripleMatch()" style="background:#E3F2FD;color:#1565C0">' +
    '<span class="icon">üîó</span>' +
    '<span>Triple Match</span>' +
    '</button>' +
    '</div>' +
    
    // Group selector
    '<div class="group-selector">' +
    '<button class="group-btn' + (currentStudyGroup === 'all' ? ' active' : '') + '" onclick="filterStudyGroup(\'all\')">T·∫•t c·∫£</button>';
  
  IRREGULAR_VERBS.groups.forEach(function(group) {
    html += '<button class="group-btn' + (currentStudyGroup === group.id ? ' active' : '') + '" onclick="filterStudyGroup(\'' + group.id + '\')">' + 
      group.name.split('.')[0] + '.' + group.pattern.substring(0, 8) + '</button>';
  });
  
  html += '</div>';
  
  // Verb groups
  var groupsToShow = currentStudyGroup === 'all' ? IRREGULAR_VERBS.groups : 
    IRREGULAR_VERBS.groups.filter(function(g) { return g.id === currentStudyGroup; });
  
  groupsToShow.forEach(function(group) {
    var isExpanded = expandedGroups.indexOf(group.id) >= 0;
    html += '<div class="verb-group-card">' +
      '<div class="verb-group-header ' + group.color + (isExpanded ? ' expanded' : '') + '" onclick="toggleVerbGroup(\'' + group.id + '\')">' +
      '<div class="verb-group-title">' +
      '<span>' + group.name + '</span>' +
      '<span class="verb-group-count">' + group.verbs.length + ' t·ª´</span>' +
      '</div>' +
      '<span class="verb-group-arrow' + (isExpanded ? ' rotated' : '') + '">‚ñº</span>' +
      '</div>' +
      '<div class="verb-group-content' + (isExpanded ? ' expanded' : '') + '">' +
      '<div class="study-tip-box" style="margin:15px;background:linear-gradient(135deg,#E3F2FD,#BBDEFB)">' +
      '<div class="study-tip-icon">üí°</div>' +
      '<div class="study-tip-text">' + group.tip + '</div>' +
      '</div>' +
      '<table class="verb-table">' +
      '<tr><th>Infinitive</th><th>Simple Past</th><th>Past Participle</th><th>Nghƒ©a üáªüá≥</th></tr>';
    
    group.verbs.forEach(function(verb) {
      html += '<tr>' +
        '<td>' + verb.base + '</td>' +
        '<td>' + verb.past + '</td>' +
        '<td>' + verb.pp + '</td>' +
        '<td>' + verb.vn + '</td>' +
        '</tr>';
    });
    
    html += '</table></div></div>';
  });
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function toggleVerbGroup(groupId) {
  playSound('click');
  var index = expandedGroups.indexOf(groupId);
  if (index >= 0) {
    expandedGroups.splice(index, 1);
  } else {
    expandedGroups.push(groupId);
  }
  showLearnScreen();
}

function filterStudyGroup(groupId) {
  playSound('click');
  currentStudyGroup = groupId;
  if (groupId !== 'all') {
    expandedGroups = [groupId];
  }
  showLearnScreen();
}

// ============ STUDY QUIZ ============
function startStudyQuiz(mode) {
  playSound('click');
  
  // Collect all verbs
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  studyQuizState = {
    active: true,
    verbs: shuffle(allVerbs).slice(0, 10),
    currentIndex: 0,
    score: 0,
    answers: [],
    mode: mode
  };
  
  renderStudyQuiz();
}

function renderStudyQuiz() {
  var state = studyQuizState;
  if (state.currentIndex >= state.verbs.length) {
    showStudyQuizResult();
    return;
  }
  
  var verb = state.verbs[state.currentIndex];
  var questionText = state.mode === 'past' ? 'D·∫°ng QU√Å KH·ª® c·ªßa:' : 'D·∫°ng PAST PARTICIPLE c·ªßa:';
  var answer = state.mode === 'past' ? verb.past : verb.pp;
  
  var dotsHtml = '';
  for (var i = 0; i < state.verbs.length; i++) {
    var dotClass = 'quiz-dot';
    if (i < state.currentIndex) {
      dotClass += state.answers[i] ? ' done' : ' wrong-dot';
    } else if (i === state.currentIndex) {
      dotClass += ' current';
    }
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="quiz-overlay" onclick="closeStudyQuiz(event)">' +
    '<div class="quiz-modal" onclick="event.stopPropagation()">' +
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px">' +
    '<button class="back-btn" onclick="closeStudyQuiz()" style="padding:8px 15px">‚úï</button>' +
    '<div style="font-weight:700;color:#666">' + (state.currentIndex + 1) + ' / ' + state.verbs.length + '</div>' +
    '<div style="font-weight:700;color:#4CAF50">‚≠ê ' + state.score + '</div>' +
    '</div>' +
    '<div class="quiz-question">' + questionText + '</div>' +
    '<div class="quiz-verb">' + verb.base + '</div>' +
    '<div style="color:#666;margin-bottom:15px">(' + verb.vn + ')</div>' +
    '<input type="text" class="quiz-input" id="quizInput" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi..." autocomplete="off" onkeypress="if(event.key===\'Enter\')checkStudyQuizAnswer()">' +
    '<div class="quiz-hint">üí° G√µ v√† nh·∫•n Enter</div>' +
    '<div id="quizFeedback"></div>' +
    '<div class="quiz-progress">' + dotsHtml + '</div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML += '<div id="quizOverlay">' + html + '</div>';
  setTimeout(function() {
    var input = document.getElementById('quizInput');
    if (input) input.focus();
  }, 100);
}

function checkStudyQuizAnswer() {
  var input = document.getElementById('quizInput');
  var userAnswer = input.value.trim().toLowerCase();
  var verb = studyQuizState.verbs[studyQuizState.currentIndex];
  var correctAnswer = studyQuizState.mode === 'past' ? verb.past : verb.pp;
  
  // Handle multiple correct answers (e.g., "was/were")
  var correctAnswers = correctAnswer.toLowerCase().split('/').map(function(a) { return a.trim(); });
  var isCorrect = correctAnswers.indexOf(userAnswer) >= 0;
  
  studyQuizState.answers.push(isCorrect);
  
  if (isCorrect) {
    studyQuizState.score++;
    input.classList.add('correct');
    playSound('correct');
  } else {
    input.classList.add('wrong');
    playSound('wrong');
    // TRACK C√ÇU SAI
    addMistake({
      verb: verb.base,
      verbVn: verb.vn,
      correctAnswer: correctAnswer,
      userAnswer: userAnswer,
      quizType: 'verb_form',
      mode: studyQuizState.mode // past ho·∫∑c pp
    });
  }
  
  var feedback = '<div style="margin-top:15px;padding:15px;border-radius:12px;' + 
    (isCorrect ? 'background:#E8F5E9' : 'background:#FFEBEE') + '">' +
    '<div style="font-size:2rem;margin-bottom:8px">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div style="font-weight:700;color:' + (isCorrect ? '#2E7D32' : '#C62828') + '">' +
    (isCorrect ? 'Ch√≠nh x√°c!' : 'ƒê√°p √°n: ' + correctAnswer) + '</div>' +
    '</div>';
  
  document.getElementById('quizFeedback').innerHTML = feedback;
  input.disabled = true;
  
  setTimeout(function() {
    studyQuizState.currentIndex++;
    document.getElementById('quizOverlay').remove();
    if (studyQuizState.currentIndex < studyQuizState.verbs.length) {
      renderStudyQuiz();
    } else {
      showStudyQuizResult();
    }
  }, 1500);
}

function showStudyQuizResult() {
  var state = studyQuizState;
  var percentage = Math.round((state.score / state.verbs.length) * 100);
  var emoji = percentage >= 80 ? 'üèÜ' : percentage >= 60 ? '‚≠ê' : percentage >= 40 ? 'üí™' : 'üìö';
  var studyMsgs = percentage >= 80 ? ['Con ƒë√£ luy·ªán t·∫≠p r·∫•t chƒÉm ch·ªâ!','S·ª± ki√™n tr√¨ c·ªßa con c√≥ k·∫øt qu·∫£!','N·ªó l·ª±c c·ªßa con th·∫≠t ƒë√°ng t·ª± h√†o!'] : percentage >= 60 ? ['Con ƒëang ti·∫øn b·ªô t·ª´ng ng√†y!','M·ªói l·∫ßn √¥n l√† m·ªói l·∫ßn v·ªØng h∆°n!','Con ƒë√£ c·ªë g·∫Øng, ti·∫øp t·ª•c nh√©!'] : percentage >= 40 ? ['ƒê·ª´ng n·∫£n! Con ƒëang tr√™n ƒë∆∞·ªùng ti·∫øn b·ªô!','Sai l√† ƒë·ªÉ h·ªçc, con l√†m ƒë√∫ng r·ªìi!','Luy·ªán th√™m, con s·∫Ω nh·ªõ l√¢u h∆°n!'] : ['M·ªói t·ª´ sai l√† c∆° h·ªôi ƒë·ªÉ nh·ªõ!','Ki√™n nh·∫´n √¥n l·∫°i, con s·∫Ω ti·∫øn b·ªô!','B·∫Øt ƒë·∫ßu l·∫°i c≈©ng l√† ti·∫øn b·ªô!'];var message = studyMsgs[Math.floor(Math.random()*3)];
  
  playSound('complete');
  showConfetti();
  
  var html = '<div class="quiz-overlay">' +
    '<div class="quiz-modal">' +
    '<div style="font-size:80px;margin-bottom:15px">' + emoji + '</div>' +
    '<div style="font-size:1.5rem;font-weight:800;color:#333;margin-bottom:10px">' + message + '</div>' +
    '<div style="font-size:3rem;font-weight:800;color:#667eea;margin:20px 0">' + state.score + '/' + state.verbs.length + '</div>' +
    '<div style="font-size:1.1rem;color:#666;margin-bottom:25px">' + percentage + '% ch√≠nh x√°c</div>' +
    '<button class="next-btn" onclick="closeStudyQuiz();startStudyQuiz(\'' + state.mode + '\')">Ch∆°i l·∫°i üîÑ</button>' +
    '<button class="next-btn" style="margin-top:10px;background:#F5F5F5;color:#333" onclick="closeStudyQuiz();showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML += '<div id="quizOverlay">' + html + '</div>';
}

function closeStudyQuiz(event) {
  if (event && event.target.className !== 'quiz-overlay') return;
  var overlay = document.getElementById('quizOverlay');
  if (overlay) overlay.remove();
  studyQuizState.active = false;
}

// ============ SPEED CHALLENGE ============
function startSpeedChallenge() {
  playSound('click');
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  speedGameState = {
    active: true,
    timer: 30,
    score: 0,
    verbs: shuffle(allVerbs),
    currentIndex: 0
  };
  
  renderSpeedGame();
  
  speedGameState.intervalId = setInterval(function() {
    speedGameState.timer--;
    updateSpeedTimer();
    if (speedGameState.timer <= 0) {
      endSpeedGame();
    }
  }, 1000);
}

function renderSpeedGame() {
  var state = speedGameState;
  var verb = state.verbs[state.currentIndex % state.verbs.length];
  
  var timerClass = 'speed-timer';
  if (state.timer <= 10) timerClass += ' warning';
  if (state.timer <= 5) timerClass += ' danger';
  
  var html = '<div class="progress-header" style="margin-bottom:10px">' +
    '<button class="back-btn" onclick="endSpeedGame()">‚Üê Tho√°t</button>' +
    '<div style="color:white;font-weight:700">‚ö° Th·ª≠ th√°ch t·ªëc ƒë·ªô</div>' +
    '<div></div></div>' +
    
    '<div class="' + timerClass + '" id="speedTimer">' + state.timer + '</div>' +
    '<div class="speed-score">üåü ƒêi·ªÉm: ' + state.score + '</div>' +
    
    '<div class="quiz-modal" style="margin:0 auto">' +
    '<div class="quiz-question">D·∫°ng QU√Å KH·ª® c·ªßa:</div>' +
    '<div class="quiz-verb">' + verb.base + '</div>' +
    '<div style="color:#666;margin-bottom:15px">(' + verb.vn + ')</div>' +
    '<input type="text" class="quiz-input" id="speedInput" placeholder="G√µ nhanh!" autocomplete="off" onkeypress="if(event.key===\'Enter\')checkSpeedAnswer()">' +
    '<div id="speedFeedback"></div>' +
    '</div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  setTimeout(function() {
    var input = document.getElementById('speedInput');
    if (input) input.focus();
  }, 50);
}

function updateSpeedTimer() {
  var timerEl = document.getElementById('speedTimer');
  if (timerEl) {
    timerEl.textContent = speedGameState.timer;
    timerEl.className = 'speed-timer';
    if (speedGameState.timer <= 10) timerEl.className += ' warning';
    if (speedGameState.timer <= 5) timerEl.className += ' danger';
  }
}

function checkSpeedAnswer() {
  var input = document.getElementById('speedInput');
  var userAnswer = input.value.trim().toLowerCase();
  var verb = speedGameState.verbs[speedGameState.currentIndex % speedGameState.verbs.length];
  var correctAnswers = verb.past.toLowerCase().split('/').map(function(a) { return a.trim(); });
  
  if (correctAnswers.indexOf(userAnswer) >= 0) {
    speedGameState.score++;
    playSound('correct');
  } else {
    playSound('wrong');
  }
  
  speedGameState.currentIndex++;
  renderSpeedGame();
}

function endSpeedGame() {
  if (speedGameState.intervalId) {
    clearInterval(speedGameState.intervalId);
  }
  
  var score = speedGameState.score;
  var emoji = score >= 15 ? 'üèÜ' : score >= 10 ? '‚≠ê' : score >= 5 ? 'üí™' : 'üìö';
  var message = score >= 15 ? 'Luy·ªán t·∫≠p c√≥ k·∫øt qu·∫£ r·ªìi!' : score >= 10 ? 'Con ƒëang ti·∫øn b·ªô!' : score >= 5 ? 'Ti·∫øp t·ª•c luy·ªán nh√©!' : 'M·ªói l·∫ßn th·ª≠ l√† m·ªói l·∫ßn hi·ªÉu th√™m!';
  
  playSound('complete');
  if (score >= 10) showConfetti();
  
  var html = '<div class="result-content">' +
    '<div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + message + '</div>' +
    '<div style="font-size:3rem;font-weight:800;color:#667eea;margin:20px 0">üåü ' + score + '</div>' +
    '<div class="result-message">trong 30 gi√¢y</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="startSpeedChallenge()">Ch∆°i l·∫°i ‚ö°</button>' +
    '<button class="result-btn secondary" onclick="showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
  speedGameState.active = false;
}

// ============ MEMORY GAME ============
var memoryGameState = {
  cards: [],
  flipped: [],
  matched: [],
  moves: 0
};

function startVerbMemory() {
  playSound('click');
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  var selectedVerbs = shuffle(allVerbs).slice(0, 6);
  var cards = [];
  
  selectedVerbs.forEach(function(verb, i) {
    cards.push({ id: 'base-' + i, text: verb.base, pairId: i, type: 'base' });
    cards.push({ id: 'past-' + i, text: verb.past, pairId: i, type: 'past' });
  });
  
  memoryGameState = {
    cards: shuffle(cards),
    flipped: [],
    matched: [],
    moves: 0
  };
  
  renderMemoryGame();
}

function renderMemoryGame() {
  var state = memoryGameState;
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üß† Memory Game</div>' +
    '<div style="color:white;font-weight:700">L∆∞·ª£t: ' + state.moves + '</div>' +
    '</div>' +
    
    '<div style="text-align:center;color:white;margin-bottom:15px">' +
    'üü¢ Gh√©p t·ª´ g·ªëc v·ªõi d·∫°ng qu√° kh·ª©!' +
    '</div>' +
    
    '<div class="memory-grid">';
  
  state.cards.forEach(function(card, index) {
    var isFlipped = state.flipped.indexOf(index) >= 0;
    var isMatched = state.matched.indexOf(card.pairId) >= 0;
    
    var cardClass = 'memory-card';
    if (isFlipped || isMatched) cardClass += ' flipped';
    if (isMatched) cardClass += ' matched';
    
    html += '<button class="' + cardClass + '" ' +
      (isMatched ? 'disabled' : 'onclick="flipMemoryCard(' + index + ')"') + '>' +
      (isFlipped || isMatched ? card.text : '‚ùì') +
      '</button>';
  });
  
  html += '</div>';
  
  if (state.matched.length >= 6) {
    html += '<div style="text-align:center;margin-top:25px">' +
      '<div style="font-size:60px;margin-bottom:15px">üéâ</div>' +
      '<div style="color:white;font-size:1.5rem;font-weight:700;margin-bottom:10px">Ho√†n th√†nh!</div>' +
      '<div style="color:rgba(255,255,255,0.8);margin-bottom:20px">S·ªë l∆∞·ª£t: ' + state.moves + '</div>' +
      '<button class="next-btn" onclick="startVerbMemory()">Ch∆°i l·∫°i üîÑ</button>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function flipMemoryCard(index) {
  var state = memoryGameState;
  
  if (state.flipped.length >= 2) return;
  if (state.flipped.indexOf(index) >= 0) return;
  if (state.matched.indexOf(state.cards[index].pairId) >= 0) return;
  
  playSound('flip');
  state.flipped.push(index);
  renderMemoryGame();
  
  if (state.flipped.length === 2) {
    state.moves++;
    var card1 = state.cards[state.flipped[0]];
    var card2 = state.cards[state.flipped[1]];
    
    if (card1.pairId === card2.pairId && card1.type !== card2.type) {
      // Match!
      setTimeout(function() {
        playSound('correct');
        state.matched.push(card1.pairId);
        state.flipped = [];
        renderMemoryGame();
        if (state.matched.length >= 6) {
          playSound('complete');
          showConfetti();
        }
      }, 500);
    } else {
      // No match
      setTimeout(function() {
        playSound('wrong');
        state.flipped = [];
        renderMemoryGame();
      }, 1000);
    }
  }
}

// ============ EASY MATCH GAME ============
var easyMatchState = {
  verbs: [],
  baseCards: [],
  pastCards: [],
  selectedBase: null,
  matched: [],
  level: 4
};

function startEasyMatch() {
  playSound('click');
  
  // Show level selection
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üéØ Easy Match</div>' +
    '<div></div></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üéØ</div>' +
    '<div class="easy-match-title">Easy Match</div>' +
    '<div class="easy-match-hint">Gh√©p t·ª´ g·ªëc v·ªõi t·ª´ qu√° kh·ª©</div>' +
    '</div>' +
    
    '<div class="easy-match-level-select">' +
    '<div class="easy-match-level easy" onclick="startEasyMatchGame(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">5 t·ª´</div>' +
    '<div class="level-desc">Kh·ªüi ƒë·ªông</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#8BC34A" onclick="startEasyMatchGame(10)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info">' +
    '<div class="level-name">10 t·ª´</div>' +
    '<div class="level-desc">C∆° b·∫£n</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level medium" onclick="startEasyMatchGame(15)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info">' +
    '<div class="level-name">15 t·ª´</div>' +
    '<div class="level-desc">Trung b√¨nh</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#FF9800" onclick="startEasyMatchGame(20)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info">' +
    '<div class="level-name">20 t·ª´</div>' +
    '<div class="level-desc">N√¢ng cao</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level hard" onclick="startEasyMatchGame(25)">' +
    '<div class="level-icon">üí™</div>' +
    '<div class="level-info">' +
    '<div class="level-name">25 t·ª´</div>' +
    '<div class="level-desc">Th·ª≠ th√°ch</div>' +
    '</div></div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function startEasyMatchGame(level) {
  playSound('click');
  
  // Collect all verbs
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      // Only use verbs where past is different from base
      if (verb.base !== verb.past) {
        allVerbs.push(verb);
      }
    });
  });
  
  var selectedVerbs = shuffle(allVerbs).slice(0, level);
  
  easyMatchState = {
    verbs: selectedVerbs,
    baseCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    pastCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    selectedBase: null,
    matched: [],
    level: level,
    showMeaning: level <= 6
  };
  
  renderEasyMatch();
}

function renderEasyMatch() {
  var state = easyMatchState;
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="startEasyMatch()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üéØ Easy Match</div>' +
    '<div style="color:white;font-weight:700">‚úì ' + state.matched.length + '/' + state.level + '</div>' +
    '</div>' +
    
    '<div style="text-align:center;color:white;margin-bottom:10px;padding:10px 15px;background:rgba(255,255,255,0.15);border-radius:12px">' +
    '<span style="font-size:1.1rem">' +
    (state.selectedBase === null ? 'üëÜ Ch·ªçn t·ª´ <strong style="color:#A5D6A7">G·ªêC</strong> (b√™n tr√°i)' : 
    'üëâ Ch·ªçn t·ª´ <strong style="color:#FFCC80">QU√Å KH·ª®</strong> t∆∞∆°ng ·ª©ng') +
    '</span></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-columns">' +
    
    // Base column
    '<div class="easy-match-column">' +
    '<div class="easy-match-label base">‚òÄÔ∏è T·ª´ g·ªëc</div>';
  
  state.baseCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var isSelected = state.selectedBase === card.index;
    var cardClass = 'easy-match-card base-card';
    if (isMatched) cardClass += ' matched';
    if (isSelected) cardClass += ' selected';
    
    html += '<div class="' + cardClass + '" ' +
      'id="base-' + card.index + '" ' +
      (isMatched ? '' : 'onclick="selectEasyMatchBase(' + card.index + ')"') + '>' +
      '<div class="verb-text">' + card.verb.base + '</div>' +
      (state.showMeaning ? '<div class="verb-meaning">' + card.verb.vn + '</div>' : '') +
      '</div>';
  });
  
  html += '</div>' +
    
    // Past column
    '<div class="easy-match-column">' +
    '<div class="easy-match-label past">üåô Qu√° kh·ª©</div>';
  
  state.pastCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var cardClass = 'easy-match-card past-card';
    if (isMatched) cardClass += ' matched';
    
    html += '<div class="' + cardClass + '" ' +
      'id="past-' + card.index + '" ' +
      (isMatched ? '' : 'onclick="selectEasyMatchPast(' + card.index + ')"') + '>' +
      '<div class="verb-text">' + card.verb.past + '</div>' +
      '</div>';
  });
  
  html += '</div></div>' +
    
    // Score section
    '<div class="easy-match-score">' +
    '<div class="easy-match-progress">';
  
  for (var i = 0; i < state.level; i++) {
    html += '<div class="easy-match-dot' + (i < state.matched.length ? ' done' : '') + '">' +
      (i < state.matched.length ? '‚úì' : (i + 1)) + '</div>';
  }
  
  html += '</div>' +
    '<div style="color:#2E7D32;font-weight:700">' +
    (state.matched.length === state.level ? 'üéâ Con ƒë√£ ho√†n th√†nh r·∫•t t·ªët!' : 
    'ƒê√£ gh√©p: ' + state.matched.length + ' / ' + state.level) +
    '</div></div></div>';
  
  // Complete screen
  if (state.matched.length === state.level) {
    playSound('complete');
    showConfetti();
    
    html += '<div style="text-align:center;margin-top:20px">' +
      '<button class="next-btn" onclick="startEasyMatchGame(' + state.level + ')" style="margin-bottom:10px">Ch∆°i l·∫°i üîÑ</button>' +
      '<button class="next-btn" style="background:#F5F5F5;color:#333" onclick="startEasyMatch()">ƒê·ªïi m·ª©c ƒë·ªô üìä</button>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function selectEasyMatchBase(index) {
  if (easyMatchState.matched.indexOf(index) >= 0) return;
  
  playSound('click');
  easyMatchState.selectedBase = index;
  renderEasyMatch();
}

function selectEasyMatchPast(index) {
  if (easyMatchState.selectedBase === null) {
    // Hint to select base first
    playSound('wrong');
    return;
  }
  
  if (easyMatchState.matched.indexOf(index) >= 0) return;
  
  var baseIndex = easyMatchState.selectedBase;
  
  if (baseIndex === index) {
    // Correct match!
    playSound('correct');
    
    // Flash animation
    var baseEl = document.getElementById('base-' + baseIndex);
    var pastEl = document.getElementById('past-' + index);
    if (baseEl) baseEl.classList.add('correct-flash');
    if (pastEl) pastEl.classList.add('correct-flash');
    
    setTimeout(function() {
      easyMatchState.matched.push(index);
      easyMatchState.selectedBase = null;
      renderEasyMatch();
    }, 500);
  } else {
    // Wrong match
    playSound('wrong');
    
    var pastEl = document.getElementById('past-' + index);
    if (pastEl) pastEl.classList.add('wrong-flash');
    
    setTimeout(function() {
      if (pastEl) pastEl.classList.remove('wrong-flash');
    }, 500);
  }
}

// ============ TRIPLE MATCH GAME ============
var tripleMatchState = {
  verbs: [],
  infCards: [],
  pastCards: [],
  ppCards: [],
  selectedInf: null,
  selectedPast: null,
  matched: [],
  level: 4,
  showMeaning: true
};

function startTripleMatch() {
  playSound('click');
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üîó Triple Match</div>' +
    '<div></div></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üîó</div>' +
    '<div class="easy-match-title">Triple Match</div>' +
    '<div class="easy-match-hint">Gh√©p c·∫£ 3 d·∫°ng: G·ªëc ‚Üí Qu√° kh·ª© ‚Üí PP</div>' +
    '</div>' +
    
    '<div class="easy-match-level-select">' +
    '<div class="easy-match-level easy" onclick="startTripleMatchGame(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">5 t·ª´</div>' +
    '<div class="level-desc">Kh·ªüi ƒë·ªông</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#8BC34A" onclick="startTripleMatchGame(10)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info">' +
    '<div class="level-name">10 t·ª´</div>' +
    '<div class="level-desc">C∆° b·∫£n</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level medium" onclick="startTripleMatchGame(15)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info">' +
    '<div class="level-name">15 t·ª´</div>' +
    '<div class="level-desc">Trung b√¨nh</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#FF9800" onclick="startTripleMatchGame(20)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info">' +
    '<div class="level-name">20 t·ª´</div>' +
    '<div class="level-desc">N√¢ng cao</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level hard" onclick="startTripleMatchGame(25)">' +
    '<div class="level-icon">üí™</div>' +
    '<div class="level-info">' +
    '<div class="level-name">25 t·ª´</div>' +
    '<div class="level-desc">Th·ª≠ th√°ch</div>' +
    '</div></div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function startTripleMatchGame(level) {
  playSound('click');
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      // Use verbs where all 3 forms are different for better learning
      if (verb.base !== verb.past || verb.past !== verb.pp) {
        allVerbs.push(verb);
      }
    });
  });
  
  var selectedVerbs = shuffle(allVerbs).slice(0, level);
  
  tripleMatchState = {
    verbs: selectedVerbs,
    infCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    pastCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    ppCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    selectedInf: null,
    selectedPast: null,
    matched: [],
    level: level,
    showMeaning: level <= 5
  };
  
  renderTripleMatch();
}

function renderTripleMatch() {
  var state = tripleMatchState;
  
  // Determine current step
  var step = 1;
  if (state.selectedInf !== null && state.selectedPast === null) step = 2;
  if (state.selectedInf !== null && state.selectedPast !== null) step = 3;
  
  var stepText = '';
  if (step === 1) stepText = '1Ô∏è‚É£ Ch·ªçn t·ª´ <strong>G·ªêC (Infinitive)</strong>';
  if (step === 2) stepText = '2Ô∏è‚É£ Ch·ªçn t·ª´ <strong>SIMPLE PAST</strong>';
  if (step === 3) stepText = '3Ô∏è‚É£ Ch·ªçn t·ª´ <strong>PAST PARTICIPLE</strong>';
  
  var html = '<div class="progress-header" style="margin-bottom:10px">' +
    '<button class="back-btn" onclick="startTripleMatch()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üîó Triple Match</div>' +
    '<div style="color:white;font-weight:700">‚úì ' + state.matched.length + '/' + state.level + '</div>' +
    '</div>' +
    
    '<div class="triple-hint-bar">' +
    '<span class="step ' + (step === 1 ? 'active' : (step > 1 ? 'done' : 'waiting')) + '">1. G·ªëc</span>' +
    ' ‚Üí ' +
    '<span class="step ' + (step === 2 ? 'active' : (step > 2 ? 'done' : 'waiting')) + '">2. Simple Past</span>' +
    ' ‚Üí ' +
    '<span class="step ' + (step === 3 ? 'active' : 'waiting') + '">3. Past Participle</span>' +
    '</div>' +
    
    '<div class="triple-match-container">' +
    '<div class="triple-columns">' +
    
    // Infinitive column
    '<div class="triple-column">' +
    '<div class="triple-label inf">‚òÄÔ∏è G·ªëc</div>';
  
  state.infCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var isSelected = state.selectedInf === card.index;
    var cardClass = 'triple-card inf-card';
    if (isMatched) cardClass += ' matched';
    if (isSelected) cardClass += ' locked';
    
    html += '<div class="' + cardClass + '" id="inf-' + card.index + '" ' +
      (isMatched || isSelected ? '' : 'onclick="selectTripleInf(' + card.index + ')"') + '>' +
      '<div>' + card.verb.base + '</div>' +
      (state.showMeaning ? '<div class="card-meaning">' + card.verb.vn + '</div>' : '') +
      '</div>';
  });
  
  html += '</div>' +
    
    // Past column
    '<div class="triple-column">' +
    '<div class="triple-label past">üåô Simple Past</div>';
  
  state.pastCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var isSelected = state.selectedPast === card.index;
    var cardClass = 'triple-card past-card';
    if (isMatched) cardClass += ' matched';
    if (isSelected) cardClass += ' locked';
    
    html += '<div class="' + cardClass + '" id="past-' + card.index + '" ' +
      (isMatched || isSelected ? '' : 'onclick="selectTriplePast(' + card.index + ')"') + '>' +
      '<div>' + card.verb.past + '</div>' +
      '</div>';
  });
  
  html += '</div>' +
    
    // Past Participle column
    '<div class="triple-column">' +
    '<div class="triple-label pp">‚ú® Past Participle</div>';
  
  state.ppCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var cardClass = 'triple-card pp-card';
    if (isMatched) cardClass += ' matched';
    
    html += '<div class="' + cardClass + '" id="pp-' + card.index + '" ' +
      (isMatched ? '' : 'onclick="selectTriplePP(' + card.index + ')"') + '>' +
      '<div>' + card.verb.pp + '</div>' +
      '</div>';
  });
  
  html += '</div></div>' +
    
    // Score section
    '<div class="triple-score-bar">' +
    '<div class="triple-progress-dots">';
  
  for (var i = 0; i < state.level; i++) {
    html += '<div class="triple-dot' + (i < state.matched.length ? ' done' : '') + '">' +
      (i < state.matched.length ? '‚úì' : '') + '</div>';
  }
  
  html += '</div>' +
    '<div style="font-weight:700;color:#333">' + state.matched.length + ' / ' + state.level + '</div>' +
    '</div></div>';
  
  // Complete screen
  if (state.matched.length === state.level) {
    playSound('complete');
    showConfetti();
    
    html += '<div style="text-align:center;margin-top:20px">' +
      '<div style="font-size:50px;margin-bottom:10px">üèÜ</div>' +
      '<div style="color:white;font-size:1.3rem;font-weight:700;margin-bottom:15px">Con ƒë√£ ki√™n nh·∫´n gh√©p ƒë√∫ng h·∫øt!</div>' +
      '<button class="next-btn" onclick="startTripleMatchGame(' + state.level + ')" style="margin-bottom:10px">Ch∆°i l·∫°i üîÑ</button>' +
      '<button class="next-btn" style="background:#F5F5F5;color:#333" onclick="startTripleMatch()">ƒê·ªïi m·ª©c ƒë·ªô üìä</button>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function selectTripleInf(index) {
  if (tripleMatchState.matched.indexOf(index) >= 0) return;
  if (tripleMatchState.selectedInf !== null) return; // Already selected
  
  playSound('click');
  tripleMatchState.selectedInf = index;
  renderTripleMatch();
}

function selectTriplePast(index) {
  if (tripleMatchState.selectedInf === null) {
    playSound('wrong');
    return; // Must select Inf first
  }
  if (tripleMatchState.matched.indexOf(index) >= 0) return;
  if (tripleMatchState.selectedPast !== null) return;
  
  // Check if correct
  if (index === tripleMatchState.selectedInf) {
    playSound('click');
    tripleMatchState.selectedPast = index;
    renderTripleMatch();
  } else {
    // Wrong - reset
    playSound('wrong');
    var el = document.getElementById('past-' + index);
    if (el) el.classList.add('wrong-flash');
    
    setTimeout(function() {
      tripleMatchState.selectedInf = null;
      tripleMatchState.selectedPast = null;
      renderTripleMatch();
    }, 600);
  }
}

function selectTriplePP(index) {
  if (tripleMatchState.selectedInf === null || tripleMatchState.selectedPast === null) {
    playSound('wrong');
    return;
  }
  if (tripleMatchState.matched.indexOf(index) >= 0) return;
  
  // Check if all 3 match
  if (index === tripleMatchState.selectedInf) {
    // Correct!
    playSound('correct');
    
    var infEl = document.getElementById('inf-' + tripleMatchState.selectedInf);
    var pastEl = document.getElementById('past-' + tripleMatchState.selectedPast);
    var ppEl = document.getElementById('pp-' + index);
    
    if (infEl) infEl.classList.add('correct-flash');
    if (pastEl) pastEl.classList.add('correct-flash');
    if (ppEl) ppEl.classList.add('correct-flash');
    
    setTimeout(function() {
      tripleMatchState.matched.push(index);
      tripleMatchState.selectedInf = null;
      tripleMatchState.selectedPast = null;
      renderTripleMatch();
    }, 600);
  } else {
    // Wrong - reset all
    playSound('wrong');
    var el = document.getElementById('pp-' + index);
    if (el) el.classList.add('wrong-flash');
    
    setTimeout(function() {
      tripleMatchState.selectedInf = null;
      tripleMatchState.selectedPast = null;
      renderTripleMatch();
    }, 600);
  }
}

// ============ VERB SENTENCE QUIZ ============
var sentenceQuizState = {
  questions: [],
  currentIndex: 0,
  score: 0,
  answered: false,
  level: 10,
  step: 1, // 1 = ch·ªçn Do/Does/Did, 2 = ch·ªçn ƒë·ªông t·ª´
  firstAnswer: null,
  mode: 'normal' // 'normal' ho·∫∑c 'twostep'
};

// Signal words for generating questions
var SIGNAL_WORDS = {
  present: [
    { signal: 'every day', vn: 'm·ªói ng√†y' },
    { signal: 'every morning', vn: 'm·ªói s√°ng' },
    { signal: 'every week', vn: 'm·ªói tu·∫ßn' },
    { signal: 'always', vn: 'lu√¥n lu√¥n' },
    { signal: 'usually', vn: 'th∆∞·ªùng' },
    { signal: 'often', vn: 'th∆∞·ªùng xuy√™n' },
    { signal: 'sometimes', vn: 'ƒë√¥i khi' }
  ],
  past: [
    { signal: 'yesterday', vn: 'h√¥m qua' },
    { signal: 'last night', vn: 't·ªëi qua' },
    { signal: 'last week', vn: 'tu·∫ßn tr∆∞·ªõc' },
    { signal: 'last month', vn: 'th√°ng tr∆∞·ªõc' },
    { signal: 'last year', vn: 'nƒÉm ngo√°i' },
    { signal: '2 days ago', vn: '2 ng√†y tr∆∞·ªõc' },
    { signal: 'this morning', vn: 's√°ng nay' }
  ]
};

var SENTENCE_TEMPLATES = [
  // =============== AFFIRMATIVE (C√¢u kh·∫≥ng ƒë·ªãnh) ===============
  // GO
  { template: 'I ___ to school {signal}.', subject: 'I', verb: 'go', vn: 'T√¥i ƒëi h·ªçc', type: 'affirm', emoji: 'üè´üö∂' },
  { template: 'She ___ to the park {signal}.', subject: 'She', verb: 'go', vn: 'C√¥ ·∫•y ƒëi c√¥ng vi√™n', type: 'affirm', emoji: 'üëßüå≥' },
  { template: 'They ___ shopping {signal}.', subject: 'They', verb: 'go', vn: 'H·ªç ƒëi mua s·∫Øm', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüõí' },
  { template: 'We ___ to church {signal}.', subject: 'We', verb: 'go', vn: 'Ch√∫ng t√¥i ƒëi nh√† th·ªù', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚õ™' },
  
  // EAT
  { template: 'She ___ breakfast {signal}.', subject: 'She', verb: 'eat', vn: 'C√¥ ·∫•y ƒÉn s√°ng', type: 'affirm', emoji: 'üëßüç≥' },
  { template: 'I ___ lunch at school {signal}.', subject: 'I', verb: 'eat', vn: 'T√¥i ƒÉn tr∆∞a ·ªü tr∆∞·ªùng', type: 'affirm', emoji: 'üßëüç±' },
  { template: 'He ___ dinner with family {signal}.', subject: 'He', verb: 'eat', vn: 'Anh ·∫•y ƒÉn t·ªëi v·ªõi gia ƒë√¨nh', type: 'affirm', emoji: 'üë¶üçΩÔ∏è' },
  { template: 'They ___ pizza {signal}.', subject: 'They', verb: 'eat', vn: 'H·ªç ƒÉn pizza', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüçï' },
  
  // READ
  { template: 'He ___ a book {signal}.', subject: 'He', verb: 'read', vn: 'Anh ·∫•y ƒë·ªçc s√°ch', type: 'affirm', emoji: 'üë¶üìñ' },
  { template: 'She ___ the newspaper {signal}.', subject: 'She', verb: 'read', vn: 'C√¥ ·∫•y ƒë·ªçc b√°o', type: 'affirm', emoji: 'üë©üì∞' },
  { template: 'I ___ comics {signal}.', subject: 'I', verb: 'read', vn: 'T√¥i ƒë·ªçc truy·ªán tranh', type: 'affirm', emoji: 'üßëüìö' },
  
  // MAKE
  { template: 'Mom ___ dinner {signal}.', subject: 'Mom', verb: 'make', vn: 'M·∫π n·∫•u b·ªØa t·ªëi', type: 'affirm', emoji: 'üë©‚Äçüç≥üç≤' },
  { template: 'She ___ a cake {signal}.', subject: 'She', verb: 'make', vn: 'C√¥ ·∫•y l√†m b√°nh', type: 'affirm', emoji: 'üëßüéÇ' },
  { template: 'I ___ my bed {signal}.', subject: 'I', verb: 'make', vn: 'T√¥i d·ªçn gi∆∞·ªùng', type: 'affirm', emoji: 'üßëüõèÔ∏è' },
  
  // DRINK
  { template: 'I ___ milk {signal}.', subject: 'I', verb: 'drink', vn: 'T√¥i u·ªëng s·ªØa', type: 'affirm', emoji: 'üßëü•õ' },
  { template: 'He ___ coffee {signal}.', subject: 'He', verb: 'drink', vn: 'Anh ·∫•y u·ªëng c√† ph√™', type: 'affirm', emoji: 'üë®‚òï' },
  { template: 'She ___ orange juice {signal}.', subject: 'She', verb: 'drink', vn: 'C√¥ ·∫•y u·ªëng n∆∞·ªõc cam', type: 'affirm', emoji: 'üëßüßÉ' },
  
  // SING
  { template: 'He ___ a song {signal}.', subject: 'He', verb: 'sing', vn: 'Anh ·∫•y h√°t m·ªôt b√†i', type: 'affirm', emoji: 'üë¶üé§' },
  { template: 'She ___ beautifully {signal}.', subject: 'She', verb: 'sing', vn: 'C√¥ ·∫•y h√°t hay', type: 'affirm', emoji: 'üëßüéµ' },
  { template: 'They ___ together {signal}.', subject: 'They', verb: 'sing', vn: 'H·ªç h√°t c√πng nhau', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüé∂' },
  
  // SWIM
  { template: 'They ___ in the pool {signal}.', subject: 'They', verb: 'swim', vn: 'H·ªç b∆°i trong h·ªì', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüèä' },
  { template: 'I ___ at the beach {signal}.', subject: 'I', verb: 'swim', vn: 'T√¥i b∆°i ·ªü bi·ªÉn', type: 'affirm', emoji: 'üßëüèñÔ∏è' },
  { template: 'He ___ very fast {signal}.', subject: 'He', verb: 'swim', vn: 'Anh ·∫•y b∆°i r·∫•t nhanh', type: 'affirm', emoji: 'üë¶üí®' },
  
  // DO
  { template: 'I ___ my homework {signal}.', subject: 'I', verb: 'do', vn: 'T√¥i l√†m b√†i t·∫≠p', type: 'affirm', emoji: 'üßëüìù' },
  { template: 'She ___ the dishes {signal}.', subject: 'She', verb: 'do', vn: 'C√¥ ·∫•y r·ª≠a b√°t', type: 'affirm', emoji: 'üëßüçΩÔ∏è' },
  { template: 'They ___ exercise {signal}.', subject: 'They', verb: 'do', vn: 'H·ªç t·∫≠p th·ªÉ d·ª•c', type: 'affirm', emoji: 'üë®‚Äçüë©‚ÄçüëßüèÉ' },
  
  // BUY
  { template: 'She ___ a new dress {signal}.', subject: 'She', verb: 'buy', vn: 'C√¥ ·∫•y mua v√°y m·ªõi', type: 'affirm', emoji: 'üëßüëó' },
  { template: 'I ___ some books {signal}.', subject: 'I', verb: 'buy', vn: 'T√¥i mua v√†i quy·ªÉn s√°ch', type: 'affirm', emoji: 'üßëüìö' },
  { template: 'He ___ a gift {signal}.', subject: 'He', verb: 'buy', vn: 'Anh ·∫•y mua qu√†', type: 'affirm', emoji: 'üë¶üéÅ' },
  
  // WRITE
  { template: 'We ___ a letter {signal}.', subject: 'We', verb: 'write', vn: 'Ch√∫ng t√¥i vi·∫øt th∆∞', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚úâÔ∏è' },
  { template: 'She ___ in her diary {signal}.', subject: 'She', verb: 'write', vn: 'C√¥ ·∫•y vi·∫øt nh·∫≠t k√Ω', type: 'affirm', emoji: 'üëßüìî' },
  { template: 'I ___ an email {signal}.', subject: 'I', verb: 'write', vn: 'T√¥i vi·∫øt email', type: 'affirm', emoji: 'üßëüíª' },
  
  // MEET
  { template: 'I ___ my friend {signal}.', subject: 'I', verb: 'meet', vn: 'T√¥i g·∫∑p b·∫°n', type: 'affirm', emoji: 'üßëü§ù' },
  { template: 'She ___ her teacher {signal}.', subject: 'She', verb: 'meet', vn: 'C√¥ ·∫•y g·∫∑p c√¥ gi√°o', type: 'affirm', emoji: 'üëßüë©‚Äçüè´' },
  { template: 'They ___ at the cafe {signal}.', subject: 'They', verb: 'meet', vn: 'H·ªç g·∫∑p nhau ·ªü qu√°n', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚òï' },
  
  // RUN
  { template: 'He ___ fast {signal}.', subject: 'He', verb: 'run', vn: 'Anh ·∫•y ch·∫°y nhanh', type: 'affirm', emoji: 'üë¶üèÉ' },
  { template: 'I ___ in the morning {signal}.', subject: 'I', verb: 'run', vn: 'T√¥i ch·∫°y bu·ªïi s√°ng', type: 'affirm', emoji: 'üßëüåÖ' },
  { template: 'They ___ in the park {signal}.', subject: 'They', verb: 'run', vn: 'H·ªç ch·∫°y trong c√¥ng vi√™n', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüå≥' },
  
  // GIVE
  { template: 'I ___ a gift to mom {signal}.', subject: 'I', verb: 'give', vn: 'T√¥i t·∫∑ng qu√† cho m·∫π', type: 'affirm', emoji: 'üßëüéÅ' },
  { template: 'She ___ me a book {signal}.', subject: 'She', verb: 'give', vn: 'C√¥ ·∫•y cho t√¥i s√°ch', type: 'affirm', emoji: 'üëßüìñ' },
  { template: 'He ___ flowers to her {signal}.', subject: 'He', verb: 'give', vn: 'Anh ·∫•y t·∫∑ng hoa cho c√¥ ·∫•y', type: 'affirm', emoji: 'üë¶üíê' },
  
  // TAKE
  { template: 'She ___ the bus {signal}.', subject: 'She', verb: 'take', vn: 'C√¥ ·∫•y ƒëi xe bu√Ωt', type: 'affirm', emoji: 'üëßüöå' },
  { template: 'I ___ a shower {signal}.', subject: 'I', verb: 'take', vn: 'T√¥i t·∫Øm', type: 'affirm', emoji: 'üßëüöø' },
  { template: 'He ___ photos {signal}.', subject: 'He', verb: 'take', vn: 'Anh ·∫•y ch·ª•p ·∫£nh', type: 'affirm', emoji: 'üë¶üì∑' },
  
  // COME
  { template: 'We ___ home late {signal}.', subject: 'We', verb: 'come', vn: 'Ch√∫ng t√¥i v·ªÅ nh√† mu·ªôn', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüè†' },
  { template: 'She ___ to my house {signal}.', subject: 'She', verb: 'come', vn: 'C√¥ ·∫•y ƒë·∫øn nh√† t√¥i', type: 'affirm', emoji: 'üëßüè°' },
  { template: 'They ___ to the party {signal}.', subject: 'They', verb: 'come', vn: 'H·ªç ƒë·∫øn b·ªØa ti·ªác', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüéâ' },
  
  // SEE
  { template: 'They ___ a movie {signal}.', subject: 'They', verb: 'see', vn: 'H·ªç xem phim', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüé¨' },
  { template: 'I ___ my grandma {signal}.', subject: 'I', verb: 'see', vn: 'T√¥i g·∫∑p b√†', type: 'affirm', emoji: 'üßëüëµ' },
  { template: 'She ___ a bird {signal}.', subject: 'She', verb: 'see', vn: 'C√¥ ·∫•y nh√¨n th·∫•y con chim', type: 'affirm', emoji: 'üëßüê¶' },
  
  // SLEEP
  { template: 'I ___ early {signal}.', subject: 'I', verb: 'sleep', vn: 'T√¥i ng·ªß s·ªõm', type: 'affirm', emoji: 'üßíüò¥' },
  { template: 'She ___ late {signal}.', subject: 'She', verb: 'sleep', vn: 'C√¥ ·∫•y ng·ªß mu·ªôn', type: 'affirm', emoji: 'üëßüåô' },
  { template: 'The baby ___ well {signal}.', subject: 'The baby', verb: 'sleep', vn: 'Em b√© ng·ªß ngon', type: 'affirm', emoji: 'üë∂üí§' },
  
  // HAVE
  { template: 'I ___ breakfast {signal}.', subject: 'I', verb: 'have', vn: 'T√¥i ƒÉn s√°ng', type: 'affirm', emoji: 'üßëüç≥' },
  { template: 'She ___ a dog {signal}.', subject: 'She', verb: 'have', vn: 'C√¥ ·∫•y c√≥ con ch√≥', type: 'affirm', emoji: 'üëßüêï' },
  { template: 'We ___ a party {signal}.', subject: 'We', verb: 'have', vn: 'Ch√∫ng t√¥i c√≥ b·ªØa ti·ªác', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüéä' },
  
  // GET
  { template: 'I ___ a present {signal}.', subject: 'I', verb: 'get', vn: 'T√¥i ƒë∆∞·ª£c qu√†', type: 'affirm', emoji: 'üßëüéÅ' },
  { template: 'She ___ good grades {signal}.', subject: 'She', verb: 'get', vn: 'C√¥ ·∫•y ƒë∆∞·ª£c ƒëi·ªÉm cao', type: 'affirm', emoji: 'üëßüíØ' },
  { template: 'He ___ up early {signal}.', subject: 'He', verb: 'get', vn: 'Anh ·∫•y d·∫≠y s·ªõm', type: 'affirm', emoji: 'üë¶‚è∞' },
  
  // FEEL
  { template: 'I ___ happy {signal}.', subject: 'I', verb: 'feel', vn: 'T√¥i c·∫£m th·∫•y vui', type: 'affirm', emoji: 'üßëüòä' },
  { template: 'She ___ tired {signal}.', subject: 'She', verb: 'feel', vn: 'C√¥ ·∫•y c·∫£m th·∫•y m·ªát', type: 'affirm', emoji: 'üëßüò´' },
  { template: 'He ___ sick {signal}.', subject: 'He', verb: 'feel', vn: 'Anh ·∫•y c·∫£m th·∫•y ·ªëm', type: 'affirm', emoji: 'üë¶ü§í' },
  
  // FIND
  { template: 'I ___ my keys {signal}.', subject: 'I', verb: 'find', vn: 'T√¥i t√¨m th·∫•y ch√¨a kh√≥a', type: 'affirm', emoji: 'üßëüîë' },
  { template: 'She ___ a new job {signal}.', subject: 'She', verb: 'find', vn: 'C√¥ ·∫•y t√¨m ƒë∆∞·ª£c vi·ªác m·ªõi', type: 'affirm', emoji: 'üë©üíº' },
  { template: 'He ___ the answer {signal}.', subject: 'He', verb: 'find', vn: 'Anh ·∫•y t√¨m ra ƒë√°p √°n', type: 'affirm', emoji: 'üë¶üí°' },
  
  // LOSE
  { template: 'He ___ his phone {signal}.', subject: 'He', verb: 'lose', vn: 'Anh ·∫•y m·∫•t ƒëi·ªán tho·∫°i', type: 'affirm', emoji: 'üë¶üì±' },
  { template: 'I ___ my wallet {signal}.', subject: 'I', verb: 'lose', vn: 'T√¥i m·∫•t v√≠', type: 'affirm', emoji: 'üßëüëõ' },
  { template: 'She ___ her keys {signal}.', subject: 'She', verb: 'lose', vn: 'C√¥ ·∫•y m·∫•t ch√¨a kh√≥a', type: 'affirm', emoji: 'üëßüîë' },
  
  // TEACH
  { template: 'She ___ English {signal}.', subject: 'She', verb: 'teach', vn: 'C√¥ ·∫•y d·∫°y ti·∫øng Anh', type: 'affirm', emoji: 'üë©‚Äçüè´üìö' },
  { template: 'He ___ me math {signal}.', subject: 'He', verb: 'teach', vn: 'Anh ·∫•y d·∫°y t√¥i to√°n', type: 'affirm', emoji: 'üë®‚Äçüè´üî¢' },
  
  // THINK
  { template: 'I ___ about you {signal}.', subject: 'I', verb: 'think', vn: 'T√¥i nghƒ© v·ªÅ b·∫°n', type: 'affirm', emoji: 'üßëüí≠' },
  { template: 'She ___ hard {signal}.', subject: 'She', verb: 'think', vn: 'C√¥ ·∫•y suy nghƒ© nhi·ªÅu', type: 'affirm', emoji: 'üëßü§î' },
  
  // BRING
  { template: 'I ___ my book {signal}.', subject: 'I', verb: 'bring', vn: 'T√¥i mang s√°ch', type: 'affirm', emoji: 'üßëüìñ' },
  { template: 'She ___ food {signal}.', subject: 'She', verb: 'bring', vn: 'C√¥ ·∫•y mang ƒë·ªì ƒÉn', type: 'affirm', emoji: 'üëßüç±' },
  
  // WIN
  { template: 'He ___ the game {signal}.', subject: 'He', verb: 'win', vn: 'Anh ·∫•y th·∫Øng tr·∫≠n', type: 'affirm', emoji: 'üë¶üèÜ' },
  { template: 'She ___ a prize {signal}.', subject: 'She', verb: 'win', vn: 'C√¥ ·∫•y th·∫Øng gi·∫£i', type: 'affirm', emoji: 'üëßü•á' },
  
  // WEAR
  { template: 'She ___ a dress {signal}.', subject: 'She', verb: 'wear', vn: 'C√¥ ·∫•y m·∫∑c v√°y', type: 'affirm', emoji: 'üëßüëó' },
  { template: 'He ___ a hat {signal}.', subject: 'He', verb: 'wear', vn: 'Anh ·∫•y ƒë·ªôi m≈©', type: 'affirm', emoji: 'üë¶üé©' },
  
  // =============== NEGATIVE (C√¢u ph·ªß ƒë·ªãnh) ===============
  // GO
  { template: 'I ___ go to school {signal}.', subject: 'I', verb: 'go', vn: 'T√¥i kh√¥ng ƒëi h·ªçc', type: 'negative', emoji: 'üßëüö´üè´' },
  { template: 'She ___ go to the park {signal}.', subject: 'She', verb: 'go', vn: 'C√¥ ·∫•y kh√¥ng ƒëi c√¥ng vi√™n', type: 'negative', emoji: 'üëßüö´üå≥' },
  { template: 'They ___ go shopping {signal}.', subject: 'They', verb: 'go', vn: 'H·ªç kh√¥ng ƒëi mua s·∫Øm', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üõí' },
  { template: 'He ___ go to work {signal}.', subject: 'He', verb: 'go', vn: 'Anh ·∫•y kh√¥ng ƒëi l√†m', type: 'negative', emoji: 'üë®üö´üíº' },
  
  // EAT
  { template: 'She ___ eat breakfast {signal}.', subject: 'She', verb: 'eat', vn: 'C√¥ ·∫•y kh√¥ng ƒÉn s√°ng', type: 'negative', emoji: 'üëßüö´üç≥' },
  { template: 'I ___ eat meat {signal}.', subject: 'I', verb: 'eat', vn: 'T√¥i kh√¥ng ƒÉn th·ªãt', type: 'negative', emoji: 'üßëüö´ü•©' },
  { template: 'He ___ eat vegetables {signal}.', subject: 'He', verb: 'eat', vn: 'Anh ·∫•y kh√¥ng ƒÉn rau', type: 'negative', emoji: 'üë¶üö´ü•¨' },
  { template: 'They ___ eat fast food {signal}.', subject: 'They', verb: 'eat', vn: 'H·ªç kh√¥ng ƒÉn ƒë·ªì ƒÉn nhanh', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üçî' },
  
  // DRINK
  { template: 'I ___ drink coffee {signal}.', subject: 'I', verb: 'drink', vn: 'T√¥i kh√¥ng u·ªëng c√† ph√™', type: 'negative', emoji: 'üßëüö´‚òï' },
  { template: 'She ___ drink soda {signal}.', subject: 'She', verb: 'drink', vn: 'C√¥ ·∫•y kh√¥ng u·ªëng n∆∞·ªõc ng·ªçt', type: 'negative', emoji: 'üëßüö´ü•§' },
  { template: 'He ___ drink alcohol {signal}.', subject: 'He', verb: 'drink', vn: 'Anh ·∫•y kh√¥ng u·ªëng r∆∞·ª£u', type: 'negative', emoji: 'üë®üö´üç∫' },
  
  // DO
  { template: 'I ___ do my homework {signal}.', subject: 'I', verb: 'do', vn: 'T√¥i kh√¥ng l√†m b√†i t·∫≠p', type: 'negative', emoji: 'üßëüö´üìù' },
  { template: 'She ___ do the dishes {signal}.', subject: 'She', verb: 'do', vn: 'C√¥ ·∫•y kh√¥ng r·ª≠a b√°t', type: 'negative', emoji: 'üëßüö´üçΩÔ∏è' },
  { template: 'They ___ do exercise {signal}.', subject: 'They', verb: 'do', vn: 'H·ªç kh√¥ng t·∫≠p th·ªÉ d·ª•c', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üèÉ' },
  
  // HAVE
  { template: 'I ___ have breakfast {signal}.', subject: 'I', verb: 'have', vn: 'T√¥i kh√¥ng ƒÉn s√°ng', type: 'negative', emoji: 'üßëüö´üç≥' },
  { template: 'She ___ have time {signal}.', subject: 'She', verb: 'have', vn: 'C√¥ ·∫•y kh√¥ng c√≥ th·ªùi gian', type: 'negative', emoji: 'üëßüö´‚è∞' },
  { template: 'We ___ have money {signal}.', subject: 'We', verb: 'have', vn: 'Ch√∫ng t√¥i kh√¥ng c√≥ ti·ªÅn', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üí∞' },
  
  // SLEEP
  { template: 'I ___ sleep well {signal}.', subject: 'I', verb: 'sleep', vn: 'T√¥i kh√¥ng ng·ªß ngon', type: 'negative', emoji: 'üßëüö´üò¥' },
  { template: 'She ___ sleep late {signal}.', subject: 'She', verb: 'sleep', vn: 'C√¥ ·∫•y kh√¥ng ng·ªß mu·ªôn', type: 'negative', emoji: 'üëßüö´üåô' },
  { template: 'He ___ sleep enough {signal}.', subject: 'He', verb: 'sleep', vn: 'Anh ·∫•y kh√¥ng ng·ªß ƒë·ªß', type: 'negative', emoji: 'üë¶üö´üí§' },
  
  // COME
  { template: 'She ___ come to the party {signal}.', subject: 'She', verb: 'come', vn: 'C√¥ ·∫•y kh√¥ng ƒë·∫øn ti·ªác', type: 'negative', emoji: 'üëßüö´üéâ' },
  { template: 'He ___ come home early {signal}.', subject: 'He', verb: 'come', vn: 'Anh ·∫•y kh√¥ng v·ªÅ nh√† s·ªõm', type: 'negative', emoji: 'üë¶üö´üè†' },
  { template: 'They ___ come to school {signal}.', subject: 'They', verb: 'come', vn: 'H·ªç kh√¥ng ƒë·∫øn tr∆∞·ªùng', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üè´' },
  
  // SEE
  { template: 'I ___ see the movie {signal}.', subject: 'I', verb: 'see', vn: 'T√¥i kh√¥ng xem phim', type: 'negative', emoji: 'üßëüö´üé¨' },
  { template: 'She ___ see him {signal}.', subject: 'She', verb: 'see', vn: 'C√¥ ·∫•y kh√¥ng g·∫∑p anh ·∫•y', type: 'negative', emoji: 'üëßüö´üë¶' },
  { template: 'They ___ see anything {signal}.', subject: 'They', verb: 'see', vn: 'H·ªç kh√¥ng th·∫•y g√¨', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üëÄ' },
  
  // KNOW
  { template: 'I ___ know the answer {signal}.', subject: 'I', verb: 'know', vn: 'T√¥i kh√¥ng bi·∫øt c√¢u tr·∫£ l·ªùi', type: 'negative', emoji: 'üßëüö´‚ùì' },
  { template: 'She ___ know him {signal}.', subject: 'She', verb: 'know', vn: 'C√¥ ·∫•y kh√¥ng bi·∫øt anh ·∫•y', type: 'negative', emoji: 'üëßüö´üë¶' },
  { template: 'They ___ know the way {signal}.', subject: 'They', verb: 'know', vn: 'H·ªç kh√¥ng bi·∫øt ƒë∆∞·ªùng', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üó∫Ô∏è' },
  
  // WIN
  { template: 'We ___ win the game {signal}.', subject: 'We', verb: 'win', vn: 'Ch√∫ng t√¥i kh√¥ng th·∫Øng', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üèÜ' },
  { template: 'He ___ win the match {signal}.', subject: 'He', verb: 'win', vn: 'Anh ·∫•y kh√¥ng th·∫Øng tr·∫≠n', type: 'negative', emoji: 'üë¶üö´ü•á' },
  
  // =============== QUESTION (C√¢u h·ªèi) - Y√™u c·∫ßu ch·ªçn chia ƒë·ªông t·ª´ ===============
  // GO
  { template: 'Does she ___ to the park {signal}?', subject: 'she', verb: 'go', vn: 'C√¥ ·∫•y c√≥ ƒëi c√¥ng vi√™n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüå≥' },
  { template: 'Do they ___ shopping {signal}?', subject: 'they', verb: 'go', vn: 'H·ªç c√≥ ƒëi mua s·∫Øm kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüõí' },
  { template: 'Did he ___ to work {signal}?', subject: 'he', verb: 'go', vn: 'Anh ·∫•y c√≥ ƒëi l√†m kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®üíº' },
  { template: 'Did you ___ to school {signal}?', subject: 'you', verb: 'go', vn: 'B·∫°n c√≥ ƒëi h·ªçc kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüè´' },
  
  // EAT
  { template: 'Does she ___ breakfast {signal}?', subject: 'she', verb: 'eat', vn: 'C√¥ ·∫•y c√≥ ƒÉn s√°ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüç≥' },
  { template: 'Do you ___ lunch {signal}?', subject: 'you', verb: 'eat', vn: 'B·∫°n c√≥ ƒÉn tr∆∞a kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüç±' },
  { template: 'Did he ___ dinner {signal}?', subject: 'he', verb: 'eat', vn: 'Anh ·∫•y c√≥ ƒÉn t·ªëi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üçΩÔ∏è' },
  { template: 'Did they ___ pizza {signal}?', subject: 'they', verb: 'eat', vn: 'H·ªç c√≥ ƒÉn pizza kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüçï' },
  
  // DRINK
  { template: 'Do you ___ milk {signal}?', subject: 'you', verb: 'drink', vn: 'B·∫°n c√≥ u·ªëng s·ªØa kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü•õ' },
  { template: 'Does she ___ coffee {signal}?', subject: 'she', verb: 'drink', vn: 'C√¥ ·∫•y c√≥ u·ªëng c√† ph√™ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëß‚òï' },
  { template: 'Did he ___ tea {signal}?', subject: 'he', verb: 'drink', vn: 'Anh ·∫•y c√≥ u·ªëng tr√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üçµ' },
  
  // DO
  { template: 'Do you ___ homework {signal}?', subject: 'you', verb: 'do', vn: 'B·∫°n c√≥ l√†m b√†i t·∫≠p kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìù' },
  { template: 'Does she ___ exercise {signal}?', subject: 'she', verb: 'do', vn: 'C√¥ ·∫•y c√≥ t·∫≠p th·ªÉ d·ª•c kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüèÉ' },
  { template: 'Did they ___ the dishes {signal}?', subject: 'they', verb: 'do', vn: 'H·ªç c√≥ r·ª≠a b√°t kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚ÄçüëßüçΩÔ∏è' },
  
  // HAVE
  { template: 'Do you ___ breakfast {signal}?', subject: 'you', verb: 'have', vn: 'B·∫°n c√≥ ƒÉn s√°ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüç≥' },
  { template: 'Does she ___ a car {signal}?', subject: 'she', verb: 'have', vn: 'C√¥ ·∫•y c√≥ xe h∆°i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüöó' },
  { template: 'Did they ___ fun {signal}?', subject: 'they', verb: 'have', vn: 'H·ªç c√≥ vui kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚ÄçüëßüòÑ' },
  
  // SLEEP
  { template: 'Do you ___ well {signal}?', subject: 'you', verb: 'sleep', vn: 'B·∫°n c√≥ ng·ªß ngon kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüò¥' },
  { template: 'Does she ___ early {signal}?', subject: 'she', verb: 'sleep', vn: 'C√¥ ·∫•y c√≥ ng·ªß s·ªõm kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüåô' },
  { template: 'Did he ___ late {signal}?', subject: 'he', verb: 'sleep', vn: 'Anh ·∫•y c√≥ ng·ªß mu·ªôn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üí§' },
  
  // SEE
  { template: 'Do you ___ the movie {signal}?', subject: 'you', verb: 'see', vn: 'B·∫°n c√≥ xem phim kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüé¨' },
  { template: 'Does she ___ him {signal}?', subject: 'she', verb: 'see', vn: 'C√¥ ·∫•y c√≥ g·∫∑p anh ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüë¶' },
  { template: 'Did they ___ the show {signal}?', subject: 'they', verb: 'see', vn: 'H·ªç c√≥ xem show kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüì∫' },
  
  // BUY
  { template: 'Do you ___ a gift {signal}?', subject: 'you', verb: 'buy', vn: 'B·∫°n c√≥ mua qu√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüéÅ' },
  { template: 'Does she ___ clothes {signal}?', subject: 'she', verb: 'buy', vn: 'C√¥ ·∫•y c√≥ mua qu·∫ßn √°o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüëó' },
  { template: 'Did he ___ a book {signal}?', subject: 'he', verb: 'buy', vn: 'Anh ·∫•y c√≥ mua s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üìñ' },
  
  // MEET
  { template: 'Do you ___ her {signal}?', subject: 'you', verb: 'meet', vn: 'B·∫°n c√≥ g·∫∑p c√¥ ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü§ù' },
  { template: 'Did they ___ at school {signal}?', subject: 'they', verb: 'meet', vn: 'H·ªç c√≥ g·∫∑p nhau ·ªü tr∆∞·ªùng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüè´' },
  
  // RUN
  { template: 'Do you ___ in the morning {signal}?', subject: 'you', verb: 'run', vn: 'B·∫°n c√≥ ch·∫°y bu·ªïi s√°ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèÉ' },
  { template: 'Does he ___ fast {signal}?', subject: 'he', verb: 'run', vn: 'Anh ·∫•y c√≥ ch·∫°y nhanh kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üí®' },
  
  // SWIM
  { template: 'Do you ___ {signal}?', subject: 'you', verb: 'swim', vn: 'B·∫°n c√≥ b∆°i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèä' },
  { template: 'Does she ___ well {signal}?', subject: 'she', verb: 'swim', vn: 'C√¥ ·∫•y c√≥ b∆°i gi·ªèi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüèä‚Äç‚ôÄÔ∏è' },
  
  // SING
  { template: 'Do you ___ songs {signal}?', subject: 'you', verb: 'sing', vn: 'B·∫°n c√≥ h√°t kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüé§' },
  { template: 'Does she ___ well {signal}?', subject: 'she', verb: 'sing', vn: 'C√¥ ·∫•y c√≥ h√°t hay kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüéµ' },
  
  // WIN
  { template: 'Did you ___ the game {signal}?', subject: 'you', verb: 'win', vn: 'B·∫°n c√≥ th·∫Øng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèÜ' },
  { template: 'Did they ___ the match {signal}?', subject: 'they', verb: 'win', vn: 'H·ªç c√≥ th·∫Øng tr·∫≠n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßü•á' },
  
  // WRITE
  { template: 'Do you ___ a letter {signal}?', subject: 'you', verb: 'write', vn: 'B·∫°n c√≥ vi·∫øt th∆∞ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úâÔ∏è' },
  { template: 'Does she ___ emails {signal}?', subject: 'she', verb: 'write', vn: 'C√¥ ·∫•y c√≥ vi·∫øt email kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüíª' },
  
  // READ
  { template: 'Do you ___ books {signal}?', subject: 'you', verb: 'read', vn: 'B·∫°n c√≥ ƒë·ªçc s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìö' },
  { template: 'Does he ___ newspapers {signal}?', subject: 'he', verb: 'read', vn: 'Anh ·∫•y c√≥ ƒë·ªçc b√°o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®üì∞' },
  
  // SPEAK
  { template: 'Do you ___ English {signal}?', subject: 'you', verb: 'speak', vn: 'B·∫°n c√≥ n√≥i ti·∫øng Anh kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüó£Ô∏è' },
  { template: 'Does she ___ French {signal}?', subject: 'she', verb: 'speak', vn: 'C√¥ ·∫•y c√≥ n√≥i ti·∫øng Ph√°p kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüá´üá∑' },
  
  // GIVE
  { template: 'Did you ___ him money {signal}?', subject: 'you', verb: 'give', vn: 'B·∫°n c√≥ cho anh ·∫•y ti·ªÅn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí∞' },
  { template: 'Did she ___ a present {signal}?', subject: 'she', verb: 'give', vn: 'C√¥ ·∫•y c√≥ t·∫∑ng qu√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüéÅ' },
  
  // TAKE
  { template: 'Did you ___ the bus {signal}?', subject: 'you', verb: 'take', vn: 'B·∫°n c√≥ ƒëi xe bu√Ωt kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüöå' },
  { template: 'Did she ___ photos {signal}?', subject: 'she', verb: 'take', vn: 'C√¥ ·∫•y c√≥ ch·ª•p ·∫£nh kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüì∑' },
  
  // BRING
  { template: 'Did you ___ your book {signal}?', subject: 'you', verb: 'bring', vn: 'B·∫°n c√≥ mang s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìñ' },
  { template: 'Did she ___ food {signal}?', subject: 'she', verb: 'bring', vn: 'C√¥ ·∫•y c√≥ mang ƒë·ªì ƒÉn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüç±' },

  // =============== B·ªî SUNG ƒê·ªòNG T·ª™ PH·ªî BI·∫æN (theo th·ª© t·ª± t·ª´ ph·ªï bi·∫øn ‚Üí √≠t ph·ªï bi·∫øn) ===============
  
  // === NH√ìM 1: C·ª∞C K·ª≤ PH·ªî BI·∫æN ===
  
  // SAY (n√≥i)
  { template: 'He ___ hello {signal}.', subject: 'He', verb: 'say', vn: 'Anh ·∫•y n√≥i xin ch√†o', type: 'affirm', emoji: 'üë¶üëã' },
  { template: 'She ___ goodbye {signal}.', subject: 'She', verb: 'say', vn: 'C√¥ ·∫•y n√≥i t·∫°m bi·ªát', type: 'affirm', emoji: 'üëßüëã' },
  { template: 'I ___ thank you {signal}.', subject: 'I', verb: 'say', vn: 'T√¥i n√≥i c·∫£m ∆°n', type: 'affirm', emoji: 'üßëüôè' },
  { template: 'She ___ say sorry {signal}.', subject: 'She', verb: 'say', vn: 'C√¥ ·∫•y kh√¥ng n√≥i xin l·ªói', type: 'negative', emoji: 'üëßüö´' },
  { template: 'Did he ___ anything {signal}?', subject: 'he', verb: 'say', vn: 'Anh ·∫•y c√≥ n√≥i g√¨ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üí¨' },

  // TELL (k·ªÉ, n√≥i v·ªõi)
  { template: 'Mom ___ me a story {signal}.', subject: 'Mom', verb: 'tell', vn: 'M·∫π k·ªÉ t√¥i m·ªôt c√¢u chuy·ªán', type: 'affirm', emoji: 'üë©üìñ' },
  { template: 'He ___ the truth {signal}.', subject: 'He', verb: 'tell', vn: 'Anh ·∫•y n√≥i s·ª± th·∫≠t', type: 'affirm', emoji: 'üë¶‚úì' },
  { template: 'She ___ tell lies {signal}.', subject: 'She', verb: 'tell', vn: 'C√¥ ·∫•y kh√¥ng n√≥i d·ªëi', type: 'negative', emoji: 'üëßüö´ü§•' },
  { template: 'Did you ___ her {signal}?', subject: 'you', verb: 'tell', vn: 'B·∫°n c√≥ n√≥i v·ªõi c√¥ ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëß' },

  // PUT (ƒë·∫∑t, ƒë·ªÉ)
  { template: 'I ___ my bag on the chair {signal}.', subject: 'I', verb: 'put', vn: 'T√¥i ƒë·∫∑t c·∫∑p l√™n gh·∫ø', type: 'affirm', emoji: 'üßëüéíü™ë' },
  { template: 'She ___ the book on the table {signal}.', subject: 'She', verb: 'put', vn: 'C√¥ ·∫•y ƒë·∫∑t s√°ch l√™n b√†n', type: 'affirm', emoji: 'üëßüìöü™ë' },
  { template: 'He ___ put his toys away {signal}.', subject: 'He', verb: 'put', vn: 'Anh ·∫•y kh√¥ng c·∫•t ƒë·ªì ch∆°i', type: 'negative', emoji: 'üë¶üö´üß∏' },
  { template: 'Did you ___ it here {signal}?', subject: 'you', verb: 'put', vn: 'B·∫°n c√≥ ƒë·ªÉ n√≥ ·ªü ƒë√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìç' },

  // SEND (g·ª≠i)
  { template: 'I ___ an email {signal}.', subject: 'I', verb: 'send', vn: 'T√¥i g·ª≠i email', type: 'affirm', emoji: 'üßëüìß' },
  { template: 'She ___ a letter {signal}.', subject: 'She', verb: 'send', vn: 'C√¥ ·∫•y g·ª≠i th∆∞', type: 'affirm', emoji: 'üëß‚úâÔ∏è' },
  { template: 'He ___ send a message {signal}.', subject: 'He', verb: 'send', vn: 'Anh ·∫•y kh√¥ng g·ª≠i tin nh·∫Øn', type: 'negative', emoji: 'üë¶üö´üí¨' },
  { template: 'Did you ___ the package {signal}?', subject: 'you', verb: 'send', vn: 'B·∫°n c√≥ g·ª≠i g√≥i h√†ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüì¶' },

  // LEAVE (r·ªùi ƒëi, ƒë·ªÉ l·∫°i)
  { template: 'I ___ home at 7 AM {signal}.', subject: 'I', verb: 'leave', vn: 'T√¥i r·ªùi nh√† l√∫c 7 gi·ªù', type: 'affirm', emoji: 'üßëüè†‚è∞' },
  { template: 'She ___ her bag at school {signal}.', subject: 'She', verb: 'leave', vn: 'C√¥ ·∫•y ƒë·ªÉ c·∫∑p ·ªü tr∆∞·ªùng', type: 'affirm', emoji: 'üëßüéíüè´' },
  { template: 'He ___ leave early {signal}.', subject: 'He', verb: 'leave', vn: 'Anh ·∫•y kh√¥ng r·ªùi ƒëi s·ªõm', type: 'negative', emoji: 'üë¶üö´üö™' },
  { template: 'Did you ___ the door open {signal}?', subject: 'you', verb: 'leave', vn: 'B·∫°n c√≥ ƒë·ªÉ c·ª≠a m·ªü kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüö™' },

  // === NH√ìM 2: R·∫§T PH·ªî BI·∫æN ===

  // STAND (ƒë·ª©ng)
  { template: 'I ___ in line {signal}.', subject: 'I', verb: 'stand', vn: 'T√¥i ƒë·ª©ng x·∫øp h√†ng', type: 'affirm', emoji: 'üßëüßç' },
  { template: 'She ___ near the window {signal}.', subject: 'She', verb: 'stand', vn: 'C√¥ ·∫•y ƒë·ª©ng g·∫ßn c·ª≠a s·ªï', type: 'affirm', emoji: 'üëßü™ü' },
  { template: 'He ___ stand up {signal}.', subject: 'He', verb: 'stand', vn: 'Anh ·∫•y kh√¥ng ƒë·ª©ng d·∫≠y', type: 'negative', emoji: 'üë¶üö´üßç' },
  { template: 'Did she ___ there {signal}?', subject: 'she', verb: 'stand', vn: 'C√¥ ·∫•y c√≥ ƒë·ª©ng ·ªü ƒë√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüìç' },

  // SIT (ng·ªìi)
  { template: 'I ___ on the sofa {signal}.', subject: 'I', verb: 'sit', vn: 'T√¥i ng·ªìi tr√™n gh·∫ø sofa', type: 'affirm', emoji: 'üßëüõãÔ∏è' },
  { template: 'She ___ next to me {signal}.', subject: 'She', verb: 'sit', vn: 'C√¥ ·∫•y ng·ªìi c·∫°nh t√¥i', type: 'affirm', emoji: 'üëßüßë' },
  { template: 'The cat ___ on the chair {signal}.', subject: 'The cat', verb: 'sit', vn: 'Con m√®o ng·ªìi tr√™n gh·∫ø', type: 'affirm', emoji: 'üê±ü™ë' },
  { template: 'He ___ sit down {signal}.', subject: 'He', verb: 'sit', vn: 'Anh ·∫•y kh√¥ng ng·ªìi xu·ªëng', type: 'negative', emoji: 'üë¶üö´ü™ë' },
  { template: 'Did you ___ here {signal}?', subject: 'you', verb: 'sit', vn: 'B·∫°n c√≥ ng·ªìi ·ªü ƒë√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü™ë' },

  // FALL (ng√£, r∆°i)
  { template: 'I ___ down {signal}.', subject: 'I', verb: 'fall', vn: 'T√¥i b·ªã ng√£', type: 'affirm', emoji: 'üßëüí•' },
  { template: 'The leaves ___ from the tree {signal}.', subject: 'The leaves', verb: 'fall', vn: 'L√° r∆°i t·ª´ c√¢y', type: 'affirm', emoji: 'üçÇüå≥' },
  { template: 'She ___ fall asleep {signal}.', subject: 'She', verb: 'fall', vn: 'C√¥ ·∫•y kh√¥ng ng·ªß thi·∫øp ƒëi', type: 'negative', emoji: 'üëßüö´üò¥' },
  { template: 'Did he ___ off the bike {signal}?', subject: 'he', verb: 'fall', vn: 'Anh ·∫•y c√≥ ng√£ xe kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üö≤' },

  // CATCH (b·∫Øt)
  { template: 'I ___ the ball {signal}.', subject: 'I', verb: 'catch', vn: 'T√¥i b·∫Øt b√≥ng', type: 'affirm', emoji: 'üßë‚öΩ' },
  { template: 'The cat ___ a mouse {signal}.', subject: 'The cat', verb: 'catch', vn: 'Con m√®o b·∫Øt chu·ªôt', type: 'affirm', emoji: 'üê±üê≠' },
  { template: 'He ___ catch the bus {signal}.', subject: 'He', verb: 'catch', vn: 'Anh ·∫•y kh√¥ng b·∫Øt k·ªãp xe bu√Ωt', type: 'negative', emoji: 'üë¶üö´üöå' },
  { template: 'Did you ___ a cold {signal}?', subject: 'you', verb: 'catch', vn: 'B·∫°n c√≥ b·ªã c·∫£m kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü§ß' },

  // BREAK (l√†m v·ª°)
  { template: 'I ___ the glass {signal}.', subject: 'I', verb: 'break', vn: 'T√¥i l√†m v·ª° ly', type: 'affirm', emoji: 'üßëü•õüíî' },
  { template: 'He ___ his toy {signal}.', subject: 'He', verb: 'break', vn: 'Anh ·∫•y l√†m h·ªèng ƒë·ªì ch∆°i', type: 'affirm', emoji: 'üë¶üß∏üíî' },
  { template: 'She ___ break the rules {signal}.', subject: 'She', verb: 'break', vn: 'C√¥ ·∫•y kh√¥ng ph√° lu·∫≠t', type: 'negative', emoji: 'üëßüö´üìú' },
  { template: 'Did you ___ it {signal}?', subject: 'you', verb: 'break', vn: 'B·∫°n c√≥ l√†m v·ª° n√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüíî' },

  // === NH√ìM 3: PH·ªî BI·∫æN ===

  // HOLD (c·∫ßm, gi·ªØ)
  { template: 'I ___ the baby {signal}.', subject: 'I', verb: 'hold', vn: 'T√¥i b·∫ø em b√©', type: 'affirm', emoji: 'üßëüë∂' },
  { template: 'She ___ my hand {signal}.', subject: 'She', verb: 'hold', vn: 'C√¥ ·∫•y n·∫Øm tay t√¥i', type: 'affirm', emoji: 'üëßü§ù' },
  { template: 'He ___ hold the door {signal}.', subject: 'He', verb: 'hold', vn: 'Anh ·∫•y kh√¥ng gi·ªØ c·ª≠a', type: 'negative', emoji: 'üë¶üö´üö™' },
  { template: 'Did you ___ it tight {signal}?', subject: 'you', verb: 'hold', vn: 'B·∫°n c√≥ gi·ªØ ch·∫∑t n√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úä' },

  // DRAW (v·∫Ω)
  { template: 'I ___ a picture {signal}.', subject: 'I', verb: 'draw', vn: 'T√¥i v·∫Ω m·ªôt b·ª©c tranh', type: 'affirm', emoji: 'üßëüé®' },
  { template: 'She ___ a cat {signal}.', subject: 'She', verb: 'draw', vn: 'C√¥ ·∫•y v·∫Ω con m√®o', type: 'affirm', emoji: 'üëßüê±' },
  { template: 'He ___ draw well {signal}.', subject: 'He', verb: 'draw', vn: 'Anh ·∫•y kh√¥ng v·∫Ω gi·ªèi', type: 'negative', emoji: 'üë¶üö´üé®' },
  { template: 'Did you ___ this {signal}?', subject: 'you', verb: 'draw', vn: 'B·∫°n c√≥ v·∫Ω c√°i n√†y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüñºÔ∏è' },

  // THROW (n√©m)
  { template: 'I ___ the ball {signal}.', subject: 'I', verb: 'throw', vn: 'T√¥i n√©m b√≥ng', type: 'affirm', emoji: 'üßë‚öæ' },
  { template: 'He ___ the trash away {signal}.', subject: 'He', verb: 'throw', vn: 'Anh ·∫•y v·ª©t r√°c', type: 'affirm', emoji: 'üë¶üóëÔ∏è' },
  { template: 'She ___ throw things {signal}.', subject: 'She', verb: 'throw', vn: 'C√¥ ·∫•y kh√¥ng n√©m ƒë·ªì', type: 'negative', emoji: 'üëßüö´' },
  { template: 'Did you ___ it away {signal}?', subject: 'you', verb: 'throw', vn: 'B·∫°n c√≥ v·ª©t n√≥ ƒëi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüóëÔ∏è' },

  // FLY (bay)
  { template: 'Birds ___ in the sky {signal}.', subject: 'Birds', verb: 'fly', vn: 'Chim bay tr√™n tr·ªùi', type: 'affirm', emoji: 'üê¶‚òÅÔ∏è' },
  { template: 'The plane ___ to Paris {signal}.', subject: 'The plane', verb: 'fly', vn: 'M√°y bay bay t·ªõi Paris', type: 'affirm', emoji: '‚úàÔ∏èüóº' },
  { template: 'Penguins ___ fly {signal}.', subject: 'Penguins', verb: 'fly', vn: 'Chim c√°nh c·ª•t kh√¥ng bay', type: 'negative', emoji: 'üêßüö´' },
  { template: 'Did the bird ___ away {signal}?', subject: 'the bird', verb: 'fly', vn: 'Con chim c√≥ bay ƒëi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüê¶' },

  // GROW (l·ªõn l√™n, tr·ªìng)
  { template: 'The tree ___ fast {signal}.', subject: 'The tree', verb: 'grow', vn: 'C√¢y m·ªçc nhanh', type: 'affirm', emoji: 'üå≥üìà' },
  { template: 'I ___ vegetables {signal}.', subject: 'I', verb: 'grow', vn: 'T√¥i tr·ªìng rau', type: 'affirm', emoji: 'üßëü•¨' },
  { template: 'The flower ___ grow in winter {signal}.', subject: 'The flower', verb: 'grow', vn: 'Hoa kh√¥ng m·ªçc v√†o m√πa ƒë√¥ng', type: 'negative', emoji: 'üå∏üö´‚ùÑÔ∏è' },
  { template: 'Did the plant ___ well {signal}?', subject: 'the plant', verb: 'grow', vn: 'C√¢y c√≥ m·ªçc t·ªët kh√¥ng?', type: 'question_verb', emoji: '‚ùìüå±' },

  // SPEND (ti√™u, d√†nh th·ªùi gian)
  { template: 'I ___ money on books {signal}.', subject: 'I', verb: 'spend', vn: 'T√¥i ti√™u ti·ªÅn mua s√°ch', type: 'affirm', emoji: 'üßëüí∞üìö' },
  { template: 'She ___ time with her family {signal}.', subject: 'She', verb: 'spend', vn: 'C√¥ ·∫•y d√†nh th·ªùi gian v·ªõi gia ƒë√¨nh', type: 'affirm', emoji: 'üëßüë®‚Äçüë©‚Äçüëß' },
  { template: 'He ___ spend too much {signal}.', subject: 'He', verb: 'spend', vn: 'Anh ·∫•y kh√¥ng ti√™u qu√° nhi·ªÅu', type: 'negative', emoji: 'üë¶üö´üí∏' },
  { template: 'Did you ___ all your money {signal}?', subject: 'you', verb: 'spend', vn: 'B·∫°n c√≥ ti√™u h·∫øt ti·ªÅn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí∞' },

  // PAY (tr·∫£ ti·ªÅn)
  { template: 'I ___ for the ticket {signal}.', subject: 'I', verb: 'pay', vn: 'T√¥i tr·∫£ ti·ªÅn v√©', type: 'affirm', emoji: 'üßëüé´üíµ' },
  { template: 'She ___ the bill {signal}.', subject: 'She', verb: 'pay', vn: 'C√¥ ·∫•y tr·∫£ h√≥a ƒë∆°n', type: 'affirm', emoji: 'üëßüßæ' },
  { template: 'He ___ pay attention {signal}.', subject: 'He', verb: 'pay', vn: 'Anh ·∫•y kh√¥ng ch√∫ √Ω', type: 'negative', emoji: 'üë¶üö´üëÄ' },
  { template: 'Did you ___ him {signal}?', subject: 'you', verb: 'pay', vn: 'B·∫°n c√≥ tr·∫£ ti·ªÅn cho anh ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüíµ' },

  // SELL (b√°n)
  { template: 'I ___ my old phone {signal}.', subject: 'I', verb: 'sell', vn: 'T√¥i b√°n ƒëi·ªán tho·∫°i c≈©', type: 'affirm', emoji: 'üßëüì±üíµ' },
  { template: 'She ___ cookies {signal}.', subject: 'She', verb: 'sell', vn: 'C√¥ ·∫•y b√°n b√°nh quy', type: 'affirm', emoji: 'üëßüç™' },
  { template: 'He ___ sell his car {signal}.', subject: 'He', verb: 'sell', vn: 'Anh ·∫•y kh√¥ng b√°n xe', type: 'negative', emoji: 'üë¶üö´üöó' },
  { template: 'Did they ___ everything {signal}?', subject: 'they', verb: 'sell', vn: 'H·ªç c√≥ b√°n h·∫øt kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚ÄçüëßüíØ' },

  // BUILD (x√¢y)
  { template: 'I ___ a house {signal}.', subject: 'I', verb: 'build', vn: 'T√¥i x√¢y nh√†', type: 'affirm', emoji: 'üßëüè†' },
  { template: 'He ___ a robot {signal}.', subject: 'He', verb: 'build', vn: 'Anh ·∫•y l·∫Øp robot', type: 'affirm', emoji: 'üë¶ü§ñ' },
  { template: 'They ___ build a bridge {signal}.', subject: 'They', verb: 'build', vn: 'H·ªç kh√¥ng x√¢y c·∫ßu', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üåâ' },
  { template: 'Did you ___ it yourself {signal}?', subject: 'you', verb: 'build', vn: 'B·∫°n c√≥ t·ª± x√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüîß' },

  // CUT (c·∫Øt)
  { template: 'I ___ the paper {signal}.', subject: 'I', verb: 'cut', vn: 'T√¥i c·∫Øt gi·∫•y', type: 'affirm', emoji: 'üßëüìÑ‚úÇÔ∏è' },
  { template: 'She ___ her hair {signal}.', subject: 'She', verb: 'cut', vn: 'C√¥ ·∫•y c·∫Øt t√≥c', type: 'affirm', emoji: 'üëßüíá' },
  { template: 'He ___ cut the cake {signal}.', subject: 'He', verb: 'cut', vn: 'Anh ·∫•y kh√¥ng c·∫Øt b√°nh', type: 'negative', emoji: 'üë¶üö´üéÇ' },
  { template: 'Did you ___ it {signal}?', subject: 'you', verb: 'cut', vn: 'B·∫°n c√≥ c·∫Øt n√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úÇÔ∏è' },

  // FORGET (qu√™n)
  { template: 'I ___ my homework {signal}.', subject: 'I', verb: 'forget', vn: 'T√¥i qu√™n b√†i t·∫≠p', type: 'affirm', emoji: 'üßëüìù‚ùì' },
  { template: 'She ___ her keys {signal}.', subject: 'She', verb: 'forget', vn: 'C√¥ ·∫•y qu√™n ch√¨a kh√≥a', type: 'affirm', emoji: 'üëßüîë‚ùì' },
  { template: 'He ___ forget her birthday {signal}.', subject: 'He', verb: 'forget', vn: 'Anh ·∫•y kh√¥ng qu√™n sinh nh·∫≠t c√¥ ·∫•y', type: 'negative', emoji: 'üë¶üö´üéÇ' },
  { template: 'Did you ___ to call {signal}?', subject: 'you', verb: 'forget', vn: 'B·∫°n c√≥ qu√™n g·ªçi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìû' },

  // CHOOSE (ch·ªçn)
  { template: 'I ___ the red one {signal}.', subject: 'I', verb: 'choose', vn: 'T√¥i ch·ªçn c√°i m√†u ƒë·ªè', type: 'affirm', emoji: 'üßëüî¥' },
  { template: 'She ___ a new dress {signal}.', subject: 'She', verb: 'choose', vn: 'C√¥ ·∫•y ch·ªçn v√°y m·ªõi', type: 'affirm', emoji: 'üëßüëó' },
  { template: 'He ___ choose wisely {signal}.', subject: 'He', verb: 'choose', vn: 'Anh ·∫•y kh√¥ng ch·ªçn kh√¥n ngoan', type: 'negative', emoji: 'üë¶üö´ü§î' },
  { template: 'Did you ___ already {signal}?', subject: 'you', verb: 'choose', vn: 'B·∫°n c√≥ ch·ªçn r·ªìi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úì' },

  // DRIVE (l√°i xe)
  { template: 'Dad ___ to work {signal}.', subject: 'Dad', verb: 'drive', vn: 'B·ªë l√°i xe ƒëi l√†m', type: 'affirm', emoji: 'üë®üöóüíº' },
  { template: 'She ___ a bus {signal}.', subject: 'She', verb: 'drive', vn: 'C√¥ ·∫•y l√°i xe bu√Ωt', type: 'affirm', emoji: 'üë©üöå' },
  { template: 'I ___ drive fast {signal}.', subject: 'I', verb: 'drive', vn: 'T√¥i kh√¥ng l√°i nhanh', type: 'negative', emoji: 'üßëüö´üèéÔ∏è' },
  { template: 'Did he ___ you home {signal}?', subject: 'he', verb: 'drive', vn: 'Anh ·∫•y c√≥ ch·ªü b·∫°n v·ªÅ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üöóüè†' },

  // KEEP (gi·ªØ)
  { template: 'I ___ my promise {signal}.', subject: 'I', verb: 'keep', vn: 'T√¥i gi·ªØ l·ªùi h·ª©a', type: 'affirm', emoji: 'üßëü§ù' },
  { template: 'She ___ a diary {signal}.', subject: 'She', verb: 'keep', vn: 'C√¥ ·∫•y vi·∫øt nh·∫≠t k√Ω', type: 'affirm', emoji: 'üëßüìî' },
  { template: 'He ___ keep secrets {signal}.', subject: 'He', verb: 'keep', vn: 'Anh ·∫•y kh√¥ng gi·ªØ b√≠ m·∫≠t', type: 'negative', emoji: 'üë¶üö´ü§´' },
  { template: 'Did you ___ it safe {signal}?', subject: 'you', verb: 'keep', vn: 'B·∫°n c√≥ gi·ªØ n√≥ an to√†n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüîí' },

  // WAKE (th·ª©c d·∫≠y)
  { template: 'I ___ up early {signal}.', subject: 'I', verb: 'wake', vn: 'T√¥i th·ª©c d·∫≠y s·ªõm', type: 'affirm', emoji: 'üßë‚è∞‚òÄÔ∏è' },
  { template: 'She ___ up at 6 AM {signal}.', subject: 'She', verb: 'wake', vn: 'C√¥ ·∫•y th·ª©c d·∫≠y l√∫c 6 gi·ªù', type: 'affirm', emoji: 'üëßüåÖ' },
  { template: 'He ___ wake up late {signal}.', subject: 'He', verb: 'wake', vn: 'Anh ·∫•y kh√¥ng d·∫≠y mu·ªôn', type: 'negative', emoji: 'üë¶üö´üò¥' },
  { template: 'Did the alarm ___ you up {signal}?', subject: 'the alarm', verb: 'wake', vn: 'ƒê·ªìng h·ªì b√°o c√≥ ƒë√°nh th·ª©c b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùì‚è∞üßë' },

  // UNDERSTAND (hi·ªÉu)
  { template: 'I ___ the lesson {signal}.', subject: 'I', verb: 'understand', vn: 'T√¥i hi·ªÉu b√†i', type: 'affirm', emoji: 'üßëüí°' },
  { template: 'She ___ English {signal}.', subject: 'She', verb: 'understand', vn: 'C√¥ ·∫•y hi·ªÉu ti·∫øng Anh', type: 'affirm', emoji: 'üëßüá¨üáß' },
  { template: 'He ___ understand math {signal}.', subject: 'He', verb: 'understand', vn: 'Anh ·∫•y kh√¥ng hi·ªÉu to√°n', type: 'negative', emoji: 'üë¶üö´üî¢' },
  { template: 'Did you ___ me {signal}?', subject: 'you', verb: 'understand', vn: 'B·∫°n c√≥ hi·ªÉu t√¥i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëÇ' },

  // HEAR (nghe th·∫•y)
  { template: 'I ___ a noise {signal}.', subject: 'I', verb: 'hear', vn: 'T√¥i nghe th·∫•y ti·∫øng ƒë·ªông', type: 'affirm', emoji: 'üßëüëÇüîä' },
  { template: 'She ___ the music {signal}.', subject: 'She', verb: 'hear', vn: 'C√¥ ·∫•y nghe th·∫•y nh·∫°c', type: 'affirm', emoji: 'üëßüéµ' },
  { template: 'He ___ hear anything {signal}.', subject: 'He', verb: 'hear', vn: 'Anh ·∫•y kh√¥ng nghe th·∫•y g√¨', type: 'negative', emoji: 'üë¶üö´üëÇ' },
  { template: 'Did you ___ that {signal}?', subject: 'you', verb: 'hear', vn: 'B·∫°n c√≥ nghe th·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëÇ' },

  // BEGIN (b·∫Øt ƒë·∫ßu)
  { template: 'The class ___ at 8 AM {signal}.', subject: 'The class', verb: 'begin', vn: 'L·ªõp h·ªçc b·∫Øt ƒë·∫ßu l√∫c 8 gi·ªù', type: 'affirm', emoji: 'üìö‚è∞' },
  { template: 'The movie ___ now {signal}.', subject: 'The movie', verb: 'begin', vn: 'Phim b·∫Øt ƒë·∫ßu b√¢y gi·ªù', type: 'affirm', emoji: 'üé¨‚ñ∂Ô∏è' },
  { template: 'The show ___ begin yet {signal}.', subject: 'The show', verb: 'begin', vn: 'Ch∆∞∆°ng tr√¨nh ch∆∞a b·∫Øt ƒë·∫ßu', type: 'negative', emoji: 'üì∫üö´' },
  { template: 'Did the game ___ {signal}?', subject: 'the game', verb: 'begin', vn: 'Tr·∫≠n ƒë·∫•u c√≥ b·∫Øt ƒë·∫ßu ch∆∞a?', type: 'question_verb', emoji: '‚ùìüéÆ‚ñ∂Ô∏è' },

  // BITE (c·∫Øn)
  { template: 'The dog ___ me {signal}.', subject: 'The dog', verb: 'bite', vn: 'Con ch√≥ c·∫Øn t√¥i', type: 'affirm', emoji: 'üêïüò¨' },
  { template: 'The mosquito ___ her {signal}.', subject: 'The mosquito', verb: 'bite', vn: 'Con mu·ªói ƒë·ªët c√¥ ·∫•y', type: 'affirm', emoji: 'ü¶üüëß' },
  { template: 'My dog ___ bite people {signal}.', subject: 'My dog', verb: 'bite', vn: 'Ch√≥ c·ªßa t√¥i kh√¥ng c·∫Øn ng∆∞·ªùi', type: 'negative', emoji: 'üêïüö´' },
  { template: 'Did it ___ you {signal}?', subject: 'it', verb: 'bite', vn: 'N√≥ c√≥ c·∫Øn b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüò¨' },

  // RIDE (c∆∞·ª°i, ƒëi xe)
  { template: 'I ___ a bike {signal}.', subject: 'I', verb: 'ride', vn: 'T√¥i ƒë·∫°p xe', type: 'affirm', emoji: 'üßëüö≤' },
  { template: 'She ___ a horse {signal}.', subject: 'She', verb: 'ride', vn: 'C√¥ ·∫•y c∆∞·ª°i ng·ª±a', type: 'affirm', emoji: 'üëßüêé' },
  { template: 'He ___ ride without a helmet {signal}.', subject: 'He', verb: 'ride', vn: 'Anh ·∫•y kh√¥ng ƒëi xe kh√¥ng m≈©', type: 'negative', emoji: 'üë¶üö´‚õëÔ∏è' },
  { template: 'Did you ___ a motorcycle {signal}?', subject: 'you', verb: 'ride', vn: 'B·∫°n c√≥ ƒëi xe m√°y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèçÔ∏è' },

  // SHAKE (l·∫Øc)
  { template: 'I ___ hands with him {signal}.', subject: 'I', verb: 'shake', vn: 'T√¥i b·∫Øt tay anh ·∫•y', type: 'affirm', emoji: 'üßëü§ù' },
  { template: 'The earthquake ___ the building {signal}.', subject: 'The earthquake', verb: 'shake', vn: 'ƒê·ªông ƒë·∫•t l√†m rung t√≤a nh√†', type: 'affirm', emoji: 'üåçüè¢' },
  { template: 'She ___ shake the bottle {signal}.', subject: 'She', verb: 'shake', vn: 'C√¥ ·∫•y kh√¥ng l·∫Øc chai', type: 'negative', emoji: 'üëßüö´üçº' },
  { template: 'Did you ___ the tree {signal}?', subject: 'you', verb: 'shake', vn: 'B·∫°n c√≥ l·∫Øc c√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüå≥' },

  // HIDE (gi·∫•u, tr·ªën)
  { template: 'I ___ under the bed {signal}.', subject: 'I', verb: 'hide', vn: 'T√¥i tr·ªën d∆∞·ªõi gi∆∞·ªùng', type: 'affirm', emoji: 'üßëüõèÔ∏è' },
  { template: 'She ___ her diary {signal}.', subject: 'She', verb: 'hide', vn: 'C√¥ ·∫•y gi·∫•u nh·∫≠t k√Ω', type: 'affirm', emoji: 'üëßüìîüîí' },
  { template: 'He ___ hide anything {signal}.', subject: 'He', verb: 'hide', vn: 'Anh ·∫•y kh√¥ng gi·∫•u g√¨', type: 'negative', emoji: 'üë¶üö´' },
  { template: 'Did they ___ the treasure {signal}?', subject: 'they', verb: 'hide', vn: 'H·ªç c√≥ gi·∫•u kho b√°u kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüíé' },

  // HURT (l√†m ƒëau)
  { template: 'I ___ my leg {signal}.', subject: 'I', verb: 'hurt', vn: 'T√¥i b·ªã ƒëau ch√¢n', type: 'affirm', emoji: 'üßëü¶µüò£' },
  { template: 'She ___ her arm {signal}.', subject: 'She', verb: 'hurt', vn: 'C√¥ ·∫•y b·ªã ƒëau tay', type: 'affirm', emoji: 'üëßüí™üò£' },
  { template: 'I ___ hurt anyone {signal}.', subject: 'I', verb: 'hurt', vn: 'T√¥i kh√¥ng l√†m ƒëau ai', type: 'negative', emoji: 'üßëüö´' },
  { template: 'Did it ___ {signal}?', subject: 'it', verb: 'hurt', vn: 'N√≥ c√≥ ƒëau kh√¥ng?', type: 'question_verb', emoji: '‚ùìüò£' },

  // COST (t·ªën, gi√°)
  { template: 'The book ___ $10 {signal}.', subject: 'The book', verb: 'cost', vn: 'Cu·ªën s√°ch gi√° 10 ƒë√¥', type: 'affirm', emoji: 'üìöüíµ' },
  { template: 'The trip ___ a lot of money {signal}.', subject: 'The trip', verb: 'cost', vn: 'Chuy·∫øn ƒëi t·ªën nhi·ªÅu ti·ªÅn', type: 'affirm', emoji: '‚úàÔ∏èüí∞' },
  { template: 'It ___ cost much {signal}.', subject: 'It', verb: 'cost', vn: 'N√≥ kh√¥ng t·ªën nhi·ªÅu', type: 'negative', emoji: 'üö´üí∏' },
  { template: 'How much did it ___ {signal}?', subject: 'it', verb: 'cost', vn: 'N√≥ gi√° bao nhi√™u?', type: 'question_verb', emoji: '‚ùìüíµ' },

  // FEED (cho ƒÉn)
  { template: 'I ___ the dog {signal}.', subject: 'I', verb: 'feed', vn: 'T√¥i cho ch√≥ ƒÉn', type: 'affirm', emoji: 'üßëüêïüçñ' },
  { template: 'She ___ the cat {signal}.', subject: 'She', verb: 'feed', vn: 'C√¥ ·∫•y cho m√®o ƒÉn', type: 'affirm', emoji: 'üëßüê±üêü' },
  { template: 'He ___ feed the birds {signal}.', subject: 'He', verb: 'feed', vn: 'Anh ·∫•y kh√¥ng cho chim ƒÉn', type: 'negative', emoji: 'üë¶üö´üê¶' },
  { template: 'Did you ___ the fish {signal}?', subject: 'you', verb: 'feed', vn: 'B·∫°n c√≥ cho c√° ƒÉn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüêü' },

  // LET (cho ph√©p)
  { template: 'Mom ___ me go out {signal}.', subject: 'Mom', verb: 'let', vn: 'M·∫π cho t√¥i ra ngo√†i', type: 'affirm', emoji: 'üë©üßëüö™' },
  { template: 'She ___ him play {signal}.', subject: 'She', verb: 'let', vn: 'C√¥ ·∫•y cho anh ·∫•y ch∆°i', type: 'affirm', emoji: 'üëßüë¶üéÆ' },
  { template: 'Dad ___ let me stay up late {signal}.', subject: 'Dad', verb: 'let', vn: 'B·ªë kh√¥ng cho t√¥i th·ª©c khuya', type: 'negative', emoji: 'üë®üö´üåô' },
  { template: 'Did she ___ you in {signal}?', subject: 'she', verb: 'let', vn: 'C√¥ ·∫•y c√≥ cho b·∫°n v√†o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüö™' },

  // MEAN (c√≥ nghƒ©a l√†)
  { template: 'This word ___ "happy" {signal}.', subject: 'This word', verb: 'mean', vn: 'T·ª´ n√†y c√≥ nghƒ©a l√† "vui"', type: 'affirm', emoji: 'üìùüòä' },
  { template: 'I ___ what I said {signal}.', subject: 'I', verb: 'mean', vn: 'T√¥i n√≥i th·∫≠t l√≤ng', type: 'affirm', emoji: 'üßëüí¨' },
  { template: 'I ___ mean to hurt you {signal}.', subject: 'I', verb: 'mean', vn: 'T√¥i kh√¥ng c·ªë √Ω l√†m b·∫°n ƒëau', type: 'negative', emoji: 'üßëüö´üò¢' },
  { template: 'What did you ___ {signal}?', subject: 'you', verb: 'mean', vn: 'B·∫°n mu·ªën n√≥i g√¨?', type: 'question_verb', emoji: '‚ùìüßë‚ùî' },

  // LEARN (h·ªçc)
  { template: 'I ___ English {signal}.', subject: 'I', verb: 'learn', vn: 'T√¥i h·ªçc ti·∫øng Anh', type: 'affirm', emoji: 'üßëüá¨üáß' },
  { template: 'She ___ to swim {signal}.', subject: 'She', verb: 'learn', vn: 'C√¥ ·∫•y h·ªçc b∆°i', type: 'affirm', emoji: 'üëßüèä' },
  { template: 'He ___ learn quickly {signal}.', subject: 'He', verb: 'learn', vn: 'Anh ·∫•y kh√¥ng h·ªçc nhanh', type: 'negative', emoji: 'üë¶üö´üìö' },
  { template: 'Did you ___ something new {signal}?', subject: 'you', verb: 'learn', vn: 'B·∫°n c√≥ h·ªçc ƒë∆∞·ª£c g√¨ m·ªõi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí°' },

  // =============== B·ªî SUNG ƒê·ª¶ 93 ƒê·ªòNG T·ª™ ===============

  // BE (l√†, ·ªü) - ƒê√É LO·∫†I B·ªé v√¨ qu√° ƒë·∫∑c bi·ªát (am/is/are/was/were), d·∫°y ri√™ng trong ph·∫ßn h·ªçc

  // BECOME (tr·ªü th√†nh)
  { template: 'He ___ a doctor {signal}.', subject: 'He', verb: 'become', vn: 'Anh ·∫•y tr·ªü th√†nh b√°c sƒ©', type: 'affirm', emoji: 'üë¶üë®‚Äç‚öïÔ∏è' },
  { template: 'She ___ famous {signal}.', subject: 'She', verb: 'become', vn: 'C√¥ ·∫•y tr·ªü n√™n n·ªïi ti·∫øng', type: 'affirm', emoji: 'üëß‚≠ê' },
  { template: 'I ___ become angry {signal}.', subject: 'I', verb: 'become', vn: 'T√¥i kh√¥ng tr·ªü n√™n t·ª©c gi·∫≠n', type: 'negative', emoji: 'üßëüö´üò†' },
  { template: 'Did he ___ a teacher {signal}?', subject: 'he', verb: 'become', vn: 'Anh ·∫•y c√≥ tr·ªü th√†nh gi√°o vi√™n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üë®‚Äçüè´' },

  // BLEED (ch·∫£y m√°u)
  { template: 'My finger ___ {signal}.', subject: 'My finger', verb: 'bleed', vn: 'Ng√≥n tay t√¥i ch·∫£y m√°u', type: 'affirm', emoji: 'ü©∏üëÜ' },
  { template: 'His nose ___ {signal}.', subject: 'His nose', verb: 'bleed', vn: 'M≈©i anh ·∫•y ch·∫£y m√°u', type: 'affirm', emoji: 'üëÉü©∏' },
  { template: 'The wound ___ bleed anymore {signal}.', subject: 'The wound', verb: 'bleed', vn: 'V·∫øt th∆∞∆°ng kh√¥ng ch·∫£y m√°u n·ªØa', type: 'negative', emoji: 'ü©πüö´ü©∏' },
  { template: 'Did it ___ a lot {signal}?', subject: 'it', verb: 'bleed', vn: 'N√≥ c√≥ ch·∫£y m√°u nhi·ªÅu kh√¥ng?', type: 'question_verb', emoji: '‚ùìü©∏' },

  // BLOW (th·ªïi)
  { template: 'The wind ___ hard {signal}.', subject: 'The wind', verb: 'blow', vn: 'Gi√≥ th·ªïi m·∫°nh', type: 'affirm', emoji: 'üí®üå¨Ô∏è' },
  { template: 'She ___ out the candles {signal}.', subject: 'She', verb: 'blow', vn: 'C√¥ ·∫•y th·ªïi t·∫Øt n·∫øn', type: 'affirm', emoji: 'üëßüéÇüïØÔ∏è' },
  { template: 'I ___ blow bubbles {signal}.', subject: 'I', verb: 'blow', vn: 'T√¥i kh√¥ng th·ªïi bong b√≥ng', type: 'negative', emoji: 'üßëüö´ü´ß' },
  { template: 'Did the wind ___ your hat away {signal}?', subject: 'the wind', verb: 'blow', vn: 'Gi√≥ c√≥ th·ªïi bay m≈© kh√¥ng?', type: 'question_verb', emoji: '‚ùìüí®üé©' },

  // BURN (ƒë·ªët, ch√°y)
  { template: 'The fire ___ brightly {signal}.', subject: 'The fire', verb: 'burn', vn: 'L·ª≠a ch√°y s√°ng', type: 'affirm', emoji: 'üî•‚ú®' },
  { template: 'I ___ the toast {signal}.', subject: 'I', verb: 'burn', vn: 'T√¥i l√†m ch√°y b√°nh m√¨', type: 'affirm', emoji: 'üßëüçûüî•' },
  { template: 'She ___ burn the food {signal}.', subject: 'She', verb: 'burn', vn: 'C√¥ ·∫•y kh√¥ng l√†m ch√°y ƒë·ªì ƒÉn', type: 'negative', emoji: 'üëßüö´üî•' },
  { template: 'Did you ___ yourself {signal}?', subject: 'you', verb: 'burn', vn: 'B·∫°n c√≥ b·ªã b·ªèng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüî•' },

  // DREAM (m∆°)
  { template: 'I ___ about flying {signal}.', subject: 'I', verb: 'dream', vn: 'T√¥i m∆° v·ªÅ vi·ªác bay', type: 'affirm', emoji: 'üßëüí≠‚úàÔ∏è' },
  { template: 'She ___ of becoming a singer {signal}.', subject: 'She', verb: 'dream', vn: 'C√¥ ·∫•y m∆° tr·ªü th√†nh ca sƒ©', type: 'affirm', emoji: 'üëßüí≠üé§' },
  { template: 'He ___ dream last night {signal}.', subject: 'He', verb: 'dream', vn: 'Anh ·∫•y kh√¥ng m∆° t·ªëi qua', type: 'negative', emoji: 'üë¶üö´üí≠' },
  { template: 'Did you ___ about me {signal}?', subject: 'you', verb: 'dream', vn: 'B·∫°n c√≥ m∆° v·ªÅ t√¥i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí≠' },

  // FIGHT (ƒë√°nh nhau, chi·∫øn ƒë·∫•u)
  { template: 'The boys ___ at school {signal}.', subject: 'The boys', verb: 'fight', vn: 'C√°c c·∫≠u b√© ƒë√°nh nhau ·ªü tr∆∞·ªùng', type: 'affirm', emoji: 'üë¶üë¶üí•' },
  { template: 'They ___ for freedom {signal}.', subject: 'They', verb: 'fight', vn: 'H·ªç chi·∫øn ƒë·∫•u v√¨ t·ª± do', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚úä' },
  { template: 'I ___ fight with my sister {signal}.', subject: 'I', verb: 'fight', vn: 'T√¥i kh√¥ng c√£i nhau v·ªõi ch·ªã', type: 'negative', emoji: 'üßëüö´üëß' },
  { template: 'Did they ___ again {signal}?', subject: 'they', verb: 'fight', vn: 'H·ªç c√≥ ƒë√°nh nhau l·∫°i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üë¶' },

  // FORGIVE (tha th·ª©)
  { template: 'I ___ him {signal}.', subject: 'I', verb: 'forgive', vn: 'T√¥i tha th·ª© cho anh ·∫•y', type: 'affirm', emoji: 'üßëü§ùüë¶' },
  { template: 'She ___ her friend {signal}.', subject: 'She', verb: 'forgive', vn: 'C√¥ ·∫•y tha th·ª© cho b·∫°n', type: 'affirm', emoji: 'üëßü§ù' },
  { template: 'He ___ forgive easily {signal}.', subject: 'He', verb: 'forgive', vn: 'Anh ·∫•y kh√¥ng tha th·ª© d·ªÖ d√†ng', type: 'negative', emoji: 'üë¶üö´' },
  { template: 'Did she ___ you {signal}?', subject: 'she', verb: 'forgive', vn: 'C√¥ ·∫•y c√≥ tha th·ª© cho b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßü§ù' },

  // FREEZE (ƒë√¥ng l·∫°i)
  { template: 'Water ___ at 0¬∞C {signal}.', subject: 'Water', verb: 'freeze', vn: 'N∆∞·ªõc ƒë√≥ng bƒÉng ·ªü 0¬∞C', type: 'affirm', emoji: 'üíß‚ùÑÔ∏è' },
  { template: 'I ___ in the cold {signal}.', subject: 'I', verb: 'freeze', vn: 'T√¥i b·ªã l·∫°nh c√≥ng', type: 'affirm', emoji: 'üßëü•∂' },
  { template: 'The lake ___ freeze this winter {signal}.', subject: 'The lake', verb: 'freeze', vn: 'H·ªì kh√¥ng ƒë√≥ng bƒÉng m√πa ƒë√¥ng n√†y', type: 'negative', emoji: 'üèûÔ∏èüö´‚ùÑÔ∏è' },
  { template: 'Did the pipes ___ {signal}?', subject: 'the pipes', verb: 'freeze', vn: '·ªêng n∆∞·ªõc c√≥ b·ªã ƒë√≥ng bƒÉng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüö∞‚ùÑÔ∏è' },

  // HANG (treo)
  { template: 'I ___ the picture on the wall {signal}.', subject: 'I', verb: 'hang', vn: 'T√¥i treo tranh l√™n t∆∞·ªùng', type: 'affirm', emoji: 'üßëüñºÔ∏è' },
  { template: 'She ___ her coat {signal}.', subject: 'She', verb: 'hang', vn: 'C√¥ ·∫•y treo √°o kho√°c', type: 'affirm', emoji: 'üëßüß•' },
  { template: 'He ___ hang out with friends {signal}.', subject: 'He', verb: 'hang', vn: 'Anh ·∫•y kh√¥ng ƒëi ch∆°i v·ªõi b·∫°n', type: 'negative', emoji: 'üë¶üö´üë´' },
  { template: 'Did you ___ the clothes {signal}?', subject: 'you', verb: 'hang', vn: 'B·∫°n c√≥ ph∆°i qu·∫ßn √°o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëï' },

  // HIT (ƒë√°nh, va ch·∫°m)
  { template: 'The ball ___ the window {signal}.', subject: 'The ball', verb: 'hit', vn: 'B√≥ng va v√†o c·ª≠a s·ªï', type: 'affirm', emoji: '‚öΩü™ü' },
  { template: 'He ___ the ball hard {signal}.', subject: 'He', verb: 'hit', vn: 'Anh ·∫•y ƒë√°nh b√≥ng m·∫°nh', type: 'affirm', emoji: 'üë¶‚öæ' },
  { template: 'I ___ hit anyone {signal}.', subject: 'I', verb: 'hit', vn: 'T√¥i kh√¥ng ƒë√°nh ai', type: 'negative', emoji: 'üßëüö´üëä' },
  { template: 'Did the car ___ the tree {signal}?', subject: 'the car', verb: 'hit', vn: 'Xe c√≥ ƒë√¢m v√†o c√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüöóüå≥' },

  // LAY (ƒë·∫∑t, ƒë·ªÉ)
  { template: 'I ___ the book on the desk {signal}.', subject: 'I', verb: 'lay', vn: 'T√¥i ƒë·∫∑t s√°ch l√™n b√†n', type: 'affirm', emoji: 'üßëüìö' },
  { template: 'The hen ___ eggs {signal}.', subject: 'The hen', verb: 'lay', vn: 'Con g√† m√°i ƒë·∫ª tr·ª©ng', type: 'affirm', emoji: 'üêîü•ö' },
  { template: 'She ___ lay the table {signal}.', subject: 'She', verb: 'lay', vn: 'C√¥ ·∫•y kh√¥ng d·ªçn b√†n', type: 'negative', emoji: 'üëßüö´üçΩÔ∏è' },
  { template: 'Did you ___ the baby down {signal}?', subject: 'you', verb: 'lay', vn: 'B·∫°n c√≥ ƒë·∫∑t em b√© xu·ªëng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüë∂' },

  // LEND (cho m∆∞·ª£n)
  { template: 'I ___ him my bike {signal}.', subject: 'I', verb: 'lend', vn: 'T√¥i cho anh ·∫•y m∆∞·ª£n xe', type: 'affirm', emoji: 'üßëüö≤üë¶' },
  { template: 'She ___ me money {signal}.', subject: 'She', verb: 'lend', vn: 'C√¥ ·∫•y cho t√¥i m∆∞·ª£n ti·ªÅn', type: 'affirm', emoji: 'üëßüíµüßë' },
  { template: 'He ___ lend his phone {signal}.', subject: 'He', verb: 'lend', vn: 'Anh ·∫•y kh√¥ng cho m∆∞·ª£n ƒëi·ªán tho·∫°i', type: 'negative', emoji: 'üë¶üö´üì±' },
  { template: 'Did you ___ her your book {signal}?', subject: 'you', verb: 'lend', vn: 'B·∫°n c√≥ cho c√¥ ·∫•y m∆∞·ª£n s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìöüëß' },

  // LIE (n·∫±m)
  { template: 'I ___ on the bed {signal}.', subject: 'I', verb: 'lie', vn: 'T√¥i n·∫±m tr√™n gi∆∞·ªùng', type: 'affirm', emoji: 'üßëüõèÔ∏è' },
  { template: 'The cat ___ on the sofa {signal}.', subject: 'The cat', verb: 'lie', vn: 'Con m√®o n·∫±m tr√™n gh·∫ø sofa', type: 'affirm', emoji: 'üê±üõãÔ∏è' },
  { template: 'He ___ lie down {signal}.', subject: 'He', verb: 'lie', vn: 'Anh ·∫•y kh√¥ng n·∫±m xu·ªëng', type: 'negative', emoji: 'üë¶üö´üõèÔ∏è' },
  { template: 'Did she ___ on the grass {signal}?', subject: 'she', verb: 'lie', vn: 'C√¥ ·∫•y c√≥ n·∫±m tr√™n c·ªè kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüåø' },

  // LIGHT (th·∫Øp, b·∫≠t ƒë√®n)
  { template: 'I ___ the candle {signal}.', subject: 'I', verb: 'light', vn: 'T√¥i th·∫Øp n·∫øn', type: 'affirm', emoji: 'üßëüïØÔ∏è' },
  { template: 'She ___ the fire {signal}.', subject: 'She', verb: 'light', vn: 'C√¥ ·∫•y nh√≥m l·ª≠a', type: 'affirm', emoji: 'üëßüî•' },
  { template: 'He ___ light a match {signal}.', subject: 'He', verb: 'light', vn: 'Anh ·∫•y kh√¥ng ƒë·ªët di√™m', type: 'negative', emoji: 'üë¶üö´üî•' },
  { template: 'Did you ___ the lamp {signal}?', subject: 'you', verb: 'light', vn: 'B·∫°n c√≥ b·∫≠t ƒë√®n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí°' },

  // RING (reo, rung chu√¥ng)
  { template: 'The phone ___ {signal}.', subject: 'The phone', verb: 'ring', vn: 'ƒêi·ªán tho·∫°i reo', type: 'affirm', emoji: 'üì±üîî' },
  { template: 'The doorbell ___ {signal}.', subject: 'The doorbell', verb: 'ring', vn: 'Chu√¥ng c·ª≠a reo', type: 'affirm', emoji: 'üö™üîî' },
  { template: 'The alarm ___ ring this morning {signal}.', subject: 'The alarm', verb: 'ring', vn: 'ƒê·ªìng h·ªì b√°o kh√¥ng reo s√°ng nay', type: 'negative', emoji: '‚è∞üö´üîî' },
  { template: 'Did the bell ___ {signal}?', subject: 'the bell', verb: 'ring', vn: 'Chu√¥ng c√≥ reo kh√¥ng?', type: 'question_verb', emoji: '‚ùìüîî' },

  // RISE (m·ªçc l√™n, tƒÉng)
  { template: 'The sun ___ in the east {signal}.', subject: 'The sun', verb: 'rise', vn: 'M·∫∑t tr·ªùi m·ªçc ·ªü ph√≠a ƒë√¥ng', type: 'affirm', emoji: 'üåÖ‚òÄÔ∏è' },
  { template: 'Prices ___ every year {signal}.', subject: 'Prices', verb: 'rise', vn: 'Gi√° tƒÉng m·ªói nƒÉm', type: 'affirm', emoji: 'üíµüìà' },
  { template: 'The temperature ___ rise much {signal}.', subject: 'The temperature', verb: 'rise', vn: 'Nhi·ªát ƒë·ªô kh√¥ng tƒÉng nhi·ªÅu', type: 'negative', emoji: 'üå°Ô∏èüö´üìà' },
  { template: 'Did the water level ___ {signal}?', subject: 'the water level', verb: 'rise', vn: 'M·ª±c n∆∞·ªõc c√≥ tƒÉng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüíßüìà' },

  // SHINE (t·ªèa s√°ng)
  { template: 'The sun ___ brightly {signal}.', subject: 'The sun', verb: 'shine', vn: 'M·∫∑t tr·ªùi chi·∫øu s√°ng', type: 'affirm', emoji: '‚òÄÔ∏è‚ú®' },
  { template: 'The stars ___ at night {signal}.', subject: 'The stars', verb: 'shine', vn: 'Sao s√°ng v√†o ban ƒë√™m', type: 'affirm', emoji: '‚≠êüåô' },
  { template: 'The moon ___ shine tonight {signal}.', subject: 'The moon', verb: 'shine', vn: 'TrƒÉng kh√¥ng s√°ng t·ªëi nay', type: 'negative', emoji: 'üåôüö´‚ú®' },
  { template: 'Did the light ___ through the window {signal}?', subject: 'the light', verb: 'shine', vn: '√Ånh s√°ng c√≥ chi·∫øu qua c·ª≠a s·ªï kh√¥ng?', type: 'question_verb', emoji: '‚ùìüí°ü™ü' },

  // SHOOT (b·∫Øn)
  { template: 'He ___ the ball into the goal {signal}.', subject: 'He', verb: 'shoot', vn: 'Anh ·∫•y s√∫t b√≥ng v√†o g√¥n', type: 'affirm', emoji: 'üë¶‚öΩü•Ö' },
  { template: 'The hunter ___ the arrow {signal}.', subject: 'The hunter', verb: 'shoot', vn: 'Th·ª£ sƒÉn b·∫Øn m≈©i t√™n', type: 'affirm', emoji: 'üèπüéØ' },
  { template: 'I ___ shoot well {signal}.', subject: 'I', verb: 'shoot', vn: 'T√¥i kh√¥ng b·∫Øn gi·ªèi', type: 'negative', emoji: 'üßëüö´üéØ' },
  { template: 'Did he ___ the basket {signal}?', subject: 'he', verb: 'shoot', vn: 'Anh ·∫•y c√≥ n√©m r·ªï kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üèÄ' },

  // SHOW (cho xem, ch·ªâ)
  { template: 'I ___ him my photos {signal}.', subject: 'I', verb: 'show', vn: 'T√¥i cho anh ·∫•y xem ·∫£nh', type: 'affirm', emoji: 'üßëüì∏üë¶' },
  { template: 'She ___ me the way {signal}.', subject: 'She', verb: 'show', vn: 'C√¥ ·∫•y ch·ªâ ƒë∆∞·ªùng cho t√¥i', type: 'affirm', emoji: 'üëßüó∫Ô∏èüßë' },
  { template: 'He ___ show his feelings {signal}.', subject: 'He', verb: 'show', vn: 'Anh ·∫•y kh√¥ng b·ªôc l·ªô c·∫£m x√∫c', type: 'negative', emoji: 'üë¶üö´üò∂' },
  { template: 'Did you ___ her the gift {signal}?', subject: 'you', verb: 'show', vn: 'B·∫°n c√≥ cho c√¥ ·∫•y xem qu√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüéÅüëß' },

  // SHUT (ƒë√≥ng)
  { template: 'I ___ the door {signal}.', subject: 'I', verb: 'shut', vn: 'T√¥i ƒë√≥ng c·ª≠a', type: 'affirm', emoji: 'üßëüö™' },
  { template: 'She ___ the window {signal}.', subject: 'She', verb: 'shut', vn: 'C√¥ ·∫•y ƒë√≥ng c·ª≠a s·ªï', type: 'affirm', emoji: 'üëßü™ü' },
  { template: 'He ___ shut his eyes {signal}.', subject: 'He', verb: 'shut', vn: 'Anh ·∫•y kh√¥ng nh·∫Øm m·∫Øt', type: 'negative', emoji: 'üë¶üö´üëÄ' },
  { template: 'Did you ___ the gate {signal}?', subject: 'you', verb: 'shut', vn: 'B·∫°n c√≥ ƒë√≥ng c·ªïng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüöß' },

  // SMELL (ng·ª≠i, c√≥ m√πi)
  { template: 'The flower ___ nice {signal}.', subject: 'The flower', verb: 'smell', vn: 'Hoa c√≥ m√πi th∆°m', type: 'affirm', emoji: 'üå∏üëÉ' },
  { template: 'The food ___ delicious {signal}.', subject: 'The food', verb: 'smell', vn: 'ƒê·ªì ƒÉn c√≥ m√πi th∆°m ngon', type: 'affirm', emoji: 'üç≤üëÉ' },
  { template: 'The milk ___ smell good {signal}.', subject: 'The milk', verb: 'smell', vn: 'S·ªØa kh√¥ng c√≥ m√πi t·ªët', type: 'negative', emoji: 'ü•õüö´üëÉ' },
  { template: 'Did you ___ something burning {signal}?', subject: 'you', verb: 'smell', vn: 'B·∫°n c√≥ ng·ª≠i th·∫•y m√πi ch√°y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëÉüî•' },

  // SPELL (ƒë√°nh v·∫ßn)
  { template: 'I ___ my name {signal}.', subject: 'I', verb: 'spell', vn: 'T√¥i ƒë√°nh v·∫ßn t√™n', type: 'affirm', emoji: 'üßëüî§' },
  { template: 'She ___ the word correctly {signal}.', subject: 'She', verb: 'spell', vn: 'C√¥ ·∫•y ƒë√°nh v·∫ßn ƒë√∫ng', type: 'affirm', emoji: 'üëß‚úìüî§' },
  { template: 'He ___ spell that word {signal}.', subject: 'He', verb: 'spell', vn: 'Anh ·∫•y kh√¥ng ƒë√°nh v·∫ßn ƒë∆∞·ª£c t·ª´ ƒë√≥', type: 'negative', emoji: 'üë¶üö´üî§' },
  { template: 'Can you ___ this word {signal}?', subject: 'you', verb: 'spell', vn: 'B·∫°n c√≥ th·ªÉ ƒë√°nh v·∫ßn t·ª´ n√†y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüî§' },

  // STEAL (ƒÉn c·∫Øp)
  { template: 'Someone ___ my bike {signal}.', subject: 'Someone', verb: 'steal', vn: 'Ai ƒë√≥ ƒÉn c·∫Øp xe ƒë·∫°p c·ªßa t√¥i', type: 'affirm', emoji: 'üòàüö≤' },
  { template: 'The thief ___ the money {signal}.', subject: 'The thief', verb: 'steal', vn: 'T√™n tr·ªôm ƒÉn c·∫Øp ti·ªÅn', type: 'affirm', emoji: 'ü¶πüí∞' },
  { template: 'I ___ steal anything {signal}.', subject: 'I', verb: 'steal', vn: 'T√¥i kh√¥ng ƒÉn c·∫Øp g√¨', type: 'negative', emoji: 'üßëüö´' },
  { template: 'Did someone ___ your phone {signal}?', subject: 'someone', verb: 'steal', vn: 'C√≥ ai ƒÉn c·∫Øp ƒëi·ªán tho·∫°i c·ªßa b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüòàüì±' },

  // SWEEP (qu√©t)
  { template: 'I ___ the floor {signal}.', subject: 'I', verb: 'sweep', vn: 'T√¥i qu√©t nh√†', type: 'affirm', emoji: 'üßëüßπ' },
  { template: 'She ___ the room {signal}.', subject: 'She', verb: 'sweep', vn: 'C√¥ ·∫•y qu√©t ph√≤ng', type: 'affirm', emoji: 'üëßüßπ' },
  { template: 'He ___ sweep the yard {signal}.', subject: 'He', verb: 'sweep', vn: 'Anh ·∫•y kh√¥ng qu√©t s√¢n', type: 'negative', emoji: 'üë¶üö´üßπ' },
  { template: 'Did you ___ under the bed {signal}?', subject: 'you', verb: 'sweep', vn: 'B·∫°n c√≥ qu√©t d∆∞·ªõi gi∆∞·ªùng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüõèÔ∏èüßπ' },

  // SWING (ƒëu, ƒëong ƒë∆∞a)
  { template: 'The kids ___ in the park {signal}.', subject: 'The kids', verb: 'swing', vn: 'B·ªçn tr·∫ª ch∆°i x√≠ch ƒëu ·ªü c√¥ng vi√™n', type: 'affirm', emoji: 'üëßüë¶üé†' },
  { template: 'The monkey ___ from tree to tree {signal}.', subject: 'The monkey', verb: 'swing', vn: 'Con kh·ªâ ƒëu t·ª´ c√¢y n√†y sang c√¢y kia', type: 'affirm', emoji: 'üêíüå≥' },
  { template: 'I ___ swing high {signal}.', subject: 'I', verb: 'swing', vn: 'T√¥i kh√¥ng ƒëu cao', type: 'negative', emoji: 'üßëüö´üé†' },
  { template: 'Did the door ___ open {signal}?', subject: 'the door', verb: 'swing', vn: 'C·ª≠a c√≥ m·ªü ra kh√¥ng?', type: 'question_verb', emoji: '‚ùìüö™' },

  // === QUESTION TYPE: Do/Does/Did ___? ===
  { template: '___ he eat pizza {signal}?', subject: 'he', verb: 'eat', vn: 'Anh ·∫•y c√≥ ƒÉn pizza kh√¥ng?', type: 'question', emoji: '‚ùìüçï' },
  { template: '___ she go to school {signal}?', subject: 'she', verb: 'go', vn: 'C√¥ ·∫•y c√≥ ƒëi h·ªçc kh√¥ng?', type: 'question', emoji: '‚ùìüè´' },
  { template: '___ they drink milk {signal}?', subject: 'they', verb: 'drink', vn: 'H·ªç c√≥ u·ªëng s·ªØa kh√¥ng?', type: 'question', emoji: '‚ùìü•õ' },
  { template: '___ the dog run fast {signal}?', subject: 'the dog', verb: 'run', vn: 'Con ch√≥ c√≥ ch·∫°y nhanh kh√¥ng?', type: 'question', emoji: '‚ùìüêï' },
  { template: '___ you see that bird {signal}?', subject: 'you', verb: 'see', vn: 'B·∫°n c√≥ th·∫•y con chim kh√¥ng?', type: 'question', emoji: '‚ùìüê¶' },
  { template: '___ he break the window {signal}?', subject: 'he', verb: 'break', vn: 'Anh ·∫•y c√≥ v·ª° c·ª≠a s·ªï kh√¥ng?', type: 'question', emoji: '‚ùìü™ü' },
  { template: '___ she sing well {signal}?', subject: 'she', verb: 'sing', vn: 'C√¥ ·∫•y h√°t hay kh√¥ng?', type: 'question', emoji: '‚ùìüé§' },
  { template: '___ they swim in the lake {signal}?', subject: 'they', verb: 'swim', vn: 'H·ªç c√≥ b∆°i ·ªü h·ªì kh√¥ng?', type: 'question', emoji: '‚ùìüèä' },
  { template: '___ the cat steal the fish {signal}?', subject: 'the cat', verb: 'steal', vn: 'Con m√®o c√≥ ƒÉn c·∫Øp c√° kh√¥ng?', type: 'question', emoji: '‚ùìüê±üêü' },
  { template: '___ he fly the kite {signal}?', subject: 'he', verb: 'fly', vn: 'Anh ·∫•y c√≥ th·∫£ di·ªÅu kh√¥ng?', type: 'question', emoji: '‚ùìü™Å' },
  { template: '___ she write a letter {signal}?', subject: 'she', verb: 'write', vn: 'C√¥ ·∫•y c√≥ vi·∫øt th∆∞ kh√¥ng?', type: 'question', emoji: '‚ùì‚úâÔ∏è' },
  { template: '___ the baby sleep well {signal}?', subject: 'the baby', verb: 'sleep', vn: 'Em b√© c√≥ ng·ªß ngon kh√¥ng?', type: 'question', emoji: '‚ùìüë∂üí§' },
  { template: '___ you know the answer {signal}?', subject: 'you', verb: 'know', vn: 'B·∫°n c√≥ bi·∫øt ƒë√°p √°n kh√¥ng?', type: 'question', emoji: '‚ùìü§î' },
  { template: '___ he bring lunch {signal}?', subject: 'he', verb: 'bring', vn: 'Anh ·∫•y c√≥ mang c∆°m tr∆∞a kh√¥ng?', type: 'question', emoji: '‚ùìüç±' },
  { template: '___ she buy new shoes {signal}?', subject: 'she', verb: 'buy', vn: 'C√¥ ·∫•y c√≥ mua gi√†y m·ªõi kh√¥ng?', type: 'question', emoji: '‚ùìüëü' },
  { template: '___ the teacher give homework {signal}?', subject: 'the teacher', verb: 'give', vn: 'C√¥ gi√°o c√≥ cho b√†i t·∫≠p kh√¥ng?', type: 'question', emoji: '‚ùìüìù' },
  { template: '___ you catch the ball {signal}?', subject: 'you', verb: 'catch', vn: 'B·∫°n c√≥ b·∫Øt ƒë∆∞·ª£c b√≥ng kh√¥ng?', type: 'question', emoji: '‚ùì‚öæ' },
  { template: '___ he think about it {signal}?', subject: 'he', verb: 'think', vn: 'Anh ·∫•y c√≥ nghƒ© v·ªÅ n√≥ kh√¥ng?', type: 'question', emoji: '‚ùìüß†' },
  { template: '___ they build a sandcastle {signal}?', subject: 'they', verb: 'build', vn: 'H·ªç c√≥ x√¢y l√¢u ƒë√†i c√°t kh√¥ng?', type: 'question', emoji: '‚ùìüèñÔ∏è' },
  { template: '___ she draw a picture {signal}?', subject: 'she', verb: 'draw', vn: 'C√¥ ·∫•y c√≥ v·∫Ω tranh kh√¥ng?', type: 'question', emoji: '‚ùìüé®' },
  { template: '___ the plant grow fast {signal}?', subject: 'the plant', verb: 'grow', vn: 'C√¢y c√≥ m·ªçc nhanh kh√¥ng?', type: 'question', emoji: '‚ùìüå±' },
  { template: '___ he throw the ball {signal}?', subject: 'he', verb: 'throw', vn: 'Anh ·∫•y c√≥ n√©m b√≥ng kh√¥ng?', type: 'question', emoji: '‚ùìüèê' },
  { template: '___ you feel better {signal}?', subject: 'you', verb: 'feel', vn: 'B·∫°n c√≥ kh·ªèe h∆°n kh√¥ng?', type: 'question', emoji: '‚ùìü§í' },
  { template: '___ she keep her promise {signal}?', subject: 'she', verb: 'keep', vn: 'C√¥ ·∫•y c√≥ gi·ªØ l·ªùi h·ª©a kh√¥ng?', type: 'question', emoji: '‚ùìü§û' },
  { template: '___ he meet the new student {signal}?', subject: 'he', verb: 'meet', vn: 'Anh ·∫•y c√≥ g·∫∑p b·∫°n m·ªõi kh√¥ng?', type: 'question', emoji: '‚ùìü§ù' },
  { template: '___ you send the email {signal}?', subject: 'you', verb: 'send', vn: 'B·∫°n c√≥ g·ª≠i email kh√¥ng?', type: 'question', emoji: '‚ùìüìß' },
  { template: '___ she pay for the ticket {signal}?', subject: 'she', verb: 'pay', vn: 'C√¥ ·∫•y c√≥ tr·∫£ ti·ªÅn v√© kh√¥ng?', type: 'question', emoji: '‚ùìüéüÔ∏è' },
  { template: '___ he find his keys {signal}?', subject: 'he', verb: 'find', vn: 'Anh ·∫•y c√≥ t√¨m th·∫•y ch√¨a kh√≥a kh√¥ng?', type: 'question', emoji: '‚ùìüîë' },
  { template: '___ they win the game {signal}?', subject: 'they', verb: 'win', vn: 'H·ªç c√≥ th·∫Øng tr·∫≠n kh√¥ng?', type: 'question', emoji: '‚ùìüèÜ' },
  { template: '___ she wear a hat {signal}?', subject: 'she', verb: 'wear', vn: 'C√¥ ·∫•y c√≥ ƒë·ªôi m≈© kh√¥ng?', type: 'question', emoji: '‚ùìüé©' },
  { template: '___ he teach math {signal}?', subject: 'he', verb: 'teach', vn: 'Anh ·∫•y c√≥ d·∫°y to√°n kh√¥ng?', type: 'question', emoji: '‚ùìüìê' },
  { template: '___ the wind blow hard {signal}?', subject: 'the wind', verb: 'blow', vn: 'Gi√≥ c√≥ th·ªïi m·∫°nh kh√¥ng?', type: 'question', emoji: '‚ùìüí®' },
  { template: '___ you spend all your money {signal}?', subject: 'you', verb: 'spend', vn: 'B·∫°n c√≥ ti√™u h·∫øt ti·ªÅn kh√¥ng?', type: 'question', emoji: '‚ùìüí∏' },
  { template: '___ she tell the truth {signal}?', subject: 'she', verb: 'tell', vn: 'C√¥ ·∫•y c√≥ n√≥i s·ª± th·∫≠t kh√¥ng?', type: 'question', emoji: '‚ùìü§•' },
  { template: '___ the alarm ring {signal}?', subject: 'the alarm', verb: 'ring', vn: 'Chu√¥ng b√°o c√≥ reo kh√¥ng?', type: 'question', emoji: '‚ùì‚è∞' },
  { template: '___ he ride a bike {signal}?', subject: 'he', verb: 'ride', vn: 'Anh ·∫•y c√≥ ƒëi xe ƒë·∫°p kh√¥ng?', type: 'question', emoji: '‚ùìüö≤' },
  { template: '___ they fight {signal}?', subject: 'they', verb: 'fight', vn: 'H·ªç c√≥ ƒë√°nh nhau kh√¥ng?', type: 'question', emoji: '‚ùìü§úü§õ' },
  { template: '___ you hear that noise {signal}?', subject: 'you', verb: 'hear', vn: 'B·∫°n c√≥ nghe ti·∫øng ƒë√≥ kh√¥ng?', type: 'question', emoji: '‚ùìüëÇ' },
  { template: '___ she choose the red one {signal}?', subject: 'she', verb: 'choose', vn: 'C√¥ ·∫•y c√≥ ch·ªçn c√°i ƒë·ªè kh√¥ng?', type: 'question', emoji: '‚ùìüî¥' },
  { template: '___ he stand in the rain {signal}?', subject: 'he', verb: 'stand', vn: 'Anh ·∫•y c√≥ ƒë·ª©ng d∆∞·ªõi m∆∞a kh√¥ng?', type: 'question', emoji: '‚ùìüåßÔ∏è' },
  { template: '___ the snake bite him {signal}?', subject: 'the snake', verb: 'bite', vn: 'Con r·∫Øn c√≥ c·∫Øn anh ·∫•y kh√¥ng?', type: 'question', emoji: '‚ùìüêç' },

  // === MORE AFFIRM: HORRIBLE SCENARIOS ===
  { template: 'The cockroach ___ into my cereal {signal}!', subject: 'The cockroach', verb: 'fall', vn: 'Con gi√°n r∆°i v√†o ng≈© c·ªëc!', type: 'affirm', emoji: 'ü™≥ü•£' },
  { template: 'My parrot ___ bad words {signal}!', subject: 'My parrot', verb: 'say', vn: 'Con v·∫πt n√≥i b·∫≠y!', type: 'affirm', emoji: 'ü¶úü§¨' },
  { template: 'The monkey ___ my ice cream {signal}!', subject: 'The monkey', verb: 'steal', vn: 'Con kh·ªâ ƒÉn c·∫Øp kem!', type: 'affirm', emoji: 'üêíüç¶' },
  { template: 'A spider ___ a web on my face {signal}!', subject: 'A spider', verb: 'build', vn: 'Nh·ªán giƒÉng t∆° tr√™n m·∫∑t t√¥i!', type: 'affirm', emoji: 'üï∑Ô∏èüò±' },
  { template: 'He ___ his finger in his nose {signal}.', subject: 'He', verb: 'put', vn: 'Anh ·∫•y ngo√°y m≈©i!', type: 'affirm', emoji: 'üë¶üëÉ' },
  { template: 'The ghost ___ behind the door {signal}.', subject: 'The ghost', verb: 'hide', vn: 'Con ma tr·ªën sau c·ª≠a!', type: 'affirm', emoji: 'üëªüö™' },
  { template: 'Mom ___ about winning the lottery {signal}.', subject: 'Mom', verb: 'dream', vn: 'M·∫π m∆° tr√∫ng s·ªë!', type: 'affirm', emoji: 'üë©üí≠üí∞' },
  { template: 'The elephant ___ on my lunch box {signal}!', subject: 'The elephant', verb: 'sit', vn: 'Con voi ng·ªìi l√™n h·ªôp c∆°m!', type: 'affirm', emoji: 'üêòüç±' },
  { template: 'The pizza ___ $100 {signal}!', subject: 'The pizza', verb: 'cost', vn: 'Pizza gi√° $100!', type: 'affirm', emoji: 'üçïüí∏' },
  { template: 'She ___ the cupcake in half {signal}.', subject: 'She', verb: 'cut', vn: 'C√¥ ·∫•y c·∫Øt ƒë√¥i cupcake!', type: 'affirm', emoji: 'üëß‚úÇÔ∏èüßÅ' },
  { template: 'Grandpa ___ the candles {signal}.', subject: 'Grandpa', verb: 'light', vn: '√îng th·∫Øp n·∫øn!', type: 'affirm', emoji: 'üë¥üïØÔ∏è' },
  { template: 'The witch ___ the children candy {signal}.', subject: 'The witch', verb: 'give', vn: 'Ph√π th·ªßy cho tr·∫ª em k·∫πo!', type: 'affirm', emoji: 'üßô‚Äç‚ôÄÔ∏èüç¨' },
  { template: 'She ___ his name wrong {signal}!', subject: 'She', verb: 'spell', vn: 'C√¥ ·∫•y vi·∫øt sai t√™n!', type: 'affirm', emoji: '‚úèÔ∏è‚ùå' },
  { template: 'The tiger ___ the monkey {signal}!', subject: 'The tiger', verb: 'catch', vn: 'Con h·ªï b·∫Øt con kh·ªâ!', type: 'affirm', emoji: 'üêÖüêí' },
  { template: 'The sun ___ really bright {signal}.', subject: 'The sun', verb: 'shine', vn: 'M·∫∑t tr·ªùi chi·∫øu s√°ng ch√≥i!', type: 'affirm', emoji: '‚òÄÔ∏è‚ú®' },
  { template: 'The wizard ___ a superhero {signal}!', subject: 'The wizard', verb: 'become', vn: 'Ph√π th·ªßy tr·ªü th√†nh si√™u anh h√πng!', type: 'affirm', emoji: 'üßô‚Äç‚ôÇÔ∏èü¶∏' },
  { template: 'The chicken ___ 3 eggs {signal}!', subject: 'The chicken', verb: 'lay', vn: 'Con g√† ƒë·∫ª 3 tr·ª©ng!', type: 'affirm', emoji: 'üêîü•ö' },
  { template: 'He ___ the picture on the wall {signal}.', subject: 'He', verb: 'hang', vn: 'Anh ·∫•y treo tranh l√™n t∆∞·ªùng!', type: 'affirm', emoji: 'üñºÔ∏è' },
  { template: 'She ___ her friend $5 {signal}.', subject: 'She', verb: 'lend', vn: 'C√¥ ·∫•y cho b·∫°n m∆∞·ª£n $5!', type: 'affirm', emoji: 'üëßüíµ' },
  { template: 'She ___ the floor with a broom {signal}.', subject: 'She', verb: 'sweep', vn: 'C√¥ ·∫•y qu√©t nh√† b·∫±ng ch·ªïi!', type: 'affirm', emoji: 'üßπ' },
  { template: 'My nose ___ after the fall {signal}!', subject: 'My nose', verb: 'bleed', vn: 'M≈©i t√¥i ch·∫£y m√°u!', type: 'affirm', emoji: 'üëÉü©∏' },
  { template: 'He ___ the whole cake {signal}!', subject: 'He', verb: 'eat', vn: 'Anh ·∫•y ƒÉn h·∫øt c·∫£ b√°nh!', type: 'affirm', emoji: 'üë¶üéÇ' },
  { template: 'The wind ___ the papers everywhere {signal}!', subject: 'The wind', verb: 'blow', vn: 'Gi√≥ th·ªïi gi·∫•y tung to√©!', type: 'affirm', emoji: 'üí®üìÑ' },
  { template: 'She ___ a frog in the garden {signal}!', subject: 'She', verb: 'meet', vn: 'C√¥ ·∫•y g·∫∑p ·∫øch ngo√†i v∆∞·ªùn!', type: 'affirm', emoji: 'üëßüê∏' },
  { template: 'The volcano ___ to erupt {signal}!', subject: 'The volcano', verb: 'begin', vn: 'N√∫i l·ª≠a b·∫Øt ƒë·∫ßu phun!', type: 'affirm', emoji: 'üåãüí•' },
  { template: 'The dragon ___ fire {signal}!', subject: 'The dragon', verb: 'blow', vn: 'R·ªìng phun l·ª≠a!', type: 'affirm', emoji: 'üêâüî•' },
  { template: 'He ___ the spider out the window {signal}.', subject: 'He', verb: 'throw', vn: 'Anh ·∫•y n√©m nh·ªán ra c·ª≠a s·ªï!', type: 'affirm', emoji: 'üë¶üï∑Ô∏èü™ü' },
  { template: 'The duck ___ across the pond {signal}.', subject: 'The duck', verb: 'swim', vn: 'Con v·ªãt b∆°i qua ao!', type: 'affirm', emoji: 'ü¶Üüí¶' },
  { template: 'Grandma ___ me how to cook {signal}.', subject: 'Grandma', verb: 'teach', vn: 'B√† d·∫°y t√¥i n·∫•u ƒÉn!', type: 'affirm', emoji: 'üëµüç≥' },
  { template: 'He ___ a really scary story {signal}!', subject: 'He', verb: 'tell', vn: 'Anh ·∫•y k·ªÉ chuy·ªán ma!', type: 'affirm', emoji: 'üë¶üëª' },
  { template: 'She ___ the letter to Santa {signal}!', subject: 'She', verb: 'send', vn: 'C√¥ ·∫•y g·ª≠i th∆∞ cho √¥ng gi√† Noel!', type: 'affirm', emoji: 'üëß‚úâÔ∏èüéÖ' },
  { template: 'The bear ___ in the cave all winter {signal}.', subject: 'The bear', verb: 'sleep', vn: 'Con g·∫•u ng·ªß trong hang c·∫£ m√πa ƒë√¥ng!', type: 'affirm', emoji: 'üêªüèîÔ∏è' },
  { template: 'He ___ $50 for a toy {signal}!', subject: 'He', verb: 'pay', vn: 'Anh ·∫•y tr·∫£ $50 mua ƒë·ªì ch∆°i!', type: 'affirm', emoji: 'üë¶üíµüß∏' },
  { template: 'She ___ the puzzle answer {signal}!', subject: 'She', verb: 'find', vn: 'C√¥ ·∫•y t√¨m ra ƒë√°p √°n!', type: 'affirm', emoji: 'üëßüß©' },
  { template: 'She ___ a beautiful hat {signal}.', subject: 'She', verb: 'wear', vn: 'C√¥ ·∫•y ƒë·ªôi m≈© ƒë·∫πp!', type: 'affirm', emoji: 'üëßüé©' },
  { template: 'She ___ him her new doll {signal}.', subject: 'She', verb: 'show', vn: 'C√¥ ·∫•y cho anh ·∫•y xem b√∫p b√™!', type: 'affirm', emoji: 'üëßüéé' },
  { template: 'He ___ the doorbell and ran away {signal}!', subject: 'He', verb: 'ring', vn: 'Anh ·∫•y b·∫•m chu√¥ng r·ªìi ch·∫°y m·∫•t!', type: 'affirm', emoji: 'üë¶üîîüèÉ' },
  { template: 'She ___ the frog {signal}!', subject: 'She', verb: 'forgive', vn: 'C√¥ ·∫•y tha th·ª© cho con ·∫øch!', type: 'affirm', emoji: 'üëßüê∏üòá' },
  { template: 'He ___ the heavy box {signal}.', subject: 'He', verb: 'hold', vn: 'Anh ·∫•y b√™ h·ªôp n·∫∑ng!', type: 'affirm', emoji: 'üí™üì¶' },

  // === MORE NEGATIVE ===
  { template: 'He ___ tell the truth {signal}.', subject: 'He', verb: 'tell', vn: 'Anh ·∫•y kh√¥ng n√≥i s·ª± th·∫≠t!', type: 'negative', emoji: 'üë¶üö´ü§•' },
  { template: 'She ___ hear the alarm {signal}.', subject: 'She', verb: 'hear', vn: 'C√¥ ·∫•y kh√¥ng nghe chu√¥ng!', type: 'negative', emoji: 'üëßüö´‚è∞' },
  { template: 'The dog ___ come when I called {signal}.', subject: 'The dog', verb: 'come', vn: 'Con ch√≥ kh√¥ng ƒë·∫øn khi t√¥i g·ªçi!', type: 'negative', emoji: 'üêïüö´' },
  { template: 'He ___ know the answer {signal}.', subject: 'He', verb: 'know', vn: 'Anh ·∫•y kh√¥ng bi·∫øt ƒë√°p √°n!', type: 'negative', emoji: 'üë¶üö´ü§î' },
  { template: 'She ___ feel well {signal}.', subject: 'She', verb: 'feel', vn: 'C√¥ ·∫•y kh√¥ng kh·ªèe!', type: 'negative', emoji: 'üëßüö´ü§í' },
  { template: 'They ___ bring umbrellas {signal}.', subject: 'They', verb: 'bring', vn: 'H·ªç kh√¥ng mang √¥!', type: 'negative', emoji: 'üë•üö´‚òÇÔ∏è' },
  { template: 'He ___ pay for the ticket {signal}.', subject: 'He', verb: 'pay', vn: 'Anh ·∫•y kh√¥ng tr·∫£ ti·ªÅn v√©!', type: 'negative', emoji: 'üë¶üö´üéüÔ∏è' },
  { template: 'She ___ keep her promise {signal}.', subject: 'She', verb: 'keep', vn: 'C√¥ ·∫•y kh√¥ng gi·ªØ l·ªùi h·ª©a!', type: 'negative', emoji: 'üëßüö´ü§û' },
  { template: 'The baby ___ sleep all night {signal}.', subject: 'The baby', verb: 'sleep', vn: 'Em b√© kh√¥ng ng·ªß c·∫£ ƒë√™m!', type: 'negative', emoji: 'üë∂üö´üí§' },
  { template: 'He ___ understand the lesson {signal}.', subject: 'He', verb: 'understand', vn: 'Anh ·∫•y kh√¥ng hi·ªÉu b√†i!', type: 'negative', emoji: 'üë¶üö´üìö' },
  { template: 'She ___ choose a dress {signal}.', subject: 'She', verb: 'choose', vn: 'C√¥ ·∫•y kh√¥ng ch·ªçn ƒë∆∞·ª£c v√°y!', type: 'negative', emoji: 'üëßüö´üëó' },
  { template: 'They ___ find the treasure {signal}.', subject: 'They', verb: 'find', vn: 'H·ªç kh√¥ng t√¨m ƒë∆∞·ª£c kho b√°u!', type: 'negative', emoji: 'üë•üö´üíé' },
  { template: 'He ___ wear a jacket {signal}.', subject: 'He', verb: 'wear', vn: 'Anh ·∫•y kh√¥ng m·∫∑c √°o kho√°c!', type: 'negative', emoji: 'üë¶üö´üß•' },
  { template: 'She ___ sell any lemonade {signal}.', subject: 'She', verb: 'sell', vn: 'C√¥ ·∫•y kh√¥ng b√°n ƒë∆∞·ª£c n∆∞·ªõc chanh!', type: 'negative', emoji: 'üëßüö´üçã' },
  { template: 'She ___ spend any money {signal}.', subject: 'She', verb: 'spend', vn: 'C√¥ ·∫•y kh√¥ng ti√™u ti·ªÅn!', type: 'negative', emoji: 'üëßüö´üí∞' },
  { template: 'He ___ think about it {signal}.', subject: 'He', verb: 'think', vn: 'Anh ·∫•y kh√¥ng nghƒ© v·ªÅ n√≥!', type: 'negative', emoji: 'üë¶üö´üß†' },
  { template: 'She ___ write a single word {signal}.', subject: 'She', verb: 'write', vn: 'C√¥ ·∫•y kh√¥ng vi·∫øt ch·ªØ n√†o!', type: 'negative', emoji: 'üëßüö´‚úèÔ∏è' },
  { template: 'He ___ ride the roller coaster {signal}.', subject: 'He', verb: 'ride', vn: 'Anh ·∫•y kh√¥ng d√°m ƒëi t√†u l∆∞·ª£n!', type: 'negative', emoji: 'üë¶üö´üé¢' },
  { template: 'The wind ___ blow hard {signal}.', subject: 'The wind', verb: 'blow', vn: 'Gi√≥ kh√¥ng th·ªïi m·∫°nh!', type: 'negative', emoji: 'üö´üí®' },
  { template: 'He ___ grow any taller {signal}.', subject: 'He', verb: 'grow', vn: 'Anh ·∫•y kh√¥ng cao th√™m!', type: 'negative', emoji: 'üë¶üö´üìè' },

  // === MORE QUESTION_VERB ===
  { template: 'Does the parrot ___ bad words {signal}?', subject: 'the parrot', verb: 'say', vn: 'Con v·∫πt c√≥ n√≥i b·∫≠y kh√¥ng?', type: 'question_verb', emoji: '‚ùìü¶ú' },
  { template: 'Did someone ___ in the bushes {signal}?', subject: 'someone', verb: 'hide', vn: 'C√≥ ai tr·ªën trong b·ª•i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüåøüëÄ' },
  { template: 'Does she ___ what it means {signal}?', subject: 'she', verb: 'know', vn: 'C√¥ ·∫•y c√≥ bi·∫øt nghƒ©a g√¨ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüìñ' },
  { template: 'Did he ___ on a banana peel {signal}?', subject: 'he', verb: 'fall', vn: 'Anh ·∫•y c√≥ tr∆∞·ª£t v·ªè chu·ªëi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüçåüòµ' },
  { template: 'Does the dog ___ under the bed {signal}?', subject: 'the dog', verb: 'sleep', vn: 'Con ch√≥ c√≥ ng·ªß d∆∞·ªõi gi∆∞·ªùng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüêïüõèÔ∏è' },
  { template: 'Does she ___ faster than a cheetah {signal}?', subject: 'she', verb: 'run', vn: 'C√¥ ·∫•y c√≥ ch·∫°y nhanh h∆°n b√°o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüèÉ‚Äç‚ôÄÔ∏èüêÜ' },
  { template: 'Did he ___ a wish {signal}?', subject: 'he', verb: 'make', vn: 'Anh ·∫•y c√≥ ∆∞·ªõc kh√¥ng?', type: 'question_verb', emoji: '‚ùìüåü' },
  { template: 'Did she ___ sad {signal}?', subject: 'she', verb: 'feel', vn: 'C√¥ ·∫•y c√≥ bu·ªìn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüò¢' },
  { template: 'Does he ___ new words {signal}?', subject: 'he', verb: 'learn', vn: 'Anh ·∫•y c√≥ h·ªçc t·ª´ m·ªõi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüìö' },
  { template: 'Did the baby ___ the cat {signal}?', subject: 'the baby', verb: 'hold', vn: 'Em b√© c√≥ c·∫ßm con m√®o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë∂üê±' },
  { template: 'Does she ___ his name correctly {signal}?', subject: 'she', verb: 'spell', vn: 'C√¥ ·∫•y ƒë√°nh v·∫ßn ƒë√∫ng t√™n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüî§' },
  { template: 'Did the boy ___ in the queue {signal}?', subject: 'the boy', verb: 'stand', vn: 'C·∫≠u b√© c√≥ x·∫øp h√†ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßç' },
  { template: 'Does she ___ her room tidy {signal}?', subject: 'she', verb: 'keep', vn: 'C√¥ ·∫•y c√≥ gi·ªØ ph√≤ng g·ªçn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßπ' },
  { template: 'Did they ___ the door {signal}?', subject: 'they', verb: 'shut', vn: 'H·ªç c√≥ ƒë√≥ng c·ª≠a kh√¥ng?', type: 'question_verb', emoji: '‚ùìüö™' },
  { template: 'Does he ___ much money {signal}?', subject: 'he', verb: 'spend', vn: 'Anh ·∫•y c√≥ ti√™u nhi·ªÅu ti·ªÅn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüí∏' },
  { template: 'Does she ___ him money {signal}?', subject: 'she', verb: 'lend', vn: 'C√¥ ·∫•y c√≥ cho m∆∞·ª£n ti·ªÅn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüíµ' },
  { template: 'Did the sunflower ___ tall {signal}?', subject: 'the sunflower', verb: 'grow', vn: 'Hoa h∆∞·ªõng d∆∞∆°ng c√≥ m·ªçc cao kh√¥ng?', type: 'question_verb', emoji: '‚ùìüåª' },

  // === BE VERB ===
  { template: 'He ___ at school {signal}.', subject: 'He', verb: 'be', vn: 'Anh ·∫•y ·ªü tr∆∞·ªùng!', type: 'affirm', emoji: 'üë¶üè´' },
  { template: 'She ___ happy {signal}.', subject: 'She', verb: 'be', vn: 'C√¥ ·∫•y vui!', type: 'affirm', emoji: 'üëßüòä' },
  { template: 'They ___ in the park {signal}.', subject: 'They', verb: 'be', vn: 'H·ªç ·ªü c√¥ng vi√™n!', type: 'affirm', emoji: 'üë•üèûÔ∏è' },
  { template: 'The cat ___ on the roof {signal}.', subject: 'The cat', verb: 'be', vn: 'Con m√®o ·ªü tr√™n m√°i nh√†!', type: 'affirm', emoji: 'üê±üè†' },
  { template: 'I ___ very tired {signal}.', subject: 'I', verb: 'be', vn: 'T√¥i r·∫•t m·ªát!', type: 'affirm', emoji: 'ü•±' }
];

function getVerbForms(verbBase) {
  // Find verb in IRREGULAR_VERBS
  for (var i = 0; i < IRREGULAR_VERBS.groups.length; i++) {
    var group = IRREGULAR_VERBS.groups[i];
    for (var j = 0; j < group.verbs.length; j++) {
      var v = group.verbs[j];
      if (v.base === verbBase) {
        return { base: v.base, past: v.past, vn: v.vn };
      }
    }
  }
  // Regular verb fallback
  return { base: verbBase, past: verbBase + 'ed', vn: '' };
}

function getPresentForm(verb, subject) {
  var subjectLower = subject.toLowerCase();
  
  // X·ª¨ L√ù ƒê·∫∂C BI·ªÜT CHO ƒê·ªòNG T·ª™ "BE"
  if (verb === 'be') {
    if (subjectLower === 'i') return 'am';
    if (['he', 'she', 'it', 'mom', 'dad', 'tom', 'lily', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(subjectLower) >= 0) return 'is';
    // they, we, you, v√† c√°c ch·ªß ng·ªØ s·ªë nhi·ªÅu
    return 'are';
  }
  
  // Danh s√°ch ng√¥i 3 s·ªë √≠t c·ª• th·ªÉ
  var thirdPersonList = ['he', 'she', 'it', 'mom', 'dad', 'tom', 'lily', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'the class', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'];
  
  // Ki·ªÉm tra n·∫øu l√† ng√¥i 3 s·ªë √≠t (kh√¥ng ph·∫£i s·ªë nhi·ªÅu)
  var isThirdPerson = thirdPersonList.indexOf(subjectLower) >= 0;
  
  // N·∫øu kh√¥ng trong danh s√°ch, ki·ªÉm tra th√™m: b·∫Øt ƒë·∫ßu b·∫±ng "the " ho·∫∑c "my " ho·∫∑c "his/her " v√† KH√îNG k·∫øt th√∫c b·∫±ng "s" (s·ªë nhi·ªÅu)
  if (!isThirdPerson && (subjectLower.startsWith('the ') || subjectLower.startsWith('my ') || subjectLower.startsWith('his ') || subjectLower.startsWith('her '))) {
    // Lo·∫°i b·ªè c√°c t·ª´ s·ªë nhi·ªÅu (k·∫øt th√∫c b·∫±ng s nh∆∞ng kh√¥ng ph·∫£i class, bus, etc.)
    var pluralExceptions = ['the kids', 'the boys', 'the girls', 'the stars', 'the leaves', 'prices', 'birds', 'penguins', 'dogs'];
    if (pluralExceptions.indexOf(subjectLower) < 0) {
      isThirdPerson = true;
    }
  }
  
  if (isThirdPerson) {
    if (verb === 'go' || verb === 'do') return verb + 'es';
    if (verb === 'have') return 'has';
    if (verb === 'watch' || verb === 'wash' || verb === 'teach' || verb === 'catch') return verb + 'es';
    // Ch·ªâ ƒë·ªïi y‚Üíies khi tr∆∞·ªõc y l√† PH·ª§ √ÇM (kh√¥ng ph·∫£i nguy√™n √¢m a,e,i,o,u)
    if (verb.endsWith('y')) {
      var beforeY = verb.charAt(verb.length - 2);
      var vowels = ['a', 'e', 'i', 'o', 'u'];
      if (vowels.indexOf(beforeY) < 0) {
        // Ph·ª• √¢m tr∆∞·ªõc y: cry ‚Üí cries, fly ‚Üí flies
        return verb.slice(0, -1) + 'ies';
      }
      // Nguy√™n √¢m tr∆∞·ªõc y: buy ‚Üí buys, play ‚Üí plays
      return verb + 's';
    }
    return verb + 's';
  }
  return verb;
}

function generateQuizQuestions(count) {
  var questions = [];
  var usedTemplates = [];
  
  // Get all verbs for wrong answers
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  for (var i = 0; i < count; i++) {
    // Pick random template
    var templateIndex;
    do {
      templateIndex = Math.floor(Math.random() * SENTENCE_TEMPLATES.length);
    } while (usedTemplates.indexOf(templateIndex) >= 0 && usedTemplates.length < SENTENCE_TEMPLATES.length);
    usedTemplates.push(templateIndex);
    
    var template = SENTENCE_TEMPLATES[templateIndex];
    var verbForms = getVerbForms(template.verb);
    var sentenceType = template.type || 'affirm';
    
    // Randomly choose present or past
    var isPast = Math.random() > 0.5;
    var signalList = isPast ? SIGNAL_WORDS.past : SIGNAL_WORDS.present;
    var signalObj = signalList[Math.floor(Math.random() * signalList.length)];
    
    var correctAnswer, wrongAnswers = [];
    var subject = template.subject.toLowerCase();
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane', 'grandpa', 'grandma', 'a spider', 'the cockroach', 'my parrot', 'the ghost', 'the elephant', 'the pizza', 'the witch', 'the tiger', 'the wizard', 'the chicken', 'the duck', 'the bear', 'the dragon', 'the volcano', 'the robber', 'the plant', 'the snake', 'the old man', 'my nose', 'the floor', 'the kitten', 'the sunflower', 'the boy', 'a crab', 'the cockroach', 'my brother', 'the firefighter', 'the turkey', 'the parrot'].indexOf(subject) >= 0;
    
    // Special handling for BE verb
    if (template.verb === 'be') {
      if (isPast) {
        if (subject === 'they' || subject === 'we' || subject === 'you') {
          correctAnswer = 'were';
          wrongAnswers = ['was', 'are', 'is'];
        } else {
          correctAnswer = 'was';
          wrongAnswers = ['were', 'is', 'are'];
        }
      } else {
        correctAnswer = getPresentForm('be', template.subject);
        if (correctAnswer === 'is') wrongAnswers = ['are', 'am', 'was'];
        else if (correctAnswer === 'am') wrongAnswers = ['is', 'are', 'was'];
        else wrongAnswers = ['is', 'am', 'was'];
      }
    } else if (sentenceType === 'affirm') {
      // C√¢u kh·∫≥ng ƒë·ªãnh: ƒëi·ªÅn ƒë·ªông t·ª´
      correctAnswer = isPast ? verbForms.past : getPresentForm(verbForms.base, template.subject);
      
      // Wrong answers
      var opposite = isPast ? getPresentForm(verbForms.base, template.subject) : verbForms.past;
      if (opposite !== correctAnswer) wrongAnswers.push(opposite);
      
    } else if (sentenceType === 'negative') {
      // C√¢u ph·ªß ƒë·ªãnh: ƒëi·ªÅn don't/doesn't/didn't
      if (isPast) {
        correctAnswer = "didn't";
        wrongAnswers = ["don't", "doesn't", "isn't"];
      } else {
        correctAnswer = isThirdPerson ? "doesn't" : "don't";
        wrongAnswers = isThirdPerson ? ["don't", "didn't", "isn't"] : ["doesn't", "didn't", "aren't"];
      }
      
    } else if (sentenceType === 'question') {
      // C√¢u h·ªèi c≈©: ƒëi·ªÅn Do/Does/Did
      if (isPast) {
        correctAnswer = "Did";
        wrongAnswers = ["Do", "Does", "Is"];
      } else {
        correctAnswer = isThirdPerson ? "Does" : "Do";
        wrongAnswers = isThirdPerson ? ["Do", "Did", "Is"] : ["Does", "Did", "Are"];
      }
    } else if (sentenceType === 'question_verb') {
      // C√¢u h·ªèi m·ªõi: ƒë√£ c√≥ Do/Does/Did, c·∫ßn ƒëi·ªÅn ƒë·ªông t·ª´ G·ªêC
      correctAnswer = verbForms.base; // Lu√¥n l√† V g·ªëc sau Do/Does/Did
      
      // Wrong answers: V-s/es ho·∫∑c V2 (nh∆∞ng ph·∫£i KH√ÅC correctAnswer)
      if (verbForms.past !== correctAnswer) wrongAnswers.push(verbForms.past);
      var vPresent = getPresentForm(verbForms.base, 'She');
      if (vPresent !== correctAnswer && wrongAnswers.indexOf(vPresent) < 0) wrongAnswers.push(vPresent);
      
      // Th√™m ƒë√°p √°n sai t·ª´ c√°c ƒë·ªông t·ª´ kh√°c
      var shuffledVerbs = shuffle(allVerbs);
      for (var k = 0; k < shuffledVerbs.length && wrongAnswers.length < 3; k++) {
        var wv = shuffledVerbs[k];
        if (wv.base !== template.verb && wv.past !== correctAnswer && wrongAnswers.indexOf(wv.past) < 0) {
          wrongAnswers.push(wv.past);
        }
      }
    }
    
    // Add more wrong answers from other verbs if needed (for affirm type)
    if (sentenceType === 'affirm') {
      var shuffledVerbs = shuffle(allVerbs);
      for (var j = 0; j < shuffledVerbs.length && wrongAnswers.length < 3; j++) {
        var wrongVerb = shuffledVerbs[j];
        if (wrongVerb.base !== template.verb) {
          var wrongForm = isPast ? wrongVerb.past : getPresentForm(wrongVerb.base, template.subject);
          if (wrongForm !== correctAnswer && wrongAnswers.indexOf(wrongForm) < 0) {
            wrongAnswers.push(wrongForm);
          }
        }
      }
    }
    
    // Ensure we have 3 wrong answers - add smart distractors
    var fallbackWrongs = ['went', 'goes', 'ate', 'eats', 'took', 'takes', 'saw', 'sees', 'came', 'comes', 'gave', 'gives', 'ran', 'runs', 'made', 'makes'];
    var fi = 0;
    while (wrongAnswers.length < 3 && fi < fallbackWrongs.length) {
      if (fallbackWrongs[fi] !== correctAnswer && wrongAnswers.indexOf(fallbackWrongs[fi]) < 0) {
        wrongAnswers.push(fallbackWrongs[fi]);
      }
      fi++;
    }
    
    var sentence = template.template.replace('{signal}', signalObj.signal);
    
    questions.push({
      sentence: sentence,
      sentenceVn: template.vn,
      signal: signalObj.signal,
      signalVn: signalObj.vn,
      isPast: isPast,
      verb: verbForms.base,
      verbVn: verbForms.vn,
      correctAnswer: correctAnswer,
      wrongAnswers: wrongAnswers.slice(0, 3),
      subject: template.subject,
      type: sentenceType,
      emoji: template.emoji || ''
    });
  }
  
  return shuffle(questions);
}

function startVerbSentenceQuiz() {
  playSound('click');
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üìù Tr·∫Øc nghi·ªám</div>' +
    '<div></div></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üìù</div>' +
    '<div class="easy-match-title">Tr·∫Øc nghi·ªám ƒë·ªông t·ª´</div>' +
    '<div class="easy-match-hint">Ch·ªçn d·∫°ng ƒë√∫ng ƒë·ªÉ ƒëi·ªÅn v√†o ch·ªó tr·ªëng</div>' +
    '</div>' +
    
    '<div class="study-tip-box" style="margin:15px 0">' +
    '<div class="study-tip-icon">üí°</div>' +
    '<div class="study-tip-text">' +
    '‚ö†Ô∏è Sau <strong>Do/Does/Did</strong> lu√¥n d√πng <strong>ƒë·ªông t·ª´ G·ªêC</strong>!' +
    '</div></div>' +
    
    '<div class="level-cards">' +
    '<div class="level-card easy" onclick="startSentenceQuizGame(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info"><div class="level-name">Nhanh</div>' +
    '<div class="level-desc">Luy·ªán t·∫≠p nh·∫π nh√†ng</div></div>' +
    '<div class="level-time">5 c√¢u ‚Ä¢ 3 ph√∫t</div></div>' +

    '<div class="level-card medium" onclick="startSentenceQuizGame(8)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info"><div class="level-name">V·ª´a ph·∫£i</div>' +
    '<div class="level-desc">√în t·∫≠p c∆° b·∫£n</div></div>' +
    '<div class="level-time">8 c√¢u ‚Ä¢ 5 ph√∫t</div></div>' +

    '<div class="level-card hard" onclick="startSentenceQuizGame(10)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info"><div class="level-name">Th·ª≠ th√°ch</div>' +
    '<div class="level-desc">Ki·ªÉm tra ki·∫øn th·ª©c</div></div>' +
    '<div class="level-time">10 c√¢u ‚Ä¢ 8 ph√∫t</div></div>' +

    '<div class="level-card" onclick="startSentenceQuizGame(15)" style="border-color:#9C27B0">' +
    '<div class="level-icon">üèÜ</div>' +
    '<div class="level-info"><div class="level-name" style="color:#7B1FA2">Si√™u sao</div>' +
    '<div class="level-desc">D√†nh cho cao th·ªß!</div></div>' +
    '<div class="level-time">15 c√¢u ‚Ä¢ 12 ph√∫t</div></div>' +

    '<div class="level-card" onclick="startSentenceQuizGame(20)" style="border-color:#FF6D00;background:linear-gradient(135deg,#FFF8E1,#FFECB3)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info"><div class="level-name" style="color:#E65100">Huy·ªÅn tho·∫°i</div>' +
    '<div class="level-desc">Boss cu·ªëi ƒë√¢y r·ªìi! üëæ</div></div>' +
    '<div class="level-time">20 c√¢u ‚Ä¢ 15 ph√∫t</div></div>' +

    '<div class="level-card" onclick="startSentenceQuizGame(30)" style="border-color:#D50000;background:linear-gradient(135deg,#FFEBEE,#FFCDD2)">' +
    '<div class="level-icon">üíÄ</div>' +
    '<div class="level-info"><div class="level-name" style="color:#B71C1C">B·∫•t kh·∫£ chi·∫øn b·∫°i</div>' +
    '<div class="level-desc">Ch·ªâ d√†nh cho ng∆∞·ªùi d≈©ng c·∫£m! ‚öîÔ∏è</div></div>' +
    '<div class="level-time">30 c√¢u ‚Ä¢ 20 ph√∫t</div></div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function startSentenceQuizGame(count) {
  playSound('click');
  
  sentenceQuizState = {
    questions: generateQuizQuestions(count),
    currentIndex: 0,
    score: 0,
    answered: false,
    level: count
  };
  
  renderSentenceQuiz();
}

function renderSentenceQuiz() {
  var state = sentenceQuizState;
  
  if (state.currentIndex >= state.questions.length) {
    showSentenceQuizResult();
    return;
  }
  
  var q = state.questions[state.currentIndex];
  var total = state.level;
  
  // Progress dots
  var dotsHtml = '';
  for (var i = 0; i < total; i++) {
    var dotClass = 'dot';
    if (i < state.currentIndex) dotClass += ' done';
    else if (i === state.currentIndex) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  // Underline the signal word in sentence
  var displaySentence = q.sentence.replace(q.signal, '<u style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:700">' + q.signal + '</u>');
  displaySentence = displaySentence.replace('___', '<span class="pp-blank" id="sqBlank">?</span>');
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="startVerbSentenceQuiz()">‚Üê Back</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚≠ê ' + state.score + '</div>' +
    '</div>' +
    '<div class="story-scene">';
  
  // Emoji
  if (q.emoji) {
    html += '<div class="scene-image">' + q.emoji + '</div>';
  }
  
  // Sentence with blank
  html += '<div class="scene-text">' + displaySentence + '</div>' +
    '<div class="choice-buttons" id="sqChoices">';
  
  // Create array with 1 correct + 3 wrong, then shuffle
  var allChoices = [
    { answer: q.correctAnswer, isCorrect: true }
  ];
  q.wrongAnswers.forEach(function(wrong) {
    if (wrong !== q.correctAnswer && !allChoices.some(function(c) { return c.answer === wrong; })) {
      allChoices.push({ answer: wrong, isCorrect: false });
    }
  });
  allChoices = shuffle(allChoices);
  
  // Store correct index for later
  var correctIdx = -1;
  allChoices.forEach(function(choice, idx) {
    if (choice.isCorrect) correctIdx = idx;
    html += '<button class="choice-btn" id="sq-' + idx + '" ' +
      'onclick="checkSentenceAnswer(' + idx + ', ' + choice.isCorrect + ')">' +
      choice.answer +
      '</button>';
  });
  
  sentenceQuizState.correctIdx = correctIdx;
  sentenceQuizState.allChoices = allChoices;
  
  html += '</div><div id="sentenceFeedback"></div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function checkSentenceAnswer(choiceIdx, isCorrect) {
  if (sentenceQuizState.answered) return;
  sentenceQuizState.answered = true;
  
  var q = sentenceQuizState.questions[sentenceQuizState.currentIndex];
  var correctIdx = sentenceQuizState.correctIdx;
  
  // Show answer in blank
  var blank = document.getElementById('sqBlank');
  if (blank) {
    blank.textContent = q.correctAnswer;
    blank.className = isCorrect ? 'pp-filled' : 'pp-filled pp-filled-wrong';
  }
  
  // Highlight all buttons
  document.querySelectorAll('#sqChoices .choice-btn').forEach(function(btn, idx) {
    btn.disabled = true;
    if (idx === choiceIdx && isCorrect) {
      btn.classList.add('correct');
    } else if (idx === choiceIdx && !isCorrect) {
      btn.classList.add('wrong');
    }
    if (idx === correctIdx && !isCorrect) {
      btn.classList.add('correct');
    }
  });
  
  if (isCorrect) {
    sentenceQuizState.score++;
    addStars(1);
    playSound('correct');
  } else {
    playSound('wrong');
    addMistake({
      sentence: q.sentence,
      sentenceVn: q.sentenceVn,
      correctAnswer: q.correctAnswer,
      verb: q.verb,
      verbVn: q.verbVn,
      signal: q.signal,
      signalVn: q.signalVn,
      isPast: q.isPast,
      type: q.type,
      subject: q.subject,
      emoji: q.emoji,
      quizType: 'sentence'
    });
  }
  
  // Explanation based on type
  var explanation = '';
  if (q.type === 'affirm') {
    explanation = q.isPast ? 
      'üåô <strong>' + q.signal + '</strong> ‚Üí d√πng Simple Past: <strong>' + q.correctAnswer + '</strong>' :
      '‚òÄÔ∏è <strong>' + q.signal + '</strong> ‚Üí d√πng hi·ªán t·∫°i: <strong>' + q.correctAnswer + '</strong>';
  } else if (q.type === 'negative') {
    explanation = q.isPast ?
      'üö´üåô Ph·ªß ƒë·ªãnh qu√° kh·ª© ‚Üí <strong>didn\'t</strong> + ƒë·ªông t·ª´ g·ªëc' :
      'üö´‚òÄÔ∏è Ph·ªß ƒë·ªãnh hi·ªán t·∫°i ‚Üí <strong>' + q.correctAnswer + '</strong> + ƒë·ªông t·ª´ g·ªëc';
  } else if (q.type === 'question') {
    explanation = q.isPast ?
      '‚ùìüåô C√¢u h·ªèi qu√° kh·ª© ‚Üí <strong>Did</strong> + S + ƒë·ªông t·ª´ g·ªëc?' :
      '‚ùì‚òÄÔ∏è C√¢u h·ªèi hi·ªán t·∫°i ‚Üí <strong>' + q.correctAnswer + '</strong> + S + ƒë·ªông t·ª´ g·ªëc?';
  } else if (q.type === 'question_verb') {
    explanation = '‚ö†Ô∏è Sau Do/Does/Did lu√¥n d√πng <strong>ƒë·ªông t·ª´ G·ªêC</strong>: <strong>' + q.correctAnswer + '</strong>';
  }
  
  var feedbackHtml = '<div class="feedback-box ' + (isCorrect ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="feedback-text">' + (isCorrect ? '‚úÖ Ch√≠nh x√°c!' : '‚ùå Ch∆∞a ƒë√∫ng!') + '</div>' +
    '<div class="feedback-tip" style="text-align:left;line-height:1.6">' + explanation + '</div>';
  
  if (!isCorrect) {
    feedbackHtml += '<div style="margin-top:10px;padding:12px;background:#E8F5E9;border-radius:10px;color:#2E7D32;font-weight:600">' +
      '‚úÖ ƒê√°p √°n ƒë√∫ng: <strong>' + q.correctAnswer + '</strong></div>';
  }
  
  feedbackHtml += '<button class="next-btn" onclick="nextSentenceQuestion()">' +
    (sentenceQuizState.currentIndex < sentenceQuizState.level - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  document.getElementById('sentenceFeedback').innerHTML = feedbackHtml;
  
  if (isCorrect && sentenceQuizState.score % 3 === 0) {
    showConfetti();
  }
}

function nextSentenceQuestion() {
  sentenceQuizState.currentIndex++;
  sentenceQuizState.answered = false;
  renderSentenceQuiz();
}

function showSentenceQuizResult() {
  var state = sentenceQuizState;
  var percentage = Math.round((state.score / state.level) * 100);
  
  var emoji, message;
  var sqMsgs90 = ['S·ª± n·ªó l·ª±c c·ªßa con ƒë∆∞·ª£c ƒë·ªÅn ƒë√°p!','Con ƒë√£ ki√™n tr√¨ luy·ªán t·∫≠p!','C·ª© ti·∫øp t·ª•c th·∫ø n√†y, con ti·∫øn b·ªô r√µ r·ªát!'];var sqMsgs70 = ['Con ƒëang tr√™n ƒë√† ti·∫øn b·ªô!','M·ªói l·∫ßn l√†m b√†i l√† m·ªói l·∫ßn v·ªØng h∆°n!','Con ƒë√£ c·ªë g·∫Øng, k·∫øt qu·∫£ s·∫Ω t·ªët h∆°n!'];var sqMsgs50 = ['Con ƒë√£ d≈©ng c·∫£m th·ª≠ s·ª©c!','Luy·ªán th√™m, con s·∫Ω nh·ªõ l√¢u h∆°n!','Sai c≈©ng l√† b∆∞·ªõc ti·∫øn, ƒë·ª´ng n·∫£n nh√©!'];var sqMsgsLow = ['Ki√™n nh·∫´n √¥n l·∫°i, con s·∫Ω ti·∫øn b·ªô!','M·ªói c√¢u sai l√† c∆° h·ªôi ƒë·ªÉ h·ªçc!','B·∫Øt ƒë·∫ßu l·∫°i c≈©ng c·∫ßn d≈©ng c·∫£m!'];if (percentage >= 90) { emoji = 'üèÜ'; message = sqMsgs90[Math.floor(Math.random()*3)]; }else if (percentage >= 70) { emoji = '‚≠ê'; message = sqMsgs70[Math.floor(Math.random()*3)]; }else if (percentage >= 50) { emoji = 'üí™'; message = sqMsgs50[Math.floor(Math.random()*3)]; }else { emoji = 'üìö'; message = sqMsgsLow[Math.floor(Math.random()*3)]; }
  
  playSound('complete');
  if (percentage >= 70) showConfetti();
  
  var starsHtml = '';
  var starCount = percentage >= 90 ? 3 : percentage >= 70 ? 2 : percentage >= 50 ? 1 : 0;
  for (var i = 0; i < 3; i++) {
    starsHtml += i < starCount ? '‚≠ê' : '‚òÜ';
  }
  
  var html = '<div class="result-content">' +
    '<div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + message + '</div>' +
    '<div class="result-stars">' + starsHtml + '</div>' +
    '<div style="font-size:2.5rem;font-weight:800;color:#667eea;margin:15px 0">' + 
    state.score + ' / ' + state.level + '</div>' +
    '<div style="color:#666;margin-bottom:20px">' + percentage + '% ch√≠nh x√°c</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="startSentenceQuizGame(' + state.level + ')">Ch∆°i l·∫°i üîÑ</button>' +
    '<button class="result-btn secondary" onclick="startVerbSentenceQuiz()">ƒê·ªïi m·ª©c ƒë·ªô üìä</button>' +
    '<button class="result-btn secondary" onclick="showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

// ============ CONTEXT LEARN ============
var contextLearnState = {
  currentIndex: 0
};

var CONTEXT_LESSONS = [
  {
    title: '‚òÄÔ∏è D·∫•u hi·ªáu HI·ªÜN T·∫†I',
    signals: [
      { word: 'every day', vn: 'm·ªói ng√†y', emoji: 'üìÖ' },
      { word: 'every morning', vn: 'm·ªói s√°ng', emoji: 'üåÖ' },
      { word: 'every week', vn: 'm·ªói tu·∫ßn', emoji: 'üìÜ' },
      { word: 'always', vn: 'lu√¥n lu√¥n', emoji: 'üíØ' },
      { word: 'usually', vn: 'th∆∞·ªùng', emoji: 'üîÑ' },
      { word: 'often', vn: 'th∆∞·ªùng xuy√™n', emoji: 'üîÅ' },
      { word: 'sometimes', vn: 'ƒë√¥i khi', emoji: 'üé≤' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">eats</span> breakfast <span class="signal-word">every day</span>.', type: 'present' },
      { sentence: 'I <span class="verb-word">go</span> to school <span class="signal-word">every morning</span>.', type: 'present' },
      { sentence: 'He <span class="verb-word">always</span> <span class="verb-word">drinks</span> milk.', type: 'present' }
    ],
    rule: 'Th·∫•y nh·ªØng t·ª´ n√†y ‚Üí d√πng TH√å HI·ªÜN T·∫†I'
  },
  {
    title: 'üåô D·∫•u hi·ªáu QU√Å KH·ª®',
    signals: [
      { word: 'yesterday', vn: 'h√¥m qua', emoji: 'üìÜ' },
      { word: 'last night', vn: 't·ªëi qua', emoji: 'üåô' },
      { word: 'last week', vn: 'tu·∫ßn tr∆∞·ªõc', emoji: 'üìÖ' },
      { word: 'last month', vn: 'th√°ng tr∆∞·ªõc', emoji: 'üóìÔ∏è' },
      { word: 'last year', vn: 'nƒÉm ngo√°i', emoji: 'üìÜ' },
      { word: '2 days ago', vn: '2 ng√†y tr∆∞·ªõc', emoji: '‚è™' },
      { word: 'this morning', vn: 's√°ng nay', emoji: 'üåÑ' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">ate</span> breakfast <span class="signal-word">yesterday</span>.', type: 'past' },
      { sentence: 'I <span class="verb-word">went</span> to school <span class="signal-word">last week</span>.', type: 'past' },
      { sentence: 'He <span class="verb-word">drank</span> milk <span class="signal-word">this morning</span>.', type: 'past' }
    ],
    rule: 'Th·∫•y nh·ªØng t·ª´ n√†y ‚Üí d√πng TH√å QU√Å KH·ª® (Simple Past)'
  },
  {
    title: 'üö´ C√¢u PH·ª¶ ƒê·ªäNH',
    signals: [
      { word: "don't / doesn't", vn: 'kh√¥ng (hi·ªán t·∫°i)', emoji: '‚òÄÔ∏èüö´' },
      { word: "didn't", vn: 'kh√¥ng (qu√° kh·ª©)', emoji: 'üåôüö´' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">doesn\'t</span> eat meat <span class="signal-word">every day</span>.', type: 'present' },
      { sentence: 'I <span class="verb-word">don\'t</span> like coffee.', type: 'present' },
      { sentence: 'He <span class="verb-word">didn\'t</span> go to school <span class="signal-word">yesterday</span>.', type: 'past' }
    ],
    rule: '‚òÄÔ∏è Hi·ªán t·∫°i: don\'t/doesn\'t + V g·ªëc<br>üåô Qu√° kh·ª©: didn\'t + V g·ªëc'
  },
  {
    title: '‚ùì C√¢u H·ªéI',
    signals: [
      { word: 'Do / Does', vn: 'c√≥...kh√¥ng? (hi·ªán t·∫°i)', emoji: '‚òÄÔ∏è‚ùì' },
      { word: 'Did', vn: 'c√≥...kh√¥ng? (qu√° kh·ª©)', emoji: 'üåô‚ùì' }
    ],
    examples: [
      { sentence: '<span class="verb-word">Does</span> she eat breakfast <span class="signal-word">every day</span>?', type: 'present' },
      { sentence: '<span class="verb-word">Do</span> you like pizza?', type: 'present' },
      { sentence: '<span class="verb-word">Did</span> he go to school <span class="signal-word">yesterday</span>?', type: 'past' }
    ],
    rule: '‚òÄÔ∏è Hi·ªán t·∫°i: Do/Does + S + V g·ªëc?<br>üåô Qu√° kh·ª©: Did + S + V g·ªëc?'
  },
  {
    title: '‚ö†Ô∏è Ch√∫ √Ω quan tr·ªçng',
    signals: [
      { word: "He/She/It + V-s/es", vn: 'ng√¥i 3 s·ªë √≠t th√™m s', emoji: '‚òÄÔ∏è' },
      { word: "doesn't/didn't + V g·ªëc", vn: 'ph·ªß ƒë·ªãnh d√πng V g·ªëc', emoji: 'üö´' },
      { word: "Do/Does/Did + V g·ªëc", vn: 'c√¢u h·ªèi d√πng V g·ªëc', emoji: '‚ùì' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">goes</span> to school. (th√™m es)', type: 'present' },
      { sentence: 'She <span class="verb-word">doesn\'t go</span> to school. (V g·ªëc)', type: 'present' },
      { sentence: '<span class="verb-word">Does</span> she <span class="verb-word">go</span> to school? (V g·ªëc)', type: 'present' }
    ],
    rule: 'Sau don\'t/doesn\'t/didn\'t/Do/Does/Did ‚Üí lu√¥n d√πng ƒë·ªông t·ª´ G·ªêC!'
  }
];

function showContextLearn() {
  playSound('click');
  contextLearnState.currentIndex = 0;
  renderContextLearn();
}

function renderContextLearn() {
  var lesson = CONTEXT_LESSONS[contextLearnState.currentIndex];
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üìö Ng·ªØ c·∫£nh</div>' +
    '<div></div></div>' +
    
    '<div class="context-progress">' +
    'B√†i ' + (contextLearnState.currentIndex + 1) + ' / ' + CONTEXT_LESSONS.length +
    '</div>' +
    
    '<div class="context-container">' +
    '<div class="context-card">' +
    '<div class="context-title">' + lesson.title + '</div>';
  
  // Signal words
  lesson.signals.forEach(function(signal) {
    html += '<div class="context-rule">' +
      '<div class="context-emoji">' + signal.emoji + '</div>' +
      '<div class="context-text">' +
      '<div class="context-signal">' + signal.word + '</div>' +
      '<div class="context-explain">' + signal.vn + '</div>' +
      '</div></div>';
  });
  
  html += '</div>' +
    
    // Examples
    '<div class="context-example-box">' +
    '<div style="font-weight:700;margin-bottom:10px;color:#333">üìù V√≠ d·ª•:</div>';
  
  lesson.examples.forEach(function(ex) {
    html += '<div class="context-example ' + ex.type + '">' + ex.sentence + '</div>';
  });
  
  html += '<div style="margin-top:15px;padding:12px;background:#E3F2FD;border-radius:10px;text-align:center">' +
    '<strong>üìå Quy t·∫Øc:</strong><br>' + lesson.rule +
    '</div></div>' +
    
    // Navigation
    '<div class="context-nav">';
  
  if (contextLearnState.currentIndex > 0) {
    html += '<button class="context-nav-btn" style="background:#E0E0E0;color:#333" onclick="prevContextLesson()">‚Üê Tr∆∞·ªõc</button>';
  }
  
  if (contextLearnState.currentIndex < CONTEXT_LESSONS.length - 1) {
    html += '<button class="context-nav-btn" style="background:#4CAF50;color:white" onclick="nextContextLesson()">Ti·∫øp ‚Üí</button>';
  } else {
    html += '<button class="context-nav-btn" style="background:#667eea;color:white" onclick="showLearnScreen()">Ho√†n th√†nh ‚úì</button>';
  }
  
  html += '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function prevContextLesson() {
  playSound('click');
  if (contextLearnState.currentIndex > 0) {
    contextLearnState.currentIndex--;
    renderContextLearn();
  }
}

function nextContextLesson() {
  playSound('click');
  if (contextLearnState.currentIndex < CONTEXT_LESSONS.length - 1) {
    contextLearnState.currentIndex++;
    renderContextLearn();
  }
}

// ============ √îN T·∫¨P C√ÇU SAI H√îM NAY ============
var mistakeReviewState = {
  currentIndex: 0,
  score: 0,
  answered: false
};

function showTodayMistakes() {
  playSound('click');
  
  if (todayMistakes.length === 0) {
    var html = '<div class="progress-header" style="margin-bottom:15px">' +
      '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
      '<div style="color:white;font-weight:700;font-size:1.1rem">üîÑ √în c√¢u sai</div>' +
      '<div></div></div>' +
      
      '<div class="easy-match-container">' +
      '<div style="text-align:center;padding:40px 20px">' +
      '<div style="font-size:80px;margin-bottom:20px">üéâ</div>' +
      '<div style="font-size:1.5rem;font-weight:700;color:#333;margin-bottom:10px">Con ƒë√£ ho√†n th√†nh!</div>' +
      '<div style="color:#666;margin-bottom:20px">H√¥m nay con ch∆∞a c√≥ c√¢u n√†o sai.<br>H√£y ti·∫øp t·ª•c luy·ªán t·∫≠p nh√©!</div>' +
      '<button class="next-btn" onclick="startVerbSentenceQuiz()">L√†m b√†i m·ªõi üìù</button>' +
      '</div></div>';
    
    document.getElementById('learnScreen').innerHTML = html;
    showScreen('learnScreen');
    return;
  }
  
  // C√≥ c√¢u sai - hi·ªÉn th·ªã danh s√°ch
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üîÑ √în c√¢u sai</div>' +
    '<div style="background:rgba(255,255,255,0.9);padding:5px 12px;border-radius:15px;color:#F44336;font-weight:700">' + todayMistakes.length + ' c√¢u</div>' +
    '</div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üìã</div>' +
    '<div class="easy-match-title">C√¢u sai h√¥m nay</div>' +
    '<div class="easy-match-hint">√în l·∫°i nh·ªØng c√¢u con ƒë√£ l√†m sai</div>' +
    '</div>' +
    
    '<div style="margin-bottom:15px">' +
    '<button class="next-btn" onclick="startMistakeReview()" style="width:100%">√în t·∫≠p ngay üöÄ</button>' +
    '</div>' +
    
    '<div style="background:white;border-radius:15px;padding:15px">';
  
  todayMistakes.forEach(function(m, idx) {
    var icon = m.quizType === 'sentence' ? 'üìù' : 'üî§';
    var timeStr = m.timestamp || '';
    
    html += '<div style="padding:12px;border-bottom:1px solid #f0f0f0;display:flex;align-items:flex-start;gap:10px">' +
      '<div style="font-size:1.5rem">' + icon + '</div>' +
      '<div style="flex:1">' +
      '<div style="font-weight:600;color:#333;margin-bottom:4px">';
    
    if (m.quizType === 'sentence') {
      html += m.sentence.replace('___', '<span style="color:#F44336;font-weight:700">' + m.correctAnswer + '</span>');
    } else {
      html += '<span style="color:#4CAF50">' + m.verb + '</span> ‚Üí <span style="color:#F44336">' + m.correctAnswer + '</span>';
    }
    
    html += '</div>' +
      '<div style="font-size:0.85rem;color:#999">' + 
      (m.verbVn || '') + (timeStr ? ' ‚Ä¢ ' + timeStr : '') +
      '</div>' +
      '</div>' +
      '<button onclick="removeMistakeAndRefresh(' + idx + ')" style="background:none;border:none;color:#999;font-size:1.2rem;cursor:pointer" title="X√≥a">‚úï</button>' +
      '</div>';
  });
  
  html += '</div>' +
    '<button onclick="clearAllMistakes()" style="margin-top:15px;width:100%;padding:12px;background:#F5F5F5;border:none;border-radius:10px;color:#999;font-family:inherit;cursor:pointer">X√≥a t·∫•t c·∫£</button>' +
    '</div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function removeMistakeAndRefresh(index) {
  removeMistake(index);
  showTodayMistakes();
}

function clearAllMistakes() {
  if (confirm('X√≥a t·∫•t c·∫£ ' + todayMistakes.length + ' c√¢u sai?')) {
    todayMistakes = [];
    saveStarData();
    showTodayMistakes();
  }
}

function startMistakeReview() {
  playSound('click');
  
  if (todayMistakes.length === 0) {
    showTodayMistakes();
    return;
  }
  
  mistakeReviewState = {
    currentIndex: 0,
    score: 0,
    answered: false,
    mistakes: todayMistakes.slice() // Copy ƒë·ªÉ kh√¥ng ·∫£nh h∆∞·ªüng
  };
  
  renderMistakeReview();
}

function renderMistakeReview() {
  var state = mistakeReviewState;
  
  if (state.currentIndex >= state.mistakes.length) {
    showMistakeReviewResult();
    return;
  }
  
  var m = state.mistakes[state.currentIndex];
  
  // Progress dots
  var dotsHtml = '';
  for (var i = 0; i < state.mistakes.length; i++) {
    var dotClass = 'dot';
    if (i < state.currentIndex) dotClass += ' done';
    else if (i === state.currentIndex) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="showTodayMistakes()">‚Üê Back</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚úì ' + state.score + '</div>' +
    '</div>';
  
  if (m.quizType === 'sentence') {
    // Render sentence quiz
    var displaySentence = m.sentence.replace(m.signal, '<u style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:700">' + m.signal + '');
    displaySentence = displaySentence.replace('___', '<span class="blank">?</span>');
    
    html += '<div class="sentence-quiz-card">' +
      (m.emoji ? '<div style="font-size:3rem;text-align:center;margin-bottom:10px">' + m.emoji + '</div>' : '') +
      '<div style="text-align:center;margin-bottom:8px;color:#F44336;font-size:0.9rem">üîÑ √în t·∫≠p c√¢u sai</div>' +
      '<div class="sentence-quiz-sentence">' + displaySentence + '</div>' +
      '<div class="sentence-quiz-choices">';
    
    // T·∫°o choices t·ª´ correctAnswer v√† wrongAnswers
    var choices = [{ answer: m.correctAnswer, isCorrect: true }];
    
    // T·∫°o wrong answers d·ª±a v√†o type
    if (m.type === 'affirm') {
      var verbForms = getVerbForms(m.verb);
      if (m.isPast) {
        var presentForm = getPresentForm(verbForms.base, m.subject);
        if (presentForm !== m.correctAnswer) choices.push({ answer: presentForm, isCorrect: false });
      } else {
        if (verbForms.past !== m.correctAnswer) choices.push({ answer: verbForms.past, isCorrect: false });
      }
      if (verbForms.base !== m.correctAnswer && !choices.some(function(c) { return c.answer === verbForms.base; })) {
        choices.push({ answer: verbForms.base, isCorrect: false });
      }
    } else if (m.type === 'negative') {
      var negatives = ["don't", "doesn't", "didn't"];
      negatives.forEach(function(n) {
        if (n !== m.correctAnswer) choices.push({ answer: n, isCorrect: false });
      });
    } else if (m.type === 'question' || m.type === 'question_verb') {
      var verbForms = getVerbForms(m.verb);
      if (verbForms.past !== m.correctAnswer && !choices.some(function(c) { return c.answer === verbForms.past; })) {
        choices.push({ answer: verbForms.past, isCorrect: false });
      }
      var vPresent = getPresentForm(verbForms.base, 'She');
      if (vPresent !== m.correctAnswer && !choices.some(function(c) { return c.answer === vPresent; })) {
        choices.push({ answer: vPresent, isCorrect: false });
      }
    }
    
    // N·∫øu ch∆∞a ƒë·ªß ƒë√°p √°n (do no-change verb), th√™m t·ª´ nhi·ªÖu
    var distractors = ['went', 'goes', 'ate', 'eats', 'took', 'takes', 'saw', 'sees', 'came', 'comes'];
    var di = 0;
    while (choices.length < 4 && di < distractors.length) {
      if (distractors[di] !== m.correctAnswer && !choices.some(function(c) { return c.answer === distractors[di]; })) {
        choices.push({ answer: distractors[di], isCorrect: false });
      }
      di++;
    }
    
    // Shuffle v√† hi·ªÉn th·ªã
    choices = shuffle(choices).slice(0, 4);
    var correctIdx = -1;
    choices.forEach(function(c, idx) {
      if (c.isCorrect) correctIdx = idx;
      html += '<button class="sentence-choice-btn" id="mr-choice-' + idx + '" onclick="checkMistakeReviewAnswer(' + idx + ', ' + c.isCorrect + ')">' + c.answer + '</button>';
    });
    mistakeReviewState.correctIdx = correctIdx;
    
    html += '</div><div id="mistakeReviewFeedback"></div></div>';
    
  } else {
    // Render verb form quiz
    html += '<div class="sentence-quiz-card">' +
      '<div style="text-align:center;margin-bottom:8px;color:#F44336;font-size:0.9rem">üîÑ √în t·∫≠p c√¢u sai</div>' +
      '<div style="font-size:1.2rem;color:#666;margin-bottom:10px">D·∫°ng ' + (m.mode === 'past' ? 'qu√° kh·ª© (V2)' : 'ph√¢n t·ª´ (V3)') + ' c·ªßa:</div>' +
      '<div style="font-size:2.5rem;font-weight:800;color:#4CAF50;margin:20px 0">' + m.verb + '</div>' +
      '<div style="color:#999;margin-bottom:20px">' + m.verbVn + '</div>' +
      '<input type="text" id="mrVerbInput" class="quiz-input" placeholder="Nh·∫≠p ƒë√°p √°n..." onkeypress="if(event.key===\'Enter\')checkMistakeReviewVerbAnswer()">' +
      '<div id="mistakeReviewFeedback" style="margin-top:15px"></div>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
  
  // Focus v√†o input n·∫øu c√≥
  var input = document.getElementById('mrVerbInput');
  if (input) input.focus();
}

function checkMistakeReviewAnswer(choiceIdx, isCorrect) {
  if (mistakeReviewState.answered) return;
  mistakeReviewState.answered = true;
  
  var m = mistakeReviewState.mistakes[mistakeReviewState.currentIndex];
  var correctIdx = mistakeReviewState.correctIdx;
  
  document.querySelectorAll('.sentence-choice-btn').forEach(function(btn, idx) {
    btn.disabled = true;
    if (idx === choiceIdx && isCorrect) btn.classList.add('correct');
    else if (idx === choiceIdx && !isCorrect) btn.classList.add('wrong');
    if (idx === correctIdx && !isCorrect) btn.classList.add('show-correct');
  });
  
  if (isCorrect) {
    mistakeReviewState.score++;
    playSound('correct');
    // X√≥a c√¢u n√†y kh·ªèi danh s√°ch sai v√¨ ƒë√£ tr·∫£ l·ªùi ƒë√∫ng
    var originalIdx = todayMistakes.findIndex(function(tm) {
      return tm.sentence === m.sentence && tm.correctAnswer === m.correctAnswer;
    });
    if (originalIdx >= 0) removeMistake(originalIdx);
  } else {
    playSound('wrong');
  }
  
  var explanation = m.isPast ? 
    'üåô <strong>' + m.signal + '</strong> ‚Üí qu√° kh·ª©: <strong>' + m.correctAnswer + '</strong>' :
    '‚òÄÔ∏è <strong>' + m.signal + '</strong> ‚Üí hi·ªán t·∫°i: <strong>' + m.correctAnswer + '</strong>';
  
  var feedbackHtml = '<div class="sentence-feedback ' + (isCorrect ? 'correct' : 'wrong') + '">' +
    '<div class="emoji">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="message">' + (isCorrect ? 'ƒê√∫ng r·ªìi! ƒê√£ x√≥a kh·ªèi danh s√°ch sai.' : 'V·∫´n ch∆∞a ƒë√∫ng, c·ªë g·∫Øng th√™m nh√©!') + '</div>' +
    '<div class="explanation">' + explanation + '</div>' +
    '<button class="next-btn" onclick="nextMistakeReview()">' +
    (mistakeReviewState.currentIndex < mistakeReviewState.mistakes.length - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  document.getElementById('mistakeReviewFeedback').innerHTML = feedbackHtml;
}

function checkMistakeReviewVerbAnswer() {
  if (mistakeReviewState.answered) return;
  
  var input = document.getElementById('mrVerbInput');
  var userAnswer = input.value.trim().toLowerCase();
  var m = mistakeReviewState.mistakes[mistakeReviewState.currentIndex];
  
  var correctAnswers = m.correctAnswer.toLowerCase().split('/').map(function(a) { return a.trim(); });
  var isCorrect = correctAnswers.indexOf(userAnswer) >= 0;
  
  mistakeReviewState.answered = true;
  input.disabled = true;
  input.classList.add(isCorrect ? 'correct' : 'wrong');
  
  if (isCorrect) {
    mistakeReviewState.score++;
    playSound('correct');
    var originalIdx = todayMistakes.findIndex(function(tm) {
      return tm.verb === m.verb && tm.correctAnswer === m.correctAnswer;
    });
    if (originalIdx >= 0) removeMistake(originalIdx);
  } else {
    playSound('wrong');
  }
  
  var feedbackHtml = '<div class="sentence-feedback ' + (isCorrect ? 'correct' : 'wrong') + '">' +
    '<div class="emoji">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="message">' + (isCorrect ? 'ƒê√∫ng r·ªìi! ƒê√£ x√≥a kh·ªèi danh s√°ch sai.' : 'ƒê√°p √°n ƒë√∫ng: ' + m.correctAnswer) + '</div>' +
    '<button class="next-btn" onclick="nextMistakeReview()">' +
    (mistakeReviewState.currentIndex < mistakeReviewState.mistakes.length - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  document.getElementById('mistakeReviewFeedback').innerHTML = feedbackHtml;
}

function nextMistakeReview() {
  mistakeReviewState.currentIndex++;
  mistakeReviewState.answered = false;
  renderMistakeReview();
}

function showMistakeReviewResult() {
  var state = mistakeReviewState;
  var total = state.mistakes.length;
  var percentage = Math.round((state.score / total) * 100);
  
  var emoji = percentage >= 80 ? 'üèÜ' : percentage >= 50 ? '‚≠ê' : 'üí™';
  var message = percentage >= 80 ? 'Luy·ªán t·∫≠p c√≥ hi·ªáu qu·∫£! Con nh·ªõ t·ªët h∆°n r·ªìi!' : 
                percentage >= 50 ? 'Kh√° t·ªët! Ti·∫øp t·ª•c √¥n t·∫≠p nh√©!' : 
                'C·∫ßn √¥n th√™m m·ªôt ch√∫t n·ªØa!';
  
  var remainingCount = todayMistakes.length;
  
  var html = '<div class="result-content"><div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + message + '</div>' +
    '<div style="font-size:2.5rem;font-weight:800;color:#667eea;margin:15px 0">' + state.score + ' / ' + total + '</div>' +
    '<div style="color:#666;margin-bottom:10px">' + percentage + '% ch√≠nh x√°c</div>' +
    (remainingCount > 0 ? 
      '<div style="background:#FFF3E0;padding:10px;border-radius:10px;margin-bottom:15px;color:#E65100">C√≤n ' + remainingCount + ' c√¢u c·∫ßn √¥n l·∫°i</div>' :
      '<div style="background:#E8F5E9;padding:10px;border-radius:10px;margin-bottom:15px;color:#2E7D32">üéâ ƒê√£ ho√†n th√†nh t·∫•t c·∫£!</div>') +
    '<div class="result-buttons">' +
    (remainingCount > 0 ? '<button class="result-btn primary" onclick="startMistakeReview()">√în ti·∫øp üîÑ</button>' : '') +
    '<button class="result-btn ' + (remainingCount > 0 ? 'secondary' : 'primary') + '" onclick="startVerbSentenceQuiz()">L√†m b√†i m·ªõi üìù</button>' +
    '<button class="result-btn secondary" onclick="showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
  
  playSound('complete');
  if (percentage >= 70) showConfetti();
}

// =====================================================
// PRESENT PERFECT QUIZ
// =====================================================
const ppQuestions = [
  { cat:'havhas', q:'üêπ My hamster _____ eaten my homework!', opts:['have','has','is','did'], ans:1, hint:'Chu·ªôt hamster ƒë√£ ƒÉn b√†i t·∫≠p c·ªßa t√¥i!', explain:'My hamster = It ‚Üí has' },
  { cat:'v3', q:'üçº The baby has _____ milk on my face! (throw)', opts:['threw','thrown','throwed','throwing'], ans:1, hint:'Em b√© n√©m s·ªØa l√™n m·∫∑t t√¥i!', explain:'throw ‚Üí threw ‚Üí thrown' },
  { cat:'signal', q:'üï∑Ô∏è A spider has _____ crawled into my shoe!', opts:['just','yet','ever','already'], ans:0, hint:'Con nh·ªán V·ª™A M·ªöI b√≤ v√†o gi√†y t√¥i!', explain:'just = v·ª´a m·ªõi (v·ª´a x·∫£y ra!)' },
  { cat:'sinfor', q:'üöΩ The toilet has been broken _____ 3 days!', opts:['since','for','from','during'], ans:1, hint:'Toilet h·ªèng 3 ng√†y r·ªìi!', explain:'"3 days" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'ü™≥ I _____ a cockroach in my soup yesterday!', opts:['have found','found','has found','find'], ans:1, hint:'T√¥i th·∫•y con gi√°n trong s√∫p h√¥m qua!', explain:'"yesterday" = qu√° kh·ª© c·ª• th·ªÉ ‚Üí Past Simple' },
  { cat:'neg', q:'üß¶ Mom _____ washed my smelly socks yet!', opts:["hasn't","haven't","didn't","isn't"], ans:0, hint:'M·∫π ch∆∞a gi·∫∑t ƒë√¥i t·∫•t th·ªëi!', explain:'Mom = She ‚Üí hasn\'t' },
  { cat:'ques', q:'üêå _____ you ever stepped on a snail?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù d·∫´m ph·∫£i ·ªëc s√™n ch∆∞a?', explain:'You ‚Üí Have you ever...?' },
  { cat:'havhas', q:'üê¶ The bird _____ pooped on my head!', opts:['have','has','is','was'], ans:1, hint:'Con chim ƒë√£ ·ªã l√™n ƒë·∫ßu t√¥i!', explain:'The bird = It ‚Üí has' },
  { cat:'v3', q:'üêï My dog has _____ my shoe again! (bite)', opts:['bited','bitten','bit','bites'], ans:1, hint:'Con ch√≥ l·∫°i c·∫Øn gi√†y t√¥i n·ªØa!', explain:'bite ‚Üí bit ‚Üí bitten' },
  { cat:'signal', q:'ü™± Have you _____ eaten a worm?', opts:['ever','never','yet','already'], ans:0, hint:'B·∫°n ƒë√£ t·ª´ng ƒÉn giun ch∆∞a?', explain:'ever = ƒë√£ t·ª´ng (c√¢u h·ªèi)' },
  { cat:'sinfor', q:'ü§¢ My brother has burped _____ 10 minutes!', opts:['since','for','during','from'], ans:1, hint:'Anh t√¥i ·ª£ su·ªët 10 ph√∫t r·ªìi!', explain:'"10 minutes" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üê∏ She _____ never touched a frog before.', opts:['has','did','is','was'], ans:0, hint:'C√¥ ·∫•y ch∆∞a bao gi·ªù s·ªù con ·∫øch.', explain:'never ‚Üí Present Perfect (has never)' },
  { cat:'havhas', q:'üò± We _____ forgotten our teacher\'s name!', opts:['have','has','did','are'], ans:0, hint:'Ch√∫ng t√¥i qu√™n t√™n c√¥ gi√°o!', explain:'We ‚Üí have' },
  { cat:'v3', q:'üç™ Someone has _____ all the cookies! (steal)', opts:['stealed','stole','stolen','stealing'], ans:2, hint:'Ai ƒë√≥ ƒë√£ ƒÉn tr·ªôm h·∫øt b√°nh quy!', explain:'steal ‚Üí stole ‚Üí stolen' },
  { cat:'signal', q:'üòÅ I have _____ brushed my teeth. Bedtime!', opts:['already','yet','never','ever'], ans:0, hint:'T√¥i ƒë√°nh rƒÉng r·ªìi. ƒêi ng·ªß th√¥i!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'sinfor', q:'ü§≠ She has hiccupped _____ lunch time!', opts:['since','for','from','at'], ans:0, hint:'C√¥ ·∫•y n·∫•c t·ª´ gi·ªù ƒÉn tr∆∞a!', explain:'"lunch time" = m·ªëc th·ªùi gian ‚Üí since' },
  { cat:'vs', q:'üêí The monkey _____ my banana 2 hours ago!', opts:['has stolen','stole','have stolen','steals'], ans:1, hint:'Con kh·ªâ l·∫•y chu·ªëi t√¥i 2 ti·∫øng tr∆∞·ªõc!', explain:'"2 hours ago" = qu√° kh·ª© c·ª• th·ªÉ ‚Üí Past Simple' },
  { cat:'neg', q:'ü•¶ I _____ finished my broccoli yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'T√¥i ch∆∞a ƒÉn h·∫øt b√¥ng c·∫£i xanh.', explain:'I ‚Üí haven\'t' },
  { cat:'ques', q:'üê±üêü _____ the cat eaten the goldfish?', opts:['Have','Has','Does','Did'], ans:1, hint:'Con m√®o ƒë√£ ƒÉn c√° v√†ng ch∆∞a?', explain:'The cat = It ‚Üí Has' },
  { cat:'havhas', q:'üñçÔ∏è My little sister _____ drawn on the wall!', opts:['have','has','is','does'], ans:1, hint:'Em g√°i t√¥i ƒë√£ v·∫Ω l√™n t∆∞·ªùng!', explain:'My little sister = She ‚Üí has' },
  { cat:'v3', q:'üçå Dad has _____ on a banana peel! (fall)', opts:['fell','fallen','falled','falling'], ans:1, hint:'B·ªë ƒë√£ tr∆∞·ª£t v·ªè chu·ªëi!', explain:'fall ‚Üí fell ‚Üí fallen' },
  { cat:'signal', q:'üëª I have _____ seen a ghost in my life!', opts:['ever','never','just','already'], ans:1, hint:'T√¥i ch∆∞a BAO GI·ªú th·∫•y ma!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'sinfor', q:'üò¥ Grandpa has snored _____ 9 PM!', opts:['since','for','from','at'], ans:0, hint:'√îng ng√°y t·ª´ 9 gi·ªù t·ªëi!', explain:'"9 PM" = m·ªëc th·ªùi gian ‚Üí since' },
  { cat:'vs', q:'üèñÔ∏è They _____ already built a sandcastle.', opts:['have','did','are','were'], ans:0, hint:'H·ªç ƒë√£ x√¢y l√¢u ƒë√†i c√°t r·ªìi.', explain:'already ‚Üí Present Perfect (have already)' },
  { cat:'havhas', q:'üêí The monkeys _____ escaped from the zoo!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con kh·ªâ ƒë√£ tr·ªën kh·ªèi v∆∞·ªùn th√∫!', explain:'The monkeys = They ‚Üí have' },
  { cat:'v3', q:'üí© He has _____ in the mud! (swim)', opts:['swam','swimmed','swum','swimming'], ans:2, hint:'Anh ·∫•y ƒë√£ b∆°i trong b√πn!', explain:'swim ‚Üí swam ‚Üí swum' },
  { cat:'signal', q:'üìù Has she done her homework _____?', opts:['already','just','yet','never'], ans:2, hint:'C√¥ ·∫•y l√†m b√†i t·∫≠p xong CH∆ØA?', explain:'yet = ch∆∞a (cu·ªëi c√¢u h·ªèi)' },
  { cat:'sinfor', q:'ü§Æ The fridge has smelled bad _____ a week!', opts:['since','for','during','from'], ans:1, hint:'T·ªß l·∫°nh h√¥i c·∫£ tu·∫ßn r·ªìi!', explain:'"a week" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üï∏Ô∏è I _____ into a spider web this morning!', opts:['have walked','walked','has walked','walking'], ans:1, hint:'T√¥i ƒëi v√†o m·∫°ng nh·ªán s√°ng nay!', explain:'"this morning" + xong r·ªìi ‚Üí Past Simple' },
  { cat:'neg', q:'üê† They _____ cleaned the fish tank yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'H·ªç ch∆∞a r·ª≠a b·ªÉ c√°!', explain:'They ‚Üí haven\'t' },
  { cat:'ques', q:'üï∑Ô∏è How long _____ you had that pet spider?', opts:['have','has','do','did'], ans:0, hint:'B·∫°n nu√¥i nh·ªán bao l√¢u r·ªìi?', explain:'You ‚Üí have' },
  { cat:'havhas', q:'üéÇ My grandma _____ baked 100 cakes!', opts:['have','has','is','did'], ans:1, hint:'B√† t√¥i ƒë√£ n∆∞·ªõng 100 c√°i b√°nh!', explain:'My grandma = She ‚Üí has' },
  { cat:'v3', q:'üï≥Ô∏è The dog has _____ a hole in the garden! (dig)', opts:['digged','dug','dig','diging'], ans:1, hint:'Con ch√≥ ƒë√†o h·ªë ngo√†i v∆∞·ªùn!', explain:'dig ‚Üí dug ‚Üí dug' },
  { cat:'signal', q:'ü¶∑ My tooth has _____ fallen out! Look!', opts:['just','yet','ever','never'], ans:0, hint:'RƒÉng t√¥i V·ª™A r·ª•ng! Nh√¨n k√¨a!', explain:'just = v·ª´a m·ªõi' },
  { cat:'sinfor', q:'üë∂ The baby has cried _____ this morning!', opts:['since','for','from','during'], ans:0, hint:'Em b√© kh√≥c t·ª´ s√°ng t·ªõi gi·ªù!', explain:'"this morning" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üéÉ We _____ to the haunted house last Halloween!', opts:['have gone','went','has gone','going'], ans:1, hint:'B·ªçn t√¥i ƒëi nh√† ma Halloween nƒÉm ngo√°i!', explain:'"last Halloween" ‚Üí Past Simple' },
  { cat:'havhas', q:'üëΩ Aliens _____ landed in my garden!', opts:['have','has','are','did'], ans:0, hint:'Ng∆∞·ªùi ngo√†i h√†nh tinh ƒë√°p ·ªü v∆∞·ªùn t√¥i!', explain:'Aliens = They ‚Üí have' },
  { cat:'v3', q:'ü§™ She has _____ a funny face! (make)', opts:['maked','made','make','making'], ans:1, hint:'C√¥ ·∫•y ƒë√£ l√†m m·∫∑t x·∫•u!', explain:'make ‚Üí made ‚Üí made' },
  { cat:'signal', q:'üõÅ I haven\'t taken a bath _____.', opts:['already','just','yet','never'], ans:2, hint:'T√¥i ch∆∞a t·∫Øm.', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'sinfor', q:'üéÆ He has played video games _____ 5 hours!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y ch∆°i game 5 ti·∫øng r·ªìi!', explain:'"5 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üêâ She _____ already fed the dragon.', opts:['has','did','is','was'], ans:0, hint:'C√¥ ·∫•y ƒë√£ cho r·ªìng ƒÉn r·ªìi.', explain:'already ‚Üí Present Perfect' },
  { cat:'neg', q:'üçï The pizza _____ arrived yet! I\'m starving!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Pizza ch∆∞a ƒë·∫øn! ƒê√≥i qu√°!', explain:'The pizza = It ‚Üí hasn\'t' },
  { cat:'ques', q:'ü¶ó _____ they ever eaten fried insects?', opts:['Have','Has','Are','Did'], ans:0, hint:'H·ªç ƒë√£ t·ª´ng ƒÉn c√¥n tr√πng chi√™n ch∆∞a?', explain:'They ‚Üí Have they...?' },
  { cat:'havhas', q:'üßü My teacher _____ turned into a zombie!', opts:['have','has','is','did'], ans:1, hint:'C√¥ gi√°o t√¥i bi·∫øn th√†nh zombie!', explain:'My teacher = She/He ‚Üí has' },
  { cat:'v3', q:'üí® We have _____ a song about farts! (sing)', opts:['sang','sung','singed','singing'], ans:1, hint:'Ch√∫ng t√¥i h√°t b√†i v·ªÅ... x√¨ h∆°i!', explain:'sing ‚Üí sang ‚Üí sung' },
  { cat:'signal', q:'üëÉ Have you _____ picked your nose in class?', opts:['ever','never','already','just'], ans:0, hint:'B·∫°n c√≥ BAO GI·ªú ngo√°y m≈©i trong l·ªõp kh√¥ng?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'sinfor', q:'üß¶ My socks have been stinky _____ Monday!', opts:['since','for','from','during'], ans:0, hint:'T·∫•t t√¥i th·ªëi t·ª´ th·ª© Hai!', explain:'"Monday" = m·ªëc th·ªùi gian ‚Üí since' },
  { cat:'vs', q:'üëª The ghost _____ at midnight yesterday!', opts:['has appeared','appeared','have appeared','appears'], ans:1, hint:'Con ma xu·∫•t hi·ªán l√∫c n·ª≠a ƒë√™m h√¥m qua!', explain:'"yesterday" ‚Üí Past Simple' },
  { cat:'havhas', q:'üëñ My pants _____ ripped at school!', opts:['have','has','are','did'], ans:0, hint:'Qu·∫ßn t√¥i b·ªã r√°ch ·ªü tr∆∞·ªùng!', explain:'My pants = They ‚Üí have' },
  { cat:'v3', q:'ü™ü The bird has _____ into the window! (fly)', opts:['flew','flown','flyed','flying'], ans:1, hint:'Con chim bay ƒë√¢m v√†o c·ª≠a s·ªï!', explain:'fly ‚Üí flew ‚Üí flown' },
  { cat:'neg', q:'ü§¢ He _____ washed his hands yet! Eww!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Anh ·∫•y ch∆∞a r·ª≠a tay! Gh√™ qu√°!', explain:'He ‚Üí hasn\'t' },
  { cat:'signal', q:'üê≠ Look! The cat has _____ caught a mouse!', opts:['just','yet','never','ever'], ans:0, hint:'Nh√¨n k√¨a! M√®o V·ª™A b·∫Øt ƒë∆∞·ª£c chu·ªôt!', explain:'just = v·ª´a m·ªõi' },
  { cat:'sinfor', q:'ü§£ We have laughed _____ two hours!', opts:['since','for','from','during'], ans:1, hint:'Ch√∫ng t√¥i c∆∞·ªùi 2 ti·∫øng r·ªìi!', explain:'"two hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üêò I _____ never ridden an elephant before!', opts:['have','did','was','am'], ans:0, hint:'T√¥i ch∆∞a bao gi·ªù c∆∞·ª°i voi!', explain:'never ‚Üí Present Perfect' },
  { cat:'ques', q:'üî§ _____ he ever burped the alphabet?', opts:['Have','Has','Does','Did'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù ·ª£ ra b·∫£ng ch·ªØ c√°i ch∆∞a?', explain:'He ‚Üí Has he...?' },
  { cat:'havhas', q:'üêô The octopus _____ hugged the diver!', opts:['have','has','is','did'], ans:1, hint:'Con b·∫°ch tu·ªôc ƒë√£ √¥m th·ª£ l·∫∑n!', explain:'The octopus = It ‚Üí has' },
  { cat:'v3', q:'üç¶ I have _____ my ice cream on the floor! (drop)', opts:['droped','dropped','drop','dropping'], ans:1, hint:'T√¥i l√†m r∆°i kem xu·ªëng ƒë·∫•t!', explain:'drop ‚Üí dropped ‚Üí dropped (nh√¢n ƒë√¥i p!)' },
  { cat:'signal', q:'üç© She has _____ eaten 10 donuts! Still hungry!', opts:['already','yet','never','ever'], ans:0, hint:'C√¥ ·∫•y ƒê√É ƒÉn 10 c√°i donut! V·∫´n ƒë√≥i!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'sinfor', q:'ü¶ú The parrot has talked _____ I woke up!', opts:['since','for','from','while'], ans:0, hint:'Con v·∫πt n√≥i t·ª´ khi t√¥i d·∫≠y!', explain:'"I woke up" = m·ªëc th·ªùi gian ‚Üí since' },
  { cat:'vs', q:'üõ∏ A UFO _____ over my house last night!', opts:['has flown','flew','have flown','fly'], ans:1, hint:'UFO bay qua nh√† t√¥i t·ªëi qua!', explain:'"last night" ‚Üí Past Simple' },
  { cat:'havhas', q:'ü§ñ My brother and I _____ built a robot!', opts:['have','has','are','did'], ans:0, hint:'Anh t√¥i v√† t√¥i ƒë√£ ch·∫ø robot!', explain:'My brother and I = We ‚Üí have' },
  { cat:'v3', q:'ü§• She has _____ to me! So angry! (lie)', opts:['lied','lain','lay','lying'], ans:0, hint:'C√¥ ·∫•y n√≥i d·ªëi t√¥i! Gi·∫≠n qu√°!', explain:'lie (n√≥i d·ªëi) ‚Üí lied ‚Üí lied' },
  { cat:'neg', q:'üí∞ We _____ found the buried treasure yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Ch√∫ng t√¥i ch∆∞a t√¨m th·∫•y kho b√°u!', explain:'We ‚Üí haven\'t' },
  { cat:'ques', q:'üåü _____ your mom ever met a celebrity?', opts:['Have','Has','Did','Does'], ans:1, hint:'M·∫π b·∫°n ƒë√£ g·∫∑p ng∆∞·ªùi n·ªïi ti·∫øng ch∆∞a?', explain:'Your mom = She ‚Üí Has' },
  { cat:'v3', q:'üëñ He has _____ his pants at school! (tear)', opts:['teared','torn','tore','tearing'], ans:1, hint:'Anh ·∫•y r√°ch qu·∫ßn ·ªü tr∆∞·ªùng!', explain:'tear ‚Üí tore ‚Üí torn' },
  { cat:'sinfor', q:'üöΩ Dad has been in the bathroom _____ 30 minutes!', opts:['since','for','from','during'], ans:1, hint:'B·ªë ·ªü trong toilet 30 ph√∫t r·ªìi!', explain:'"30 minutes" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'signal', q:'ü§î I have _____ tried durian! Is it good?', opts:['never','ever','just','already'], ans:0, hint:'T√¥i CH∆ØA BAO GI·ªú th·ª≠ s·∫ßu ri√™ng!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'vs', q:'üêï The dog _____ into the pool 5 minutes ago!', opts:['has jumped','jumped','have jumped','jumps'], ans:1, hint:'Con ch√≥ nh·∫£y v√†o h·ªì b∆°i 5 ph√∫t tr∆∞·ªõc!', explain:'"5 minutes ago" ‚Üí Past Simple' },
  { cat:'havhas', q:'üêü My fish _____ learned to do tricks!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con c√° ƒë√£ h·ªçc l√†m tr√≤!', explain:'My fish (nhi·ªÅu con) = They ‚Üí have' },
  { cat:'v3', q:'üç´ They have _____ all the chocolate! (eat)', opts:['ate','eaten','eated','eating'], ans:1, hint:'H·ªç ƒë√£ ƒÉn h·∫øt socola!', explain:'eat ‚Üí ate ‚Üí eaten' },
  { cat:'signal', q:'üßπ She hasn\'t cleaned her room _____!', opts:['already','just','yet','never'], ans:2, hint:'C√¥ ·∫•y CH∆ØA d·ªçn ph√≤ng!', explain:'yet = ch∆∞a (cu·ªëi c√¢u ph·ªß ƒë·ªãnh)' },

  // === MORE HORRIBLE MIX ===
  { cat:'havhas', q:'ü¶à A shark _____ eaten my surfboard!', opts:['have','has','is','did'], ans:1, hint:'C√° m·∫≠p ƒÉn v√°n l∆∞·ªõt s√≥ng!', explain:'A shark = It ‚Üí has' },
  { cat:'v3', q:'üß™ The scientist has _____ a monster! (create)', opts:['created','create','creating','creates'], ans:0, hint:'Nh√† khoa h·ªçc ƒë√£ t·∫°o ra qu√°i v·∫≠t!', explain:'create ‚Üí created ‚Üí created (quy t·∫Øc)' },
  { cat:'signal', q:'üéÇ Have you _____ eaten a cake with worms?', opts:['ever','never','already','just'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù ƒÉn b√°nh c√≥ giun ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'sinfor', q:'üêä The crocodile has lived here _____ 100 years!', opts:['since','for','from','during'], ans:1, hint:'Con c√° s·∫•u s·ªëng ·ªü ƒë√¢y 100 nƒÉm!', explain:'"100 years" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üßô The wizard _____ into a frog last Friday!', opts:['has turned','turned','have turned','turns'], ans:1, hint:'Ph√π th·ªßy bi·∫øn th√†nh ·∫øch th·ª© S√°u!', explain:'"last Friday" ‚Üí Past Simple' },
  { cat:'neg', q:'ü¶∑ The dentist _____ pulled my tooth yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Nha sƒ© ch∆∞a nh·ªï rƒÉng t√¥i!', explain:'The dentist = He/She ‚Üí hasn\'t' },
  { cat:'ques', q:'üé™ _____ the clown ever fallen off the stage?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh h·ªÅ ƒë√£ bao gi·ªù ng√£ kh·ªèi s√¢n kh·∫•u?', explain:'The clown = He ‚Üí Has' },
  { cat:'havhas', q:'üêç Two snakes _____ crawled into our kitchen!', opts:['have','has','are','did'], ans:0, hint:'Hai con r·∫Øn b√≤ v√†o b·∫øp!', explain:'Two snakes = They ‚Üí have' },
  { cat:'v3', q:'üé∏ He has _____ his guitar in half! (break)', opts:['broke','broken','breaked','breaking'], ans:1, hint:'Anh ·∫•y ƒë√£ b·∫ª g√£y ƒë√†n guitar!', explain:'break ‚Üí broke ‚Üí broken' },
  { cat:'signal', q:'üç∞ The guests have _____ eaten all the food!', opts:['already','yet','ever','never'], ans:0, hint:'Kh√°ch ƒê√É ƒÉn h·∫øt ƒë·ªì ƒÉn r·ªìi!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'sinfor', q:'ü¶† He has been sick _____ last Wednesday.', opts:['since','for','from','during'], ans:0, hint:'Anh ·∫•y b·ªánh t·ª´ th·ª© T∆∞ tr∆∞·ªõc!', explain:'"last Wednesday" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üêù A bee _____ me on the nose 10 minutes ago!', opts:['has stung','stung','have stung','stings'], ans:1, hint:'Con ong ƒë·ªët m≈©i t√¥i 10 ph√∫t tr∆∞·ªõc!', explain:'"10 minutes ago" ‚Üí Past Simple' },
  { cat:'havhas', q:'ü¶ú My parrot _____ learned to say "homework"!', opts:['have','has','is','did'], ans:1, hint:'Con v·∫πt h·ªçc n√≥i "homework"!', explain:'My parrot = It ‚Üí has' },
  { cat:'v3', q:'üè† Someone has _____ our doorbell and run away! (ring)', opts:['rang','rung','ringed','ringing'], ans:1, hint:'Ai ƒë√≥ b·∫•m chu√¥ng r·ªìi ch·∫°y m·∫•t!', explain:'ring ‚Üí rang ‚Üí rung' },
  { cat:'neg', q:'üßä The ice cream _____ melted yet! Hurry!', opts:["hasn't","haven't","didn't","isn't"], ans:0, hint:'Kem ch∆∞a tan! Nhanh l√™n!', explain:'The ice cream = It ‚Üí hasn\'t' },
  { cat:'signal', q:'üêî The chicken has _____ laid an egg! Look!', opts:['just','yet','ever','never'], ans:0, hint:'Con g√† V·ª™A ƒë·∫ª tr·ª©ng! Nh√¨n k√¨a!', explain:'just = v·ª´a m·ªõi' },
  { cat:'sinfor', q:'üß∏ She has kept that teddy bear _____ she was 2!', opts:['since','for','from','when'], ans:0, hint:'C√¥ ·∫•y gi·ªØ g·∫•u b√¥ng t·ª´ khi 2 tu·ªïi!', explain:'"she was 2" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üåä We _____ to the beach every summer so far.', opts:['have gone','went','has gone','go'], ans:0, hint:'H√® n√†o ch√∫ng t√¥i c≈©ng ƒëi bi·ªÉn.', explain:'"so far" = ƒë·∫øn nay ‚Üí Present Perfect' },
  { cat:'ques', q:'üêõ _____ you ever found a bug in your food?', opts:['Have','Has','Did','Do'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù t√¨m th·∫•y s√¢u trong ƒë·ªì ƒÉn?', explain:'You ‚Üí Have' },
  { cat:'havhas', q:'üßô‚Äç‚ôÄÔ∏è The witch _____ turned the prince into a toad!', opts:['have','has','is','did'], ans:1, hint:'Ph√π th·ªßy bi·∫øn ho√†ng t·ª≠ th√†nh c√≥c!', explain:'The witch = She ‚Üí has' },
  { cat:'v3', q:'üè´ We have _____ to school in our pajamas! (go)', opts:['went','gone','goed','going'], ans:1, hint:'Ch√∫ng t√¥i ƒëi h·ªçc b·∫±ng ƒë·ªì ng·ªß!', explain:'go ‚Üí went ‚Üí gone' },
  { cat:'signal', q:'üéÉ I have _____ been so scared in my life!', opts:['never','ever','just','already'], ans:0, hint:'T√¥i ch∆∞a BAO GI·ªú s·ª£ th·∫ø!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'sinfor', q:'üê∂ My dog has barked _____ 6 AM!', opts:['since','for','from','at'], ans:0, hint:'Con ch√≥ s·ªßa t·ª´ 6 gi·ªù s√°ng!', explain:'"6 AM" = m·ªëc th·ªùi gian ‚Üí since' },
  { cat:'vs', q:'üéÅ She _____ already opened all her presents.', opts:['has','did','is','was'], ans:0, hint:'C√¥ ·∫•y ƒë√£ m·ªü h·∫øt qu√† r·ªìi.', explain:'already ‚Üí Present Perfect' },
  { cat:'neg', q:'üåßÔ∏è It _____ stopped raining yet!', opts:["hasn't","haven't","didn't","isn't"], ans:0, hint:'Tr·ªùi ch∆∞a ng·ª´ng m∆∞a!', explain:'It ‚Üí hasn\'t' },
  { cat:'v3', q:'üê¥ The horse has _____ over the fence! (jump)', opts:['jumped','jumps','jumping','jump'], ans:0, hint:'Con ng·ª±a ƒë√£ nh·∫£y qua h√†ng r√†o!', explain:'jump ‚Üí jumped ‚Üí jumped (quy t·∫Øc)' },
  { cat:'havhas', q:'ü¶ä The foxes _____ stolen all our chickens!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con c√°o ƒÉn tr·ªôm h·∫øt g√†!', explain:'The foxes = They ‚Üí have' },
  { cat:'ques', q:'üçù _____ he ever put ketchup on spaghetti?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y bao gi·ªù cho ketchup v√†o m√¨ ch∆∞a?', explain:'He ‚Üí Has' },
  { cat:'signal', q:'üèä She has _____ jumped into the pool fully dressed!', opts:['just','yet','never','ever'], ans:0, hint:'C√¥ ·∫•y V·ª™A nh·∫£y xu·ªëng h·ªì c√≤n nguy√™n qu·∫ßn √°o!', explain:'just = v·ª´a m·ªõi' },
  { cat:'sinfor', q:'üìû He has talked on the phone _____ 2 hours!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y n√≥i ƒëi·ªán tho·∫°i 2 ti·∫øng r·ªìi!', explain:'"2 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'ü¶ï Dinosaurs _____ millions of years ago.', opts:['have lived','lived','has lived','live'], ans:1, hint:'Kh·ªßng long s·ªëng h√†ng tri·ªáu nƒÉm tr∆∞·ªõc.', explain:'"millions of years ago" ‚Üí Past Simple' },
  { cat:'havhas', q:'üßë‚Äçüç≥ The chef _____ burned the dinner again!', opts:['have','has','is','did'], ans:1, hint:'ƒê·∫ßu b·∫øp l·∫°i ch√°y b·ªØa t·ªëi!', explain:'The chef = He/She ‚Üí has' },
  { cat:'v3', q:'üíç She has _____ her ring down the drain! (lose)', opts:['losed','lost','lose','losing'], ans:1, hint:'C√¥ ·∫•y l√†m r∆°i nh·∫´n xu·ªëng c·ªëng!', explain:'lose ‚Üí lost ‚Üí lost' },
  { cat:'neg', q:'üëª We _____ caught the ghost yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Ch√∫ng t√¥i ch∆∞a b·∫Øt ƒë∆∞·ª£c con ma!', explain:'We ‚Üí haven\'t' },
  { cat:'signal', q:'üßÅ Has anyone _____ tried my special cupcakes?', opts:['ever','never','just','already'], ans:0, hint:'C√≥ ai ƒë√£ t·ª´ng th·ª≠ cupcake ƒë·∫∑c bi·ªát ch∆∞a?', explain:'ever = ƒë√£ t·ª´ng (c√¢u h·ªèi)' },
  { cat:'sinfor', q:'üéπ She has practiced piano _____ 3 PM!', opts:['since','for','from','at'], ans:0, hint:'C√¥ ·∫•y t·∫≠p piano t·ª´ 3 gi·ªù chi·ªÅu!', explain:'"3 PM" = m·ªëc th·ªùi gian ‚Üí since' },
  { cat:'vs', q:'üêÄ A rat _____ across the classroom this morning!', opts:['has run','ran','have run','runs'], ans:1, hint:'Con chu·ªôt ch·∫°y qua l·ªõp s√°ng nay!', explain:'"this morning" + xong ‚Üí Past Simple' },
  { cat:'havhas', q:'ü¶Ü The ducks _____ eaten all the bread!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con v·ªãt ƒÉn h·∫øt b√°nh m√¨!', explain:'The ducks = They ‚Üí have' },
  { cat:'v3', q:'‚öΩ He has _____ the ball into the neighbor\'s garden! (kick)', opts:['kicked','kick','kicking','kicks'], ans:0, hint:'Anh ·∫•y ƒë√° b√≥ng sang v∆∞·ªùn h√†ng x√≥m!', explain:'kick ‚Üí kicked ‚Üí kicked (quy t·∫Øc)' },
  { cat:'ques', q:'ü§° _____ they ever dressed up as clowns?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù h√≥a trang th√†nh h·ªÅ ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'signal', q:'üéà Oh no! The balloon has _____ popped!', opts:['just','yet','ever','never'], ans:0, hint:'√îi kh√¥ng! B√≥ng bay V·ª™A n·ªï!', explain:'just = v·ª´a m·ªõi' },
  { cat:'sinfor', q:'ü¶∑ His toothache has lasted _____ 3 days!', opts:['since','for','from','during'], ans:1, hint:'ƒêau rƒÉng k√©o d√†i 3 ng√†y r·ªìi!', explain:'"3 days" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üßä I _____ on the ice and fell down yesterday!', opts:['have slipped','slipped','has slipped','slip'], ans:1, hint:'T√¥i tr∆∞·ª£t tr√™n bƒÉng h√¥m qua!', explain:'"yesterday" ‚Üí Past Simple' },
  { cat:'havhas', q:'üêª The bear _____ broken into our camp!', opts:['have','has','is','did'], ans:1, hint:'Con g·∫•u ƒë·ªôt nh·∫≠p tr·∫°i!', explain:'The bear = It ‚Üí has' },
  { cat:'v3', q:'üì∏ We have _____ a selfie with a monkey! (take)', opts:['took','taken','taked','taking'], ans:1, hint:'Ch√∫ng t√¥i ch·ª•p selfie v·ªõi kh·ªâ!', explain:'take ‚Üí took ‚Üí taken' },
  { cat:'neg', q:'üéØ She _____ hit the target yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'C√¥ ·∫•y ch∆∞a b·∫Øn tr√∫ng ƒë√≠ch!', explain:'She ‚Üí hasn\'t' },
  { cat:'vs', q:'ü¶© I _____ never seen a pink flamingo before!', opts:['have','did','was','am'], ans:0, hint:'T√¥i ch∆∞a bao gi·ªù th·∫•y chim h·ªìng h·∫°c!', explain:'never ‚Üí Present Perfect' },
  { cat:'signal', q:'üì¶ The package hasn\'t arrived _____!', opts:['already','just','yet','never'], ans:2, hint:'B∆∞u ki·ªán CH∆ØA ƒë·∫øn!', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'sinfor', q:'üéÆ They have played Minecraft _____ September!', opts:['since','for','from','at'], ans:0, hint:'H·ªç ch∆°i Minecraft t·ª´ th√°ng 9!', explain:'"September" = m·ªëc ‚Üí since' },
  { cat:'havhas', q:'üêà My cats _____ knocked everything off the table!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con m√®o h·∫•t h·∫øt ƒë·ªì tr√™n b√†n!', explain:'My cats = They ‚Üí have' },
  { cat:'v3', q:'üé§ She has _____ in front of 1000 people! (speak)', opts:['spoke','spoken','speaked','speaking'], ans:1, hint:'C√¥ ·∫•y ƒë√£ n√≥i tr∆∞·ªõc 1000 ng∆∞·ªùi!', explain:'speak ‚Üí spoke ‚Üí spoken' },
  { cat:'ques', q:'üßä _____ it ever snowed in your city?', opts:['Have','Has','Did','Does'], ans:1, hint:'Th√†nh ph·ªë b·∫°n ƒë√£ bao gi·ªù c√≥ tuy·∫øt?', explain:'It ‚Üí Has' },
  { cat:'vs', q:'üéÑ We _____ 50 cookies for Christmas last year!', opts:['have baked','baked','has baked','bake'], ans:1, hint:'Ch√∫ng t√¥i n∆∞·ªõng 50 b√°nh Noel nƒÉm ngo√°i!', explain:'"last year" ‚Üí Past Simple' },
  { cat:'havhas', q:'ü¶Å The lion _____ escaped from the circus!', opts:['have','has','is','did'], ans:1, hint:'Con s∆∞ t·ª≠ tr·ªën kh·ªèi r·∫°p xi·∫øc!', explain:'The lion = It ‚Üí has' },
  { cat:'v3', q:'üß§ I have _____ my gloves again! (forget)', opts:['forgot','forgotten','forgetted','forgetting'], ans:1, hint:'T√¥i l·∫°i qu√™n gƒÉng tay!', explain:'forget ‚Üí forgot ‚Üí forgotten' },
  { cat:'neg', q:'üêï The puppy _____ learned to sit yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Ch√≥ con ch∆∞a h·ªçc ng·ªìi!', explain:'The puppy = It ‚Üí hasn\'t' },
  { cat:'signal', q:'üå∫ Have you _____ smelled a corpse flower?', opts:['ever','never','just','already'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù ng·ª≠i hoa x√°c th·ªëi?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'sinfor', q:'üè† We have lived in this haunted house _____ 2019!', opts:['since','for','from','during'], ans:0, hint:'Ch√∫ng t√¥i s·ªëng trong nh√† ma t·ª´ 2019!', explain:'"2019" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üé™ The magician _____ a rabbit from his hat just now!', opts:['has pulled','pulled','have pulled','pulls'], ans:0, hint:'·∫¢o thu·∫≠t gia v·ª´a r√∫t con th·ªè ra!', explain:'"just now" = v·ª´a x·∫£y ra ‚Üí Present Perfect' },

  // === EVEN MORE HORRIBLE MIX ===
  { cat:'havhas', q:'üêä A crocodile _____ moved into our swimming pool!', opts:['have','has','is','did'], ans:1, hint:'C√° s·∫•u d·ªçn v√†o h·ªì b∆°i nh√† t√¥i!', explain:'A crocodile = It ‚Üí has' },
  { cat:'v3', q:'üéí I have _____ my lunchbox at home! (leave)', opts:['left','leaved','leave','leaving'], ans:0, hint:'T√¥i ƒë·ªÉ qu√™n h·ªôp c∆°m ·ªü nh√†!', explain:'leave ‚Üí left ‚Üí left' },
  { cat:'signal', q:'ü¶¥ The dog has _____ buried a bone in my bed!', opts:['just','yet','ever','never'], ans:0, hint:'Con ch√≥ V·ª™A ch√¥n x∆∞∆°ng tr√™n gi∆∞·ªùng t√¥i!', explain:'just = v·ª´a m·ªõi' },
  { cat:'sinfor', q:'üéµ She has sung the same song _____ 45 minutes!', opts:['since','for','from','during'], ans:1, hint:'C√¥ ·∫•y h√°t m√£i 1 b√†i su·ªët 45 ph√∫t!', explain:'"45 minutes" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üßÅ Mom _____ 200 cupcakes for the school fair last week!', opts:['has baked','baked','have baked','bakes'], ans:1, hint:'M·∫π n∆∞·ªõng 200 cupcake tu·∫ßn tr∆∞·ªõc!', explain:'"last week" ‚Üí Past Simple' },
  { cat:'neg', q:'üé™ The clown _____ made anyone laugh yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Anh h·ªÅ ch∆∞a l√†m ai c∆∞·ªùi!', explain:'The clown = He ‚Üí hasn\'t' },
  { cat:'ques', q:'üß™ _____ the scientist ever created a monster?', opts:['Have','Has','Did','Does'], ans:1, hint:'Nh√† khoa h·ªçc ƒë√£ bao gi·ªù t·∫°o qu√°i v·∫≠t ch∆∞a?', explain:'The scientist = He ‚Üí Has' },
  { cat:'havhas', q:'üêù The bees _____ built a nest in our mailbox!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con ong x√¢y t·ªï trong h·ªôp th∆∞!', explain:'The bees = They ‚Üí have' },
  { cat:'v3', q:'üéØ He has _____ the ball through the window! (hit)', opts:['hitted','hit','hitting','hits'], ans:1, hint:'Anh ·∫•y ƒë√° b√≥ng v·ª° c·ª≠a s·ªï!', explain:'hit ‚Üí hit ‚Üí hit (kh√¥ng ƒë·ªïi!)' },
  { cat:'signal', q:'üçï Have you _____ put pineapple on pizza?', opts:['ever','never','already','just'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù cho d·ª©a l√™n pizza ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'sinfor', q:'üêå The snail has crawled _____ this morning!', opts:['since','for','from','during'], ans:0, hint:'Con ·ªëc s√™n b√≤ t·ª´ s√°ng!', explain:'"this morning" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üéà The balloon _____ away 2 seconds ago!', opts:['has flown','flew','have flown','fly'], ans:1, hint:'B√≥ng bay m·∫•t 2 gi√¢y tr∆∞·ªõc!', explain:'"2 seconds ago" ‚Üí Past Simple' },
  { cat:'havhas', q:'üßë‚Äçüöí The firefighter _____ rescued the cat from the tree!', opts:['have','has','is','did'], ans:1, hint:'L√≠nh c·ª©u h·ªèa ƒë√£ c·ª©u m√®o tr√™n c√¢y!', explain:'The firefighter = He ‚Üí has' },
  { cat:'v3', q:'üèà They have _____ the game! (win)', opts:['won','winned','win','winning'], ans:0, hint:'H·ªç ƒë√£ th·∫Øng tr·∫≠n ƒë·∫•u!', explain:'win ‚Üí won ‚Üí won' },
  { cat:'neg', q:'üê∏ The frog _____ jumped out of the box yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Con ·∫øch ch∆∞a nh·∫£y ra kh·ªèi h·ªôp!', explain:'The frog = It ‚Üí hasn\'t' },
  { cat:'signal', q:'üéÅ I have _____ opened my birthday present!', opts:['already','yet','ever','never'], ans:0, hint:'T√¥i ƒê√É m·ªü qu√† sinh nh·∫≠t r·ªìi!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'sinfor', q:'üêì The rooster has crowed _____ 4:30 AM!', opts:['since','for','from','at'], ans:0, hint:'Con g√† tr·ªëng g√°y t·ª´ 4:30 s√°ng!', explain:'"4:30 AM" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'ü¶é A lizard _____ across my keyboard just now!', opts:['has run','ran','have run','runs'], ans:0, hint:'Th·∫±n l·∫±n v·ª´a ch·∫°y qua b√†n ph√≠m!', explain:'"just now" ‚Üí Present Perfect' },
  { cat:'ques', q:'üß≤ _____ you ever stuck a magnet on your nose?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù d√°n nam ch√¢m l√™n m≈©i?', explain:'You ‚Üí Have' },
  { cat:'havhas', q:'ü¶É The turkey _____ escaped before Thanksgiving!', opts:['have','has','is','did'], ans:1, hint:'Con g√† t√¢y tr·ªën tr∆∞·ªõc l·ªÖ T·∫° ∆†n!', explain:'The turkey = It ‚Üí has' },
  { cat:'v3', q:'üßä The water has _____ into ice! (freeze)', opts:['froze','frozen','freezed','freezing'], ans:1, hint:'N∆∞·ªõc ƒë√£ ƒë√≥ng th√†nh ƒë√°!', explain:'freeze ‚Üí froze ‚Üí frozen' },
  { cat:'signal', q:'üêç She has _____ touched a snake! Eww!', opts:['never','ever','just','already'], ans:0, hint:'C√¥ ·∫•y CH∆ØA BAO GI·ªú s·ªù r·∫Øn!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'sinfor', q:'ü¶ü The mosquitoes have buzzed _____ an hour!', opts:['since','for','from','during'], ans:1, hint:'Mu·ªói vo ve c·∫£ ti·∫øng r·ªìi!', explain:'"an hour" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üêÑ The cow _____ on my foot at the farm yesterday!', opts:['has stepped','stepped','have stepped','steps'], ans:1, hint:'Con b√≤ d·∫´m l√™n ch√¢n t√¥i h√¥m qua!', explain:'"yesterday" ‚Üí Past Simple' },
  { cat:'neg', q:'üé∏ He _____ learned to play guitar yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Anh ·∫•y ch∆∞a h·ªçc ƒë∆∞·ª£c guitar!', explain:'He ‚Üí hasn\'t' },
  { cat:'havhas', q:'üêß The penguins _____ stolen our fish!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con chim c√°nh c·ª•t ƒÉn tr·ªôm c√°!', explain:'The penguins = They ‚Üí have' },
  { cat:'v3', q:'üí§ He has _____ through the entire movie! (sleep)', opts:['slept','sleeped','sleep','sleeping'], ans:0, hint:'Anh ·∫•y ng·ªß su·ªët c·∫£ phim!', explain:'sleep ‚Üí slept ‚Üí slept' },
  { cat:'ques', q:'üé¢ _____ she ever screamed on a roller coaster?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù la h√©t tr√™n t√†u l∆∞·ª£n?', explain:'She ‚Üí Has' },
  { cat:'signal', q:'üç≥ He hasn\'t cooked breakfast _____.', opts:['already','just','yet','never'], ans:2, hint:'Anh ·∫•y CH∆ØA n·∫•u b·ªØa s√°ng.', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'sinfor', q:'üßπ We have cleaned the house _____ 3 hours!', opts:['since','for','from','during'], ans:1, hint:'Ch√∫ng t√¥i d·ªçn nh√† 3 ti·∫øng r·ªìi!', explain:'"3 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üêõ A caterpillar _____ into a butterfly! So beautiful!', opts:['has turned','turned','have turned','turns'], ans:0, hint:'S√¢u bi·∫øn th√†nh b∆∞·ªõm! (k·∫øt qu·∫£ ·∫£nh h∆∞·ªüng)', explain:'K·∫øt qu·∫£ c√≤n hi·ªán t·∫°i ‚Üí Present Perfect' },
  { cat:'havhas', q:'üßë‚Äç‚öïÔ∏è The doctor _____ told me to eat more vegetables!', opts:['have','has','is','did'], ans:1, hint:'B√°c sƒ© b·∫£o t√¥i ƒÉn nhi·ªÅu rau h∆°n!', explain:'The doctor = He/She ‚Üí has' },
  { cat:'v3', q:'üåã The volcano has _____ again! Run! (erupt)', opts:['erupted','erupt','erupting','erupts'], ans:0, hint:'N√∫i l·ª≠a l·∫°i phun tr√†o! Ch·∫°y!', explain:'erupt ‚Üí erupted ‚Üí erupted (quy t·∫Øc)' },
  { cat:'neg', q:'üé™ They _____ set up the circus tent yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'H·ªç ch∆∞a d·ª±ng xong l·ªÅu xi·∫øc!', explain:'They ‚Üí haven\'t' },
  { cat:'signal', q:'üêû A ladybug has _____ landed on my nose!', opts:['just','yet','ever','never'], ans:0, hint:'Con b·ªç r√πa V·ª™A ƒë·∫≠u l√™n m≈©i t√¥i!', explain:'just = v·ª´a m·ªõi' },
  { cat:'sinfor', q:'üè• She has been in the hospital _____ Friday!', opts:['since','for','from','during'], ans:0, hint:'C√¥ ·∫•y n·∫±m vi·ªán t·ª´ th·ª© S√°u!', explain:'"Friday" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üéª He _____ the violin at the concert last Saturday!', opts:['has played','played','have played','plays'], ans:1, hint:'Anh ·∫•y ch∆°i violin ·ªü bu·ªïi h√≤a nh·∫°c th·ª© B·∫£y!', explain:'"last Saturday" ‚Üí Past Simple' },
  { cat:'ques', q:'üêã _____ they ever seen a real whale?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù th·∫•y c√° voi th·∫≠t ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'havhas', q:'ü¶â An owl _____ moved into our attic!', opts:['have','has','is','did'], ans:1, hint:'Con c√∫ d·ªçn v√†o g√°c m√°i nh√† t√¥i!', explain:'An owl = It ‚Üí has' },
  { cat:'v3', q:'üì± She has _____ her phone in the toilet! (drop)', opts:['dropped','droped','drop','dropping'], ans:0, hint:'C√¥ ·∫•y l√†m r∆°i ƒëi·ªán tho·∫°i v√†o toilet!', explain:'drop ‚Üí dropped ‚Üí dropped' },
  { cat:'signal', q:'üßÄ The mouse has _____ found the cheese!', opts:['already','yet','never','ever'], ans:0, hint:'Con chu·ªôt ƒê√É t√¨m th·∫•y ph√¥ mai!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'sinfor', q:'‚õàÔ∏è It has rained _____ last night!', opts:['since','for','from','during'], ans:0, hint:'Tr·ªùi m∆∞a t·ª´ t·ªëi qua!', explain:'"last night" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üßë‚Äçüè´ She _____ never been late for school.', opts:['has','did','was','is'], ans:0, hint:'C√¥ ·∫•y ch∆∞a bao gi·ªù ƒëi h·ªçc mu·ªôn.', explain:'never ‚Üí Present Perfect' },
  { cat:'neg', q:'ü¶ä The fox _____ caught the chicken yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Con c√°o ch∆∞a b·∫Øt ƒë∆∞·ª£c g√†!', explain:'The fox = It ‚Üí hasn\'t' },
  { cat:'havhas', q:'üëØ My twin sisters _____ switched places again!', opts:['have','has','are','did'], ans:0, hint:'Hai ch·ªã em sinh ƒë√¥i ƒë·ªïi ch·ªó l·∫°i!', explain:'My twin sisters = They ‚Üí have' },
  { cat:'v3', q:'üè† We have _____ our house blue! (paint)', opts:['painted','paint','painting','paints'], ans:0, hint:'Ch√∫ng t√¥i s∆°n nh√† m√†u xanh!', explain:'paint ‚Üí painted ‚Üí painted (quy t·∫Øc)' },
  { cat:'ques', q:'üêú _____ an ant ever bitten you?', opts:['Have','Has','Did','Does'], ans:1, hint:'Ki·∫øn ƒë√£ bao gi·ªù c·∫Øn b·∫°n ch∆∞a?', explain:'An ant = It ‚Üí Has' },
  { cat:'signal', q:'üè† Have you _____ sleepwalked at night?', opts:['ever','never','already','just'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù m·ªông du ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'sinfor', q:'üéÉ They have decorated the house _____ 2 days!', opts:['since','for','from','during'], ans:1, hint:'H·ªç trang tr√≠ nh√† 2 ng√†y r·ªìi!', explain:'"2 days" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'vs', q:'üê± The cat _____ the goldfish at 3 PM today!', opts:['has eaten','ate','have eaten','eats'], ans:1, hint:'Con m√®o ƒÉn c√° v√†ng l√∫c 3 gi·ªù chi·ªÅu!', explain:'"at 3 PM today" = th·ªùi ƒëi·ªÉm c·ª• th·ªÉ ‚Üí Past Simple' },
  { cat:'havhas', q:'ü¶Ä A crab _____ pinched my toe at the beach!', opts:['have','has','is','did'], ans:1, hint:'Con cua k·∫πp ng√≥n ch√¢n t√¥i!', explain:'A crab = It ‚Üí has' },
  { cat:'v3', q:'üóùÔ∏è Someone has _____ the key! (hide)', opts:['hid','hidden','hided','hiding'], ans:1, hint:'Ai ƒë√≥ ƒë√£ gi·∫•u ch√¨a kh√≥a!', explain:'hide ‚Üí hid ‚Üí hidden' },
  { cat:'neg', q:'üå∫ The flowers _____ bloomed yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Hoa ch∆∞a n·ªü!', explain:'The flowers = They ‚Üí haven\'t' },
  { cat:'signal', q:'üß≤ I have _____ seen such a big spider!', opts:['never','ever','just','already'], ans:0, hint:'T√¥i CH∆ØA BAO GI·ªú th·∫•y nh·ªán to th·∫ø!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'sinfor', q:'üéß He has listened to music _____ he got home!', opts:['since','for','from','while'], ans:0, hint:'Anh ·∫•y nghe nh·∫°c t·ª´ khi v·ªÅ nh√†!', explain:'"he got home" = m·ªëc ‚Üí since' },
  { cat:'vs', q:'üê¢ The turtle _____ the race! Nobody expected it!', opts:['has won','won','have won','wins'], ans:0, hint:'R√πa th·∫Øng cu·ªôc ƒëua! (k·∫øt qu·∫£ ·∫£nh h∆∞·ªüng)', explain:'K·∫øt qu·∫£ b·∫•t ng·ªù ‚Üí Present Perfect' },
  { cat:'havhas', q:'üßë‚Äçüç≥ My dad _____ burned the toast for the 5th time!', opts:['have','has','is','did'], ans:1, hint:'B·ªë t√¥i ch√°y b√°nh m√¨ l·∫ßn th·ª© 5!', explain:'My dad = He ‚Üí has' },
  { cat:'v3', q:'üí° She has _____ a brilliant idea! (have)', opts:['had','haved','have','having'], ans:0, hint:'C√¥ ·∫•y c√≥ √Ω t∆∞·ªüng tuy·ªát v·ªùi!', explain:'have ‚Üí had ‚Üí had' },
  { cat:'ques', q:'ü¶∑ _____ the tooth fairy ever visited your house?', opts:['Have','Has','Did','Does'], ans:1, hint:'Ti√™n rƒÉng ƒë√£ bao gi·ªù ƒë·∫øn nh√† b·∫°n?', explain:'The tooth fairy = She ‚Üí Has' },
  { cat:'vs', q:'üé® I _____ this picture when I was 5 years old.', opts:['have drawn','drew','has drawn','draw'], ans:1, hint:'T√¥i v·∫Ω b·ª©c tranh n√†y l√∫c 5 tu·ªïi.', explain:'"when I was 5" ‚Üí Past Simple' },
  { cat:'neg', q:'üöÄ The rocket _____ launched yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'T√™n l·ª≠a ch∆∞a ph√≥ng!', explain:'The rocket = It ‚Üí hasn\'t' },
  { cat:'havhas', q:'üê∏ The frogs _____ taken over the garden!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con ·∫øch chi·∫øm c·∫£ v∆∞·ªùn!', explain:'The frogs = They ‚Üí have' },
  { cat:'v3', q:'üé§ He has _____ in the school choir! (sing)', opts:['sang','sung','singed','singing'], ans:1, hint:'Anh ·∫•y ƒë√£ h√°t trong d√†n ƒë·ªìng ca!', explain:'sing ‚Üí sang ‚Üí sung' },
  { cat:'sinfor', q:'üèïÔ∏è We have camped here _____ 4 nights!', opts:['since','for','from','during'], ans:1, hint:'Ch√∫ng t√¥i c·∫Øm tr·∫°i 4 ƒë√™m r·ªìi!', explain:'"4 nights" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'signal', q:'üé° They have _____ ridden the Ferris wheel 5 times!', opts:['already','yet','ever','never'], ans:0, hint:'H·ªç ƒê√É ƒëi ƒëu quay 5 l·∫ßn r·ªìi!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'ques', q:'üåÆ _____ we ever tried Mexican food?', opts:['Have','Has','Did','Are'], ans:0, hint:'Ch√∫ng ta ƒë√£ bao gi·ªù th·ª≠ ƒë·ªì Mexico?', explain:'We ‚Üí Have' },
  { cat:'vs', q:'üé≠ She _____ in 3 school plays so far this year.', opts:['has acted','acted','have acted','acts'], ans:0, hint:'C√¥ ·∫•y ƒë√≥ng 3 v·ªü k·ªãch nƒÉm nay.', explain:'"so far" ‚Üí Present Perfect' },
  { cat:'neg', q:'üß© I _____ finished this puzzle yet! It\'s so hard!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'T√¥i ch∆∞a xong puzzle! Kh√≥ qu√°!', explain:'I ‚Üí haven\'t' },
  { cat:'havhas', q:'üêï‚Äçü¶∫ The rescue dog _____ found the lost hiker!', opts:['have','has','is','did'], ans:1, hint:'Ch√≥ c·ª©u h·ªô t√¨m th·∫•y ng∆∞·ªùi ƒëi l·∫°c!', explain:'The rescue dog = It ‚Üí has' },
  { cat:'v3', q:'üèÜ Our team has _____ first place! (get)', opts:['got','gotten','getted','getting'], ans:1, hint:'ƒê·ªôi ch√∫ng t√¥i ƒë·∫°t gi·∫£i nh·∫•t!', explain:'get ‚Üí got ‚Üí gotten' },

  // === COVER ALL REMAINING HORRIBLE LIST VERBS ===
  { cat:'v3', q:'üëª He has _____ a ghost since yesterday! (be)', opts:['been','was','be','being'], ans:0, hint:'Anh ·∫•y l√†m ma t·ª´ h√¥m qua!', explain:'be ‚Üí was/were ‚Üí been' },
  { cat:'v3', q:'ü§¶ She has _____ her homework 3 times today! (do)', opts:['did','done','doed','doing'], ans:1, hint:'C√¥ ·∫•y l√†m b√†i t·∫≠p 3 l·∫ßn h√¥m nay!', explain:'do ‚Üí did ‚Üí done' },
  { cat:'v3', q:'üêú Ants have _____ into our kitchen again! (come)', opts:['came','come','comed','coming'], ans:1, hint:'Ki·∫øn l·∫°i b√≤ v√†o b·∫øp n·ªØa!', explain:'come ‚Üí came ‚Üí come' },
  { cat:'v3', q:'ü§´ He has _____ a bad word in class! (say)', opts:['said','say','sayed','saying'], ans:0, hint:'Anh ·∫•y n√≥i b·∫≠y trong l·ªõp!', explain:'say ‚Üí said ‚Üí said' },
  { cat:'v3', q:'ü§• She has _____ everyone my secret! (tell)', opts:['told','telled','tell','telling'], ans:0, hint:'C√¥ ·∫•y k·ªÉ b√≠ m·∫≠t t√¥i cho m·ªçi ng∆∞·ªùi!', explain:'tell ‚Üí told ‚Üí told' },
  { cat:'v3', q:'üëÇ Have you _____ that strange noise at night? (hear)', opts:['heard','heared','hear','hearing'], ans:0, hint:'B·∫°n c√≥ nghe ti·∫øng l·∫° ban ƒë√™m kh√¥ng?', explain:'hear ‚Üí heard ‚Üí heard' },
  { cat:'v3', q:'üëÄ I have _____ a rainbow today! (see)', opts:['saw','seen','seed','seeing'], ans:1, hint:'T√¥i ƒë√£ th·∫•y c·∫ßu v·ªìng h√¥m nay!', explain:'see ‚Üí saw ‚Üí seen' },
  { cat:'v3', q:'üëÉ He has _____ something terrible in the fridge! (smell)', opts:['smelt','smelled','smell','smelling'], ans:0, hint:'Anh ·∫•y ng·ª≠i th·∫•y m√πi kinh kh·ªßng trong t·ªß l·∫°nh!', explain:'smell ‚Üí smelt ‚Üí smelt' },
  { cat:'v3', q:'üí∏ That toy has _____ me all my pocket money! (cost)', opts:['cost','costed','costs','costing'], ans:0, hint:'M√≥n ƒë·ªì ch∆°i ƒë√≥ t·ªën h·∫øt ti·ªÅn ti√™u v·∫∑t!', explain:'cost ‚Üí cost ‚Üí cost (kh√¥ng ƒë·ªïi!)' },
  { cat:'v3', q:'‚úÇÔ∏è She has _____ her own hair! It looks funny! (cut)', opts:['cut','cutted','cuts','cutting'], ans:0, hint:'C√¥ ·∫•y t·ª± c·∫Øt t√≥c! Tr√¥ng bu·ªìn c∆∞·ªùi!', explain:'cut ‚Üí cut ‚Üí cut (kh√¥ng ƒë·ªïi!)' },
  { cat:'v3', q:'ü§ï He has _____ his knee again! (hurt)', opts:['hurt','hurted','hurts','hurting'], ans:0, hint:'Anh ·∫•y l·∫°i ƒëau ƒë·∫ßu g·ªëi!', explain:'hurt ‚Üí hurt ‚Üí hurt (kh√¥ng ƒë·ªïi!)' },
  { cat:'v3', q:'üê∂ Mom has _____ me keep the puppy! (let)', opts:['let','letted','lets','letting'], ans:0, hint:'M·∫π cho t√¥i nu√¥i ch√≥ con!', explain:'let ‚Üí let ‚Üí let (kh√¥ng ƒë·ªïi!)' },
  { cat:'v3', q:'üß∏ Someone has _____ a teddy bear in my bag! (put)', opts:['put','putted','puts','putting'], ans:0, hint:'Ai ƒë√≥ nh√©t g·∫•u b√¥ng v√†o c·∫∑p t√¥i!', explain:'put ‚Üí put ‚Üí put (kh√¥ng ƒë·ªïi!)' },
  { cat:'v3', q:'üìñ She has _____ that book 5 times! (read)', opts:['read','readed','reads','reading'], ans:0, hint:'C√¥ ·∫•y ƒë·ªçc cu·ªën s√°ch ƒë√≥ 5 l·∫ßn!', explain:'read ‚Üí read ‚Üí read (ph√°t √¢m kh√°c!)' },
  { cat:'v3', q:'üö™ The wind has _____ all the doors! (shut)', opts:['shut','shutted','shuts','shutting'], ans:0, hint:'Gi√≥ ƒë√≥ng s·∫≠p h·∫øt c·ª≠a!', explain:'shut ‚Üí shut ‚Üí shut (kh√¥ng ƒë·ªïi!)' },
  { cat:'v3', q:'üç¶ He has _____ the biggest ice cream! (choose)', opts:['chose','chosen','choosed','choosing'], ans:1, hint:'Anh ·∫•y ƒë√£ ch·ªçn c√¢y kem to nh·∫•t!', explain:'choose ‚Üí chose ‚Üí chosen' },
  { cat:'v3', q:'üöó Grandma has _____ into the wrong parking lot! (drive)', opts:['drove','driven','drived','driving'], ans:1, hint:'B√† l√°i xe v√†o sai b√£i ƒë·ªó!', explain:'drive ‚Üí drove ‚Üí driven' },
  { cat:'v3', q:'üéÅ Santa has _____ me socks again! (give)', opts:['gave','given','gived','giving'], ans:1, hint:'√îng gi√† Noel l·∫°i t·∫∑ng t√¥i t·∫•t!', explain:'give ‚Üí gave ‚Üí given' },
  { cat:'v3', q:'üòá She has _____ me for breaking her toy! (forgive)', opts:['forgave','forgiven','forgived','forgiving'], ans:1, hint:'C√¥ ·∫•y tha th·ª© cho t√¥i v√¨ l√†m h·ªèng ƒë·ªì ch∆°i!', explain:'forgive ‚Üí forgave ‚Üí forgiven' },
  { cat:'v3', q:'üêé Have you ever _____ a horse? (ride)', opts:['rode','ridden','rided','riding'], ans:1, hint:'B·∫°n ƒë√£ bao gi·ªù c∆∞·ª°i ng·ª±a ch∆∞a?', explain:'ride ‚Üí rode ‚Üí ridden' },
  { cat:'v3', q:'üåÖ The sun has already _____ ! Time for school! (rise)', opts:['rose','risen','rised','rising'], ans:1, hint:'M·∫∑t tr·ªùi ƒë√£ m·ªçc! ƒêi h·ªçc th√¥i!', explain:'rise ‚Üí rose ‚Üí risen' },
  { cat:'v3', q:'ü´® The earthquake has _____ the whole building! (shake)', opts:['shook','shaken','shaked','shaking'], ans:1, hint:'ƒê·ªông ƒë·∫•t rung c·∫£ t√≤a nh√†!', explain:'shake ‚Üí shook ‚Üí shaken' },
  { cat:'v3', q:'‚è∞ The alarm has _____ up the whole neighborhood! (wake)', opts:['woke','woken','waked','waking'], ans:1, hint:'Chu√¥ng b√°o ƒë√°nh th·ª©c c·∫£ x√≥m!', explain:'wake ‚Üí woke ‚Üí woken' },
  { cat:'v3', q:'‚úèÔ∏è He has _____ his name on every desk! (write)', opts:['wrote','written','writed','writing'], ans:1, hint:'Anh ·∫•y vi·∫øt t√™n l√™n m·ªçi b√†n h·ªçc!', explain:'write ‚Üí wrote ‚Üí written' },
  { cat:'v3', q:'üåßÔ∏è It has _____ to rain during our picnic! (begin)', opts:['began','begun','beginned','beginning'], ans:1, hint:'Tr·ªùi b·∫Øt ƒë·∫ßu m∆∞a gi·ªØa bu·ªïi picnic!', explain:'begin ‚Üí began ‚Üí begun' },
  { cat:'v3', q:'ü•õ The cat has _____ all the milk! (drink)', opts:['drank','drunk','drinked','drinking'], ans:1, hint:'Con m√®o u·ªëng h·∫øt s·ªØa!', explain:'drink ‚Üí drank ‚Üí drunk' },
  { cat:'v3', q:'üêí The monkey has _____ from tree to tree! (swing)', opts:['swang','swung','swinged','swinging'], ans:1, hint:'Con kh·ªâ ƒëu t·ª´ c√¢y n√†y sang c√¢y kh√°c!', explain:'swing ‚Üí swung ‚Üí swung' },
  { cat:'v3', q:'üå¨Ô∏è The storm has _____ the roof off our house! (blow)', opts:['blew','blown','blowed','blowing'], ans:1, hint:'B√£o th·ªïi bay m√°i nh√†!', explain:'blow ‚Üí blew ‚Üí blown' },
  { cat:'v3', q:'üé® She has _____ a picture of her cat! (draw)', opts:['drew','drawn','drawed','drawing'], ans:1, hint:'C√¥ ·∫•y v·∫Ω tranh con m√®o!', explain:'draw ‚Üí drew ‚Üí drawn' },
  { cat:'v3', q:'üå± My sunflower has _____ taller than me! (grow)', opts:['grew','grown','growed','growing'], ans:1, hint:'Hoa h∆∞·ªõng d∆∞∆°ng m·ªçc cao h∆°n t√¥i!', explain:'grow ‚Üí grew ‚Üí grown' },
  { cat:'v3', q:'ü§∑ I have _____ this answer all along! (know)', opts:['knew','known','knowed','knowing'], ans:1, hint:'T√¥i bi·∫øt ƒë√°p √°n t·ª´ ƒë·∫ßu!', explain:'know ‚Üí knew ‚Üí known' },
  { cat:'v3', q:'üéÇ She has _____ a cake for the party! (bring)', opts:['brought','bringed','brung','bringing'], ans:0, hint:'C√¥ ·∫•y mang b√°nh ƒë·∫øn ti·ªác!', explain:'bring ‚Üí brought ‚Üí brought' },
  { cat:'v3', q:'üêπ He has _____ a hamster without telling Mom! (buy)', opts:['bought','buyed','buy','buying'], ans:0, hint:'Anh ·∫•y mua hamster m√† kh√¥ng n√≥i m·∫π!', explain:'buy ‚Üí bought ‚Üí bought' },
  { cat:'v3', q:'‚öæ She has _____ the ball with one hand! (catch)', opts:['caught','catched','catch','catching'], ans:0, hint:'C√¥ ·∫•y b·∫Øt b√≥ng b·∫±ng m·ªôt tay!', explain:'catch ‚Üí caught ‚Üí caught' },
  { cat:'v3', q:'ü§∫ The knights have _____ the dragon! (fight)', opts:['fought','fighted','fight','fighting'], ans:0, hint:'C√°c hi·ªáp sƒ© ƒë√£ chi·∫øn ƒë·∫•u v·ªõi r·ªìng!', explain:'fight ‚Üí fought ‚Üí fought' },
  { cat:'v3', q:'üìö She has _____ English for 10 years! (teach)', opts:['taught','teached','teach','teaching'], ans:0, hint:'C√¥ ·∫•y d·∫°y ti·∫øng Anh 10 nƒÉm r·ªìi!', explain:'teach ‚Üí taught ‚Üí taught' },
  { cat:'v3', q:'üß† I have _____ about this problem all day! (think)', opts:['thought','thinked','think','thinking'], ans:0, hint:'T√¥i nghƒ© v·ªÅ b√†i to√°n c·∫£ ng√†y!', explain:'think ‚Üí thought ‚Üí thought' },
  { cat:'v3', q:'üßç He has _____ in line for 2 hours! (stand)', opts:['stood','standed','stand','standing'], ans:0, hint:'Anh ·∫•y ƒë·ª©ng x·∫øp h√†ng 2 ti·∫øng!', explain:'stand ‚Üí stood ‚Üí stood' },
  { cat:'v3', q:'ü§î She has finally _____ the math problem! (understand)', opts:['understood','understanded','understand','understanding'], ans:0, hint:'C√¥ ·∫•y cu·ªëi c√πng hi·ªÉu b√†i to√°n!', explain:'understand ‚Üí understood ‚Üí understood' },
  { cat:'v3', q:'ü©∏ His nose has _____ all over his shirt! (bleed)', opts:['bled','bleeded','bleed','bleeding'], ans:0, hint:'M≈©i anh ·∫•y ch·∫£y m√°u ƒë·∫ßy √°o!', explain:'bleed ‚Üí bled ‚Üí bled' },
  { cat:'v3', q:'üê† She has _____ the fish 3 times today! (feed)', opts:['fed','feeded','feed','feeding'], ans:0, hint:'C√¥ ·∫•y cho c√° ƒÉn 3 l·∫ßn h√¥m nay!', explain:'feed ‚Üí fed ‚Üí fed' },
  { cat:'v3', q:'ü§¢ I have _____ sick since lunch! (feel)', opts:['felt','feeled','feel','feeling'], ans:0, hint:'T√¥i th·∫•y kh√≥ ch·ªãu t·ª´ b·ªØa tr∆∞a!', explain:'feel ‚Üí felt ‚Üí felt' },
  { cat:'v3', q:'üêõ He has _____ a caterpillar as a pet! (keep)', opts:['kept','keeped','keep','keeping'], ans:0, hint:'Anh ·∫•y nu√¥i s√¢u b∆∞·ªõm l√†m th√∫ c∆∞ng!', explain:'keep ‚Üí kept ‚Üí kept' },
  { cat:'v3', q:'üëΩ She has _____ a real alien! (meet)', opts:['met','meeted','meet','meeting'], ans:0, hint:'C√¥ ·∫•y g·∫∑p ng∆∞·ªùi ngo√†i h√†nh tinh th·∫≠t!', explain:'meet ‚Üí met ‚Üí met' },
  { cat:'v3', q:'üßπ Mom has _____ a spider under my bed! (sweep)', opts:['swept','sweeped','sweep','sweeping'], ans:0, hint:'M·∫π qu√©t ƒë∆∞·ª£c nh·ªán d∆∞·ªõi gi∆∞·ªùng t√¥i!', explain:'sweep ‚Üí swept ‚Üí swept' },
  { cat:'v3', q:'üè∞ They have _____ a castle out of cardboard! (build)', opts:['built','builded','build','building'], ans:0, hint:'H·ªç x√¢y l√¢u ƒë√†i b·∫±ng b√¨a carton!', explain:'build ‚Üí built ‚Üí built' },
  { cat:'v3', q:'üí∞ He has _____ me his favorite comic book! (lend)', opts:['lent','lended','lend','lending'], ans:0, hint:'Anh ·∫•y cho t√¥i m∆∞·ª£n truy·ªán tranh y√™u th√≠ch!', explain:'lend ‚Üí lent ‚Üí lent' },
  { cat:'v3', q:'‚úâÔ∏è She has _____ a love letter to the wrong person! (send)', opts:['sent','sended','send','sending'], ans:0, hint:'C√¥ ·∫•y g·ª≠i nh·∫ßm th∆∞ t√¨nh!', explain:'send ‚Üí sent ‚Üí sent' },
  { cat:'v3', q:'üõçÔ∏è We have _____ all our money on candy! (spend)', opts:['spent','spended','spend','spending'], ans:0, hint:'Ch√∫ng t√¥i ti√™u h·∫øt ti·ªÅn v√†o k·∫πo!', explain:'spend ‚Üí spent ‚Üí spent' },
  { cat:'v3', q:'üî• He has _____ the toast again! (burn)', opts:['burnt','burned','burn','burning'], ans:0, hint:'Anh ·∫•y l·∫°i ch√°y b√°nh m√¨ n∆∞·ªõng!', explain:'burn ‚Üí burnt ‚Üí burnt' },
  { cat:'v3', q:'üí≠ I have _____ about flying every night! (dream)', opts:['dreamt','dreamed','dream','dreaming'], ans:0, hint:'T√¥i m∆° th·∫•y bay m·ªói ƒë√™m!', explain:'dream ‚Üí dreamt ‚Üí dreamt' },
  { cat:'v3', q:'üéì She has _____ to ride a unicycle! (learn)', opts:['learnt','learned','learn','learning'], ans:0, hint:'C√¥ ·∫•y ƒë√£ h·ªçc xe ƒë·∫°p m·ªôt b√°nh!', explain:'learn ‚Üí learnt ‚Üí learnt' },
  { cat:'v3', q:'üïØÔ∏è Someone has _____ 100 candles on the cake! (light)', opts:['lit','lighted','light','lighting'], ans:0, hint:'Ai ƒë√≥ th·∫Øp 100 n·∫øn tr√™n b√°nh!', explain:'light ‚Üí lit ‚Üí lit' },
  { cat:'v3', q:'üò§ What has he _____ by that rude comment? (mean)', opts:['meant','meaned','mean','meaning'], ans:0, hint:'Anh ·∫•y mu·ªën n√≥i g√¨ qua l·ªùi th√¥ l·ªó ƒë√≥?', explain:'mean ‚Üí meant ‚Üí meant' },
  { cat:'v3', q:'üèÄ He has _____ the ball into the neighbor\'s yard! (shoot)', opts:['shot','shooted','shoot','shooting'], ans:0, hint:'Anh ·∫•y b·∫Øn b√≥ng sang s√¢n h√†ng x√≥m!', explain:'shoot ‚Üí shot ‚Üí shot' },
  { cat:'v3', q:'ü™ë The cat has _____ on my homework all day! (sit)', opts:['sat','sitted','sit','sitting'], ans:0, hint:'Con m√®o ng·ªìi l√™n b√†i t·∫≠p c·∫£ ng√†y!', explain:'sit ‚Üí sat ‚Üí sat' },
  { cat:'v3', q:'üî§ He has _____ his name wrong on the test! (spell)', opts:['spelt','spelled','spell','spelling'], ans:0, hint:'Anh ·∫•y vi·∫øt sai t√™n m√¨nh trong b√†i ki·ªÉm tra!', explain:'spell ‚Üí spelt ‚Üí spelt' },
  { cat:'v3', q:'ü¶ã The caterpillar has _____ a butterfly! (become)', opts:['became','become','becomed','becoming'], ans:1, hint:'S√¢u b∆∞·ªõm ƒë√£ bi·∫øn th√†nh b∆∞·ªõm!', explain:'become ‚Üí became ‚Üí become' },
  { cat:'v3', q:'üíé She has _____ a diamond in the garden! (find)', opts:['found','finded','find','finding'], ans:0, hint:'C√¥ ·∫•y t√¨m th·∫•y kim c∆∞∆°ng ngo√†i v∆∞·ªùn!', explain:'find ‚Üí found ‚Üí found' },
  { cat:'v3', q:'üñºÔ∏è He has _____ his underwear on the door! (hang)', opts:['hung','hanged','hang','hanging'], ans:0, hint:'Anh ·∫•y treo qu·∫ßn l√≥t l√™n c·ª≠a!', explain:'hang ‚Üí hung ‚Üí hung' },
  { cat:'v3', q:'üêç She has _____ a snake and she\'s not even scared! (hold)', opts:['held','holded','hold','holding'], ans:0, hint:'C√¥ ·∫•y c·∫ßm con r·∫Øn m√† kh√¥ng s·ª£!', explain:'hold ‚Üí held ‚Üí held' },
  { cat:'v3', q:'ü•ö The chicken has _____ an egg on my chair! (lay)', opts:['laid','layed','lay','laying'], ans:0, hint:'Con g√† ƒë·∫ª tr·ª©ng tr√™n gh·∫ø t√¥i!', explain:'lay ‚Üí laid ‚Üí laid' },
  { cat:'v3', q:'üíµ He has _____ $100 for a rubber duck! (pay)', opts:['paid','payed','pay','paying'], ans:0, hint:'Anh ·∫•y tr·∫£ $100 cho con v·ªãt cao su!', explain:'pay ‚Üí paid ‚Üí paid' },
  { cat:'v3', q:'üèÉ The chicken has _____ across the road! (run)', opts:['ran','run','runned','running'], ans:1, hint:'Con g√† ch·∫°y qua ƒë∆∞·ªùng!', explain:'run ‚Üí ran ‚Üí run' },
  { cat:'v3', q:'üßä He has _____ ice to the penguins at the zoo! (sell)', opts:['sold','selled','sell','selling'], ans:0, hint:'Anh ·∫•y b√°n ƒë√° cho chim c√°nh c·ª•t ·ªü s·ªü th√∫!', explain:'sell ‚Üí sold ‚Üí sold' },
  { cat:'v3', q:'üî¶ The sun has _____ through the clouds! (shine)', opts:['shone','shined','shine','shining'], ans:0, hint:'M·∫∑t tr·ªùi chi·∫øu qua m√¢y!', explain:'shine ‚Üí shone ‚Üí shone' },
  { cat:'v3', q:'üêõ She has _____ me the biggest bug ever! (show)', opts:['showed','shown','show','showing'], ans:1, hint:'C√¥ ·∫•y cho t√¥i xem con b·ªç to nh·∫•t!', explain:'show ‚Üí showed ‚Üí shown' },
  { cat:'v3', q:'üëó He has _____ his shirt inside out all day! (wear)', opts:['wore','worn','weared','wearing'], ans:1, hint:'Anh ·∫•y m·∫∑c √°o tr√°i c·∫£ ng√†y!', explain:'wear ‚Üí wore ‚Üí worn' },

  // === MORE HAVE/HAS ===
  { cat:'havhas', q:'ü¶ã The butterfly _____ landed on my finger!', opts:['have','has','is','did'], ans:1, hint:'B∆∞·ªõm ƒë·∫≠u l√™n ng√≥n tay t√¥i!', explain:'The butterfly = It ‚Üí has' },
  { cat:'havhas', q:'üê∏ The frogs _____ jumped into the pond!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con ·∫øch nh·∫£y xu·ªëng ao!', explain:'The frogs = They ‚Üí have' },
  { cat:'havhas', q:'üë®‚Äçüç≥ The chef _____ cooked something amazing!', opts:['have','has','is','did'], ans:1, hint:'ƒê·∫ßu b·∫øp n·∫•u m√≥n ngon!', explain:'The chef = He ‚Üí has' },
  { cat:'havhas', q:'üé∏ The band _____ played 3 songs already!', opts:['have','has','are','did'], ans:0, hint:'Ban nh·∫°c ƒë√£ ch∆°i 3 b√†i!', explain:'The band = They ‚Üí have' },
  { cat:'havhas', q:'üê¢ The turtle _____ reached the finish line!', opts:['have','has','is','did'], ans:1, hint:'Con r√πa ƒë√£ ƒë·∫øn v·∫°ch ƒë√≠ch!', explain:'The turtle = It ‚Üí has' },
  { cat:'havhas', q:'üëß My sister _____ lost her phone again!', opts:['have','has','is','did'], ans:1, hint:'Ch·ªã t√¥i l·∫°i m·∫•t ƒëi·ªán tho·∫°i!', explain:'My sister = She ‚Üí has' },
  { cat:'havhas', q:'üêú The ants _____ invaded our picnic!', opts:['have','has','are','did'], ans:0, hint:'L≈© ki·∫øn x√¢m chi·∫øm b·ªØa picnic!', explain:'The ants = They ‚Üí have' },
  { cat:'havhas', q:'üßë‚Äçüéì The students _____ finished their exam!', opts:['have','has','are','did'], ans:0, hint:'C√°c h·ªçc sinh ƒë√£ ho√†n th√†nh b√†i thi!', explain:'The students = They ‚Üí have' },
  { cat:'havhas', q:'üåä The wave _____ knocked me over!', opts:['have','has','is','did'], ans:1, hint:'S√≥ng ƒë√°nh ng√£ t√¥i!', explain:'The wave = It ‚Üí has' },
  { cat:'havhas', q:'üêù A bee _____ stung me on my ear!', opts:['have','has','is','did'], ans:1, hint:'Con ong ƒë·ªët tai t√¥i!', explain:'A bee = It ‚Üí has' },
  { cat:'havhas', q:'üßë‚Äçü§ù‚Äçüßë My friends _____ come to my party!', opts:['have','has','are','did'], ans:0, hint:'B·∫°n b√® ƒë√£ ƒë·∫øn ti·ªác!', explain:'My friends = They ‚Üí have' },
  { cat:'havhas', q:'ü¶ä The fox _____ hidden in the barn!', opts:['have','has','is','did'], ans:1, hint:'Con c√°o tr·ªën trong chu·ªìng!', explain:'The fox = It ‚Üí has' },
  { cat:'havhas', q:'üçï Someone _____ eaten my last slice!', opts:['have','has','is','did'], ans:1, hint:'Ai ƒë√≥ ƒÉn mi·∫øng pizza cu·ªëi!', explain:'Someone = He/She ‚Üí has' },
  { cat:'havhas', q:'üêë The sheep _____ escaped from the farm!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con c·ª´u tr·ªën kh·ªèi trang tr·∫°i!', explain:'The sheep (nhi·ªÅu con) = They ‚Üí have' },
  { cat:'havhas', q:'üë¥ Grandpa _____ told me this story before.', opts:['have','has','is','did'], ans:1, hint:'√îng ƒë√£ k·ªÉ t√¥i chuy·ªán n√†y tr∆∞·ªõc ƒë√¢y.', explain:'Grandpa = He ‚Üí has' },

  // === MORE SIGNAL WORDS ===
  { cat:'signal', q:'üéÅ She has _____ received her birthday gift!', opts:['just','yet','ever','never'], ans:0, hint:'C√¥ ·∫•y V·ª™A nh·∫≠n qu√† sinh nh·∫≠t!', explain:'just = v·ª´a m·ªõi' },
  { cat:'signal', q:'ü¶Å Have they _____ been to a safari?', opts:['ever','never','already','just'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù ƒëi safari ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üßπ I haven\'t cleaned my room _____!', opts:['already','just','yet','never'], ans:2, hint:'T√¥i CH∆ØA d·ªçn ph√≤ng!', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'signal', q:'üçø We have _____ watched that movie 3 times!', opts:['already','yet','ever','never'], ans:0, hint:'Ch√∫ng t√¥i ƒê√É xem phim ƒë√≥ 3 l·∫ßn!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'signal', q:'üé¢ He has _____ been afraid of roller coasters.', opts:['never','ever','just','already'], ans:0, hint:'Anh ·∫•y CH∆ØA BAO GI·ªú s·ª£ t√†u l∆∞·ª£n.', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'signal', q:'üç∞ Has Mom _____ tried this recipe before?', opts:['ever','never','already','just'], ans:0, hint:'M·∫π ƒë√£ bao gi·ªù th·ª≠ c√¥ng th·ª©c n√†y ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üéØ He has _____ scored 100 points!', opts:['just','yet','ever','never'], ans:0, hint:'Anh ·∫•y V·ª™A ghi 100 ƒëi·ªÉm!', explain:'just = v·ª´a m·ªõi' },
  { cat:'signal', q:'üê∂ The puppy hasn\'t eaten _____!', opts:['already','just','yet','never'], ans:2, hint:'Ch√≥ con CH∆ØA ƒÉn!', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'signal', q:'üåç Have you _____ traveled to another country?', opts:['ever','never','just','already'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù ƒëi n∆∞·ªõc ngo√†i ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üì± She has _____ broken 5 phones this year!', opts:['already','yet','ever','never'], ans:0, hint:'C√¥ ·∫•y ƒê√É l√†m v·ª° 5 ƒëi·ªán tho·∫°i nƒÉm nay!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'signal', q:'ü¶∑ I have _____ had a cavity in my life!', opts:['never','ever','just','already'], ans:0, hint:'T√¥i CH∆ØA BAO GI·ªú b·ªã s√¢u rƒÉng!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'signal', q:'üé¨ The movie hasn\'t started _____.', opts:['already','just','yet','never'], ans:2, hint:'Phim CH∆ØA b·∫Øt ƒë·∫ßu.', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'signal', q:'üßä The ice cream has _____ melted! Quick!', opts:['just','yet','ever','never'], ans:0, hint:'Kem V·ª™A tan! Nhanh l√™n!', explain:'just = v·ª´a m·ªõi' },
  { cat:'signal', q:'üè† Have you _____ lived in a different city?', opts:['ever','never','already','just'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù s·ªëng ·ªü th√†nh ph·ªë kh√°c?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üéí They have _____ packed their bags!', opts:['already','yet','ever','never'], ans:0, hint:'H·ªç ƒê√É ƒë√≥ng g√≥i xong!', explain:'already = ƒë√£... r·ªìi' },

  // === MORE SINCE/FOR ===
  { cat:'sinfor', q:'üéÆ He has played video games _____ 5 hours!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y ch∆°i game 5 ti·∫øng!', explain:'"5 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üåßÔ∏è It has rained _____ Tuesday!', opts:['since','for','from','during'], ans:0, hint:'Tr·ªùi m∆∞a t·ª´ th·ª© Ba!', explain:'"Tuesday" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üìö She has studied English _____ 3 years!', opts:['since','for','from','during'], ans:1, hint:'C√¥ ·∫•y h·ªçc ti·∫øng Anh 3 nƒÉm!', explain:'"3 years" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üè† We have lived here _____ 2020!', opts:['since','for','from','during'], ans:0, hint:'Ch√∫ng t√¥i s·ªëng ·ªü ƒë√¢y t·ª´ 2020!', explain:'"2020" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üêï The dog has barked _____ this morning!', opts:['since','for','from','during'], ans:0, hint:'Con ch√≥ s·ªßa t·ª´ s√°ng nay!', explain:'"this morning" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üò¥ He has slept _____ 10 hours!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y ng·ªß 10 ti·∫øng!', explain:'"10 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üéπ She has practiced piano _____ she was 5!', opts:['since','for','from','when'], ans:0, hint:'C√¥ ·∫•y t·∫≠p piano t·ª´ khi 5 tu·ªïi!', explain:'"she was 5" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üèä They have swum _____ 2 hours!', opts:['since','for','from','during'], ans:1, hint:'H·ªç b∆°i 2 ti·∫øng r·ªìi!', explain:'"2 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'ü§í She has had a fever _____ yesterday!', opts:['since','for','from','during'], ans:0, hint:'C√¥ ·∫•y s·ªët t·ª´ h√¥m qua!', explain:'"yesterday" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üì∫ He has watched TV _____ 4 hours!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y xem TV 4 ti·∫øng!', explain:'"4 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üè´ She has been a teacher _____ 2015!', opts:['since','for','from','during'], ans:0, hint:'C√¥ ·∫•y l√†m gi√°o vi√™n t·ª´ 2015!', explain:'"2015" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üé∏ He has played guitar _____ a long time!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y ch∆°i guitar l√¢u r·ªìi!', explain:'"a long time" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üå∏ The flowers have bloomed _____ spring started!', opts:['since','for','from','when'], ans:0, hint:'Hoa n·ªü t·ª´ khi xu√¢n ƒë·∫øn!', explain:'"spring started" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üß∏ She has kept that doll _____ 8 years!', opts:['since','for','from','during'], ans:1, hint:'C√¥ ·∫•y gi·ªØ b√∫p b√™ ƒë√≥ 8 nƒÉm!', explain:'"8 years" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üöó He has driven _____ he turned 18!', opts:['since','for','from','when'], ans:0, hint:'Anh ·∫•y l√°i xe t·ª´ khi 18 tu·ªïi!', explain:'"he turned 18" = m·ªëc ‚Üí since' },

  // === MORE VS PAST SIMPLE ===
  { cat:'vs', q:'üéÇ She _____ 10 candles on her cake last birthday!', opts:['has blown','blew','have blown','blows'], ans:1, hint:'C√¥ ·∫•y th·ªïi 10 n·∫øn sinh nh·∫≠t tr∆∞·ªõc!', explain:'"last birthday" ‚Üí Past Simple' },
  { cat:'vs', q:'üìñ He _____ already read this book 3 times.', opts:['has','did','was','is'], ans:0, hint:'Anh ·∫•y ƒë√£ ƒë·ªçc s√°ch n√†y 3 l·∫ßn r·ªìi.', explain:'already ‚Üí Present Perfect' },
  { cat:'vs', q:'üéÉ They _____ trick-or-treating last Halloween!', opts:['have gone','went','has gone','go'], ans:1, hint:'H·ªç ƒëi xin k·∫πo Halloween nƒÉm tr∆∞·ªõc!', explain:'"last Halloween" ‚Üí Past Simple' },
  { cat:'vs', q:'üèÜ Our team _____ never lost a game this season!', opts:['has','did','was','is'], ans:0, hint:'ƒê·ªôi ch∆∞a bao gi·ªù thua m√πa n√†y!', explain:'never ‚Üí Present Perfect' },
  { cat:'vs', q:'üêç A snake _____ into our house two days ago!', opts:['has crawled','crawled','have crawled','crawls'], ans:1, hint:'Con r·∫Øn b√≤ v√†o nh√† 2 ng√†y tr∆∞·ªõc!', explain:'"two days ago" ‚Üí Past Simple' },
  { cat:'vs', q:'üéµ She _____ sung in 5 concerts so far!', opts:['has','did','was','is'], ans:0, hint:'C√¥ ·∫•y h√°t 5 bu·ªïi h√≤a nh·∫°c ƒë·∫øn nay!', explain:'"so far" ‚Üí Present Perfect' },
  { cat:'vs', q:'‚ö° The power _____ out at midnight last night!', opts:['has gone','went','have gone','goes'], ans:1, hint:'M·∫•t ƒëi·ªán l√∫c n·ª≠a ƒë√™m h√¥m qua!', explain:'"at midnight last night" ‚Üí Past Simple' },
  { cat:'vs', q:'üé® She _____ just finished painting the fence!', opts:['has','did','was','is'], ans:0, hint:'C√¥ ·∫•y v·ª´a s∆°n xong h√†ng r√†o!', explain:'just ‚Üí Present Perfect' },
  { cat:'vs', q:'üìù He _____ the test two hours ago.', opts:['has taken','took','have taken','takes'], ans:1, hint:'Anh ·∫•y l√†m b√†i ki·ªÉm tra 2 ti·∫øng tr∆∞·ªõc.', explain:'"two hours ago" ‚Üí Past Simple' },
  { cat:'vs', q:'üåç I _____ visited 10 countries in my life!', opts:['have','did','was','am'], ans:0, hint:'T√¥i ƒë√£ ƒëi 10 n∆∞·ªõc trong ƒë·ªùi!', explain:'"in my life" ‚Üí Present Perfect' },
  { cat:'vs', q:'üéÑ We _____ a Christmas tree last December.', opts:['have bought','bought','has bought','buy'], ans:1, hint:'Ch√∫ng t√¥i mua c√¢y Noel th√°ng 12 tr∆∞·ªõc.', explain:'"last December" ‚Üí Past Simple' },
  { cat:'vs', q:'üèä She _____ swum across the lake before!', opts:['has','did','was','is'], ans:0, hint:'C√¥ ·∫•y ƒë√£ b∆°i qua h·ªì tr∆∞·ªõc ƒë√¢y!', explain:'"before" ‚Üí Present Perfect' },
  { cat:'vs', q:'üê∂ The dog _____ away from home yesterday!', opts:['has run','ran','have run','runs'], ans:1, hint:'Con ch√≥ ch·∫°y kh·ªèi nh√† h√¥m qua!', explain:'"yesterday" ‚Üí Past Simple' },
  { cat:'vs', q:'üé§ He _____ never performed on stage before.', opts:['has','did','was','is'], ans:0, hint:'Anh ·∫•y ch∆∞a bao gi·ªù bi·ªÉu di·ªÖn tr√™n s√¢n kh·∫•u.', explain:'never ‚Üí Present Perfect' },
  { cat:'vs', q:'üß™ The scientist _____ a new element in 2023!', opts:['has discovered','discovered','have discovered','discovers'], ans:1, hint:'Nh√† khoa h·ªçc ph√°t hi·ªán nguy√™n t·ªë m·ªõi nƒÉm 2023!', explain:'"in 2023" ‚Üí Past Simple' },

  // === MORE NEGATIVE ===
  { cat:'neg', q:'üéØ They _____ scored a goal yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'H·ªç ch∆∞a ghi b√†n!', explain:'They ‚Üí haven\'t' },
  { cat:'neg', q:'üì± She _____ called me back yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'C√¥ ·∫•y ch∆∞a g·ªçi l·∫°i!', explain:'She ‚Üí hasn\'t' },
  { cat:'neg', q:'üç≥ I _____ eaten breakfast yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'T√¥i ch∆∞a ƒÉn s√°ng!', explain:'I ‚Üí haven\'t' },
  { cat:'neg', q:'üìù He _____ done his homework yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Anh ·∫•y ch∆∞a l√†m b√†i t·∫≠p!', explain:'He ‚Üí hasn\'t' },
  { cat:'neg', q:'üßπ We _____ cleaned the house yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Ch√∫ng t√¥i ch∆∞a d·ªçn nh√†!', explain:'We ‚Üí haven\'t' },
  { cat:'neg', q:'üêï The dog _____ come home yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Con ch√≥ ch∆∞a v·ªÅ nh√†!', explain:'The dog = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üéÅ They _____ opened their presents yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'H·ªç ch∆∞a m·ªü qu√†!', explain:'They ‚Üí haven\'t' },
  { cat:'neg', q:'üå∫ The roses _____ bloomed yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Hoa h·ªìng ch∆∞a n·ªü!', explain:'The roses = They ‚Üí haven\'t' },
  { cat:'neg', q:'‚úàÔ∏è The plane _____ landed yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'M√°y bay ch∆∞a h·∫° c√°nh!', explain:'The plane = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üë®‚Äçüç≥ Dad _____ finished cooking yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'B·ªë ch∆∞a n·∫•u xong!', explain:'Dad = He ‚Üí hasn\'t' },
  { cat:'neg', q:'üé¨ The movie _____ ended yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Phim ch∆∞a k·∫øt th√∫c!', explain:'The movie = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üêà The kittens _____ learned to climb yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'M·∫•y ch√∫ m√®o con ch∆∞a bi·∫øt leo!', explain:'The kittens = They ‚Üí haven\'t' },

  // === MORE QUESTIONS ===
  { cat:'ques', q:'üéÇ _____ she ever made a cake from scratch?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù t·ª± l√†m b√°nh ch∆∞a?', explain:'She ‚Üí Has' },
  { cat:'ques', q:'üåä _____ you ever surfed on big waves?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù l∆∞·ªõt s√≥ng to ch∆∞a?', explain:'You ‚Üí Have' },
  { cat:'ques', q:'üê™ _____ he ever ridden a camel?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù c∆∞·ª°i l·∫°c ƒë√† ch∆∞a?', explain:'He ‚Üí Has' },
  { cat:'ques', q:'üçú _____ they ever eaten sushi?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù ƒÉn sushi ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'ques', q:'üéπ _____ she ever played the piano?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù ch∆°i piano ch∆∞a?', explain:'She ‚Üí Has' },
  { cat:'ques', q:'üèîÔ∏è _____ you ever climbed a mountain?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù leo n√∫i ch∆∞a?', explain:'You ‚Üí Have' },
  { cat:'ques', q:'üêò _____ he ever seen an elephant in real life?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù th·∫•y voi th·∫≠t ch∆∞a?', explain:'He ‚Üí Has' },
  { cat:'ques', q:'üé≠ _____ they ever acted in a play?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù di·ªÖn k·ªãch ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'ques', q:'üê¥ _____ she ever fed a horse?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù cho ng·ª±a ƒÉn ch∆∞a?', explain:'She ‚Üí Has' },
  { cat:'ques', q:'üõ∏ _____ you ever dreamt about aliens?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù m∆° th·∫•y ng∆∞·ªùi ngo√†i h√†nh tinh?', explain:'You ‚Üí Have' },
  { cat:'ques', q:'üè∞ _____ he ever visited a real castle?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù thƒÉm l√¢u ƒë√†i th·∫≠t ch∆∞a?', explain:'He ‚Üí Has' },
  { cat:'ques', q:'üé™ _____ they ever been to a circus?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù ƒëi xem xi·∫øc ch∆∞a?', explain:'They ‚Üí Have' },

  // === MEGA EXPANSION: HAVE/HAS ===
  { cat:'havhas', q:'ü¶ú The parrot _____ learned to say "hello"!', opts:['have','has','is','did'], ans:1, hint:'Con v·∫πt ƒë√£ h·ªçc n√≥i "hello"!', explain:'The parrot = It ‚Üí has' },
  { cat:'havhas', q:'üêá The rabbits _____ dug holes everywhere!', opts:['have','has','are','did'], ans:0, hint:'M·∫•y con th·ªè ƒë√†o l·ªó kh·∫Øp n∆°i!', explain:'The rabbits = They ‚Üí have' },
  { cat:'havhas', q:'üßë‚ÄçüöÄ The astronaut _____ returned from space!', opts:['have','has','is','did'], ans:1, hint:'Phi h√†nh gia ƒë√£ tr·ªü v·ªÅ t·ª´ v≈© tr·ª•!', explain:'The astronaut = He ‚Üí has' },
  { cat:'havhas', q:'üê† The goldfish _____ grown bigger!', opts:['have','has','is','did'], ans:1, hint:'Con c√° v√†ng ƒë√£ l·ªõn h∆°n!', explain:'The goldfish = It ‚Üí has' },
  { cat:'havhas', q:'üë©‚Äçüè´ The teachers _____ given us no homework!', opts:['have','has','are','did'], ans:0, hint:'C√°c c√¥ gi√°o kh√¥ng cho b√†i t·∫≠p!', explain:'The teachers = They ‚Üí have' },
  { cat:'havhas', q:'ü¶Ö The eagle _____ caught a fish!', opts:['have','has','is','did'], ans:1, hint:'ƒê·∫°i b√†ng b·∫Øt ƒë∆∞·ª£c c√°!', explain:'The eagle = It ‚Üí has' },
  { cat:'havhas', q:'üë∂ The babies _____ fallen asleep!', opts:['have','has','are','did'], ans:0, hint:'C√°c em b√© ƒë√£ ng·ªß!', explain:'The babies = They ‚Üí have' },
  { cat:'havhas', q:'üßô The wizard _____ cast a spell on the frog!', opts:['have','has','is','did'], ans:1, hint:'Ph√π th·ªßy ni·ªám ch√∫ con ·∫øch!', explain:'The wizard = He ‚Üí has' },
  { cat:'havhas', q:'üêª‚Äç‚ùÑÔ∏è The polar bears _____ swum across the river!', opts:['have','has','are','did'], ans:0, hint:'G·∫•u B·∫Øc C·ª±c b∆°i qua s√¥ng!', explain:'The polar bears = They ‚Üí have' },
  { cat:'havhas', q:'üë®‚Äç‚úàÔ∏è The pilot _____ landed the plane safely!', opts:['have','has','is','did'], ans:1, hint:'Phi c√¥ng h·∫° c√°nh an to√†n!', explain:'The pilot = He ‚Üí has' },
  { cat:'havhas', q:'üêõ The caterpillars _____ eaten all the leaves!', opts:['have','has','are','did'], ans:0, hint:'S√¢u b∆∞·ªõm ƒÉn h·∫øt l√°!', explain:'The caterpillars = They ‚Üí have' },
  { cat:'havhas', q:'ü¶∏ The superhero _____ saved the city!', opts:['have','has','is','did'], ans:1, hint:'Si√™u anh h√πng c·ª©u th√†nh ph·ªë!', explain:'The superhero = He ‚Üí has' },
  { cat:'havhas', q:'üêì The rooster _____ woken up the whole farm!', opts:['have','has','is','did'], ans:1, hint:'Con g√† tr·ªëng ƒë√°nh th·ª©c c·∫£ trang tr·∫°i!', explain:'The rooster = It ‚Üí has' },
  { cat:'havhas', q:'üëØ The dancers _____ performed beautifully!', opts:['have','has','are','did'], ans:0, hint:'C√°c v≈© c√¥ng bi·ªÉu di·ªÖn tuy·ªát v·ªùi!', explain:'The dancers = They ‚Üí have' },
  { cat:'havhas', q:'üêô The octopus _____ escaped from the tank!', opts:['have','has','is','did'], ans:1, hint:'B·∫°ch tu·ªôc tr·ªën kh·ªèi b·ªÉ!', explain:'The octopus = It ‚Üí has' },

  // === MEGA EXPANSION: SIGNAL WORDS ===
  { cat:'signal', q:'üéÆ He has _____ beaten the final boss!', opts:['just','yet','ever','never'], ans:0, hint:'Anh ·∫•y V·ª™A h·∫° boss cu·ªëi!', explain:'just = v·ª´a m·ªõi' },
  { cat:'signal', q:'ü¶à Have you _____ seen a shark in real life?', opts:['ever','never','already','just'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù th·∫•y c√° m·∫≠p ngo√†i ƒë·ªùi?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üß™ The experiment hasn\'t worked _____.', opts:['already','just','yet','never'], ans:2, hint:'Th√≠ nghi·ªám CH∆ØA th√†nh c√¥ng.', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'signal', q:'üé§ She has _____ performed on TV!', opts:['already','yet','ever','never'], ans:0, hint:'C√¥ ·∫•y ƒê√É bi·ªÉu di·ªÖn tr√™n TV!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'signal', q:'üêä I have _____ been so scared in my life!', opts:['never','ever','just','already'], ans:0, hint:'T√¥i CH∆ØA BAO GI·ªú s·ª£ ƒë·∫øn th·∫ø!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'signal', q:'üöÄ The rocket has _____ launched!', opts:['just','yet','ever','never'], ans:0, hint:'T√™n l·ª≠a V·ª™A ph√≥ng!', explain:'just = v·ª´a m·ªõi' },
  { cat:'signal', q:'üçî Has he _____ tried a hamburger?', opts:['ever','never','already','just'], ans:0, hint:'Anh ·∫•y ƒë√£ bao gi·ªù ƒÉn hamburger ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üõí They haven\'t bought the groceries _____.', opts:['already','just','yet','never'], ans:2, hint:'H·ªç CH∆ØA mua ƒë·ªì.', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'signal', q:'üèÖ He has _____ won 3 gold medals!', opts:['already','yet','ever','never'], ans:0, hint:'Anh ·∫•y ƒê√É gi√†nh 3 huy ch∆∞∆°ng v√†ng!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'signal', q:'üéª Has she _____ played the violin?', opts:['ever','never','already','just'], ans:0, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù ch∆°i violin ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üêç I have _____ touched a snake!', opts:['never','ever','just','already'], ans:0, hint:'T√¥i CH∆ØA BAO GI·ªú s·ªù r·∫Øn!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'signal', q:'üèóÔ∏è They have _____ built the new bridge!', opts:['just','yet','ever','never'], ans:0, hint:'H·ªç V·ª™A x√¢y xong c·∫ßu m·ªõi!', explain:'just = v·ª´a m·ªõi' },
  { cat:'signal', q:'üìÆ The postman hasn\'t come _____.', opts:['already','just','yet','never'], ans:2, hint:'B∆∞u t√° CH∆ØA ƒë·∫øn.', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'signal', q:'üéì She has _____ graduated from university!', opts:['already','yet','ever','never'], ans:0, hint:'C√¥ ·∫•y ƒê√É t·ªët nghi·ªáp ƒë·∫°i h·ªçc!', explain:'already = ƒë√£... r·ªìi' },
  { cat:'signal', q:'üèÑ Have they _____ tried surfing?', opts:['ever','never','already','just'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù th·ª≠ l∆∞·ªõt s√≥ng ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üéÇ The cake has _____ arrived! Let\'s eat!', opts:['just','yet','ever','never'], ans:0, hint:'B√°nh V·ª™A ƒë·∫øn! ƒÇn th√¥i!', explain:'just = v·ª´a m·ªõi' },
  { cat:'signal', q:'üõ´ Have you _____ flown in a helicopter?', opts:['ever','never','already','just'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù bay tr·ª±c thƒÉng ch∆∞a?', explain:'ever = ƒë√£ bao gi·ªù (c√¢u h·ªèi)' },
  { cat:'signal', q:'üé™ We have _____ seen such an amazing show!', opts:['never','ever','just','already'], ans:0, hint:'Ch√∫ng t√¥i CH∆ØA BAO GI·ªú xem show hay th·∫ø!', explain:'never = ch∆∞a bao gi·ªù' },
  { cat:'signal', q:'üç© He hasn\'t finished his donut _____.', opts:['already','just','yet','never'], ans:2, hint:'Anh ·∫•y CH∆ØA ƒÉn xong donut.', explain:'yet = ch∆∞a (c√¢u ph·ªß ƒë·ªãnh)' },
  { cat:'signal', q:'üê∂ The vet has _____ checked the puppies!', opts:['already','yet','ever','never'], ans:0, hint:'B√°c sƒ© th√∫ y ƒê√É kh√°m xong ch√≥ con!', explain:'already = ƒë√£... r·ªìi' },

  // === MEGA EXPANSION: SINCE/FOR ===
  { cat:'sinfor', q:'üéµ He has listened to this song _____ 2 hours!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y nghe b√†i n√†y 2 ti·∫øng!', explain:'"2 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üêï We have had this dog _____ Christmas!', opts:['since','for','from','during'], ans:0, hint:'Ch√∫ng t√¥i nu√¥i ch√≥ t·ª´ Gi√°ng sinh!', explain:'"Christmas" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üì± She has used this phone _____ 2 years!', opts:['since','for','from','during'], ans:1, hint:'C√¥ ·∫•y d√πng ƒëi·ªán tho·∫°i n√†y 2 nƒÉm!', explain:'"2 years" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üè´ He has been at school _____ 7 AM!', opts:['since','for','from','during'], ans:0, hint:'Anh ·∫•y ·ªü tr∆∞·ªùng t·ª´ 7 gi·ªù s√°ng!', explain:'"7 AM" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üéÆ They have played this game _____ ages!', opts:['since','for','from','during'], ans:1, hint:'H·ªç ch∆°i game n√†y l√¢u l·∫Øm!', explain:'"ages" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'ü§ß I have had a cold _____ Monday!', opts:['since','for','from','during'], ans:0, hint:'T√¥i b·ªã c·∫£m t·ª´ th·ª© Hai!', explain:'"Monday" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üé∏ She has played in the band _____ 6 months!', opts:['since','for','from','during'], ans:1, hint:'C√¥ ·∫•y ch∆°i trong ban nh·∫°c 6 th√°ng!', explain:'"6 months" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üåô He has been awake _____ midnight!', opts:['since','for','from','during'], ans:0, hint:'Anh ·∫•y th·ª©c t·ª´ n·ª≠a ƒë√™m!', explain:'"midnight" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üìö They have read _____ 30 minutes!', opts:['since','for','from','during'], ans:1, hint:'H·ªç ƒë·ªçc s√°ch 30 ph√∫t!', explain:'"30 minutes" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üêà The cat has slept _____ lunchtime!', opts:['since','for','from','during'], ans:0, hint:'Con m√®o ng·ªß t·ª´ gi·ªù ƒÉn tr∆∞a!', explain:'"lunchtime" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'‚öΩ He has trained _____ 3 weeks!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y t·∫≠p luy·ªán 3 tu·∫ßn!', explain:'"3 weeks" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üè• She has worked at the hospital _____ 2019!', opts:['since','for','from','during'], ans:0, hint:'C√¥ ·∫•y l√†m vi·ªác ·ªü b·ªánh vi·ªán t·ª´ 2019!', explain:'"2019" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üéª He has practiced violin _____ an hour and a half!', opts:['since','for','from','during'], ans:1, hint:'Anh ·∫•y t·∫≠p violin 1 ti·∫øng r∆∞·ª°i!', explain:'"an hour and a half" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üåû The sun has shone _____ early morning!', opts:['since','for','from','during'], ans:0, hint:'M·∫∑t tr·ªùi chi·∫øu t·ª´ s√°ng s·ªõm!', explain:'"early morning" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üèãÔ∏è She has exercised _____ 45 minutes!', opts:['since','for','from','during'], ans:1, hint:'C√¥ ·∫•y t·∫≠p th·ªÉ d·ª•c 45 ph√∫t!', explain:'"45 minutes" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'üé≠ They have rehearsed _____ last weekend!', opts:['since','for','from','during'], ans:0, hint:'H·ªç t·∫≠p k·ªãch t·ª´ cu·ªëi tu·∫ßn tr∆∞·ªõc!', explain:'"last weekend" = m·ªëc ‚Üí since' },
  { cat:'sinfor', q:'üõèÔ∏è The baby has napped _____ 2 hours!', opts:['since','for','from','during'], ans:1, hint:'Em b√© ng·ªß tr∆∞a 2 ti·∫øng!', explain:'"2 hours" = kho·∫£ng th·ªùi gian ‚Üí for' },
  { cat:'sinfor', q:'‚ùÑÔ∏è It has snowed _____ yesterday afternoon!', opts:['since','for','from','during'], ans:0, hint:'Tuy·∫øt r∆°i t·ª´ chi·ªÅu h√¥m qua!', explain:'"yesterday afternoon" = m·ªëc ‚Üí since' },

  // === MEGA EXPANSION: VS PAST SIMPLE ===
  { cat:'vs', q:'üé∏ He _____ guitar at the talent show last week!', opts:['has played','played','have played','plays'], ans:1, hint:'Anh ·∫•y ch∆°i guitar ·ªü h·ªôi t√†i nƒÉng tu·∫ßn tr∆∞·ªõc!', explain:'"last week" ‚Üí Past Simple' },
  { cat:'vs', q:'üèä She _____ never swum in the ocean before.', opts:['has','did','was','is'], ans:0, hint:'C√¥ ·∫•y ch∆∞a bao gi·ªù b∆°i ·ªü bi·ªÉn.', explain:'never ‚Üí Present Perfect' },
  { cat:'vs', q:'üéÉ We _____ pumpkins for Halloween in October.', opts:['have carved','carved','has carved','carve'], ans:1, hint:'Ch√∫ng t√¥i kh·∫Øc b√≠ ng√¥ v√†o th√°ng 10.', explain:'"in October" ‚Üí Past Simple' },
  { cat:'vs', q:'üìö I _____ already finished reading this book!', opts:['have','did','was','am'], ans:0, hint:'T√¥i ƒë√£ ƒë·ªçc xong cu·ªën s√°ch n√†y r·ªìi!', explain:'already ‚Üí Present Perfect' },
  { cat:'vs', q:'‚ö° Lightning _____ the big tree in the park yesterday!', opts:['has hit','hit','have hit','hits'], ans:1, hint:'S√©t ƒë√°nh c√¢y l·ªõn h√¥m qua!', explain:'"yesterday" ‚Üí Past Simple' },
  { cat:'vs', q:'üé§ She _____ just won the singing competition!', opts:['has','did','was','is'], ans:0, hint:'C√¥ ·∫•y v·ª´a th·∫Øng cu·ªôc thi h√°t!', explain:'just ‚Üí Present Perfect' },
  { cat:'vs', q:'ü¶ï Dinosaurs _____ millions of years ago.', opts:['have lived','lived','has lived','live'], ans:1, hint:'Kh·ªßng long s·ªëng h√†ng tri·ªáu nƒÉm tr∆∞·ªõc.', explain:'"millions of years ago" ‚Üí Past Simple' },
  { cat:'vs', q:'üéØ He _____ scored 3 goals so far this match!', opts:['has','did','was','is'], ans:0, hint:'Anh ·∫•y ghi 3 b√†n trong tr·∫≠n n√†y!', explain:'"so far" ‚Üí Present Perfect' },
  { cat:'vs', q:'üöÇ The train _____ at 9 AM this morning.', opts:['has left','left','have left','leaves'], ans:1, hint:'T√†u kh·ªüi h√†nh l√∫c 9 gi·ªù s√°ng.', explain:'"at 9 AM this morning" = th·ªùi ƒëi·ªÉm c·ª• th·ªÉ ‚Üí Past Simple' },
  { cat:'vs', q:'üèÜ Our school _____ won this trophy 5 times!', opts:['has','did','was','is'], ans:0, hint:'Tr∆∞·ªùng ƒë√£ th·∫Øng c√∫p n√†y 5 l·∫ßn!', explain:'"5 times" (kh√¥ng x√°c ƒë·ªãnh) ‚Üí Present Perfect' },
  { cat:'vs', q:'üéÅ She _____ me a present on my birthday last year.', opts:['has given','gave','have given','gives'], ans:1, hint:'C√¥ ·∫•y t·∫∑ng qu√† sinh nh·∫≠t nƒÉm ngo√°i.', explain:'"last year" ‚Üí Past Simple' },
  { cat:'vs', q:'üêü I _____ caught 10 fish today!', opts:['have','did','was','am'], ans:0, hint:'T√¥i c√¢u ƒë∆∞·ª£c 10 con c√° h√¥m nay!', explain:'"today" (ch∆∞a k·∫øt th√∫c) ‚Üí Present Perfect' },
  { cat:'vs', q:'üßä The lake _____ over during the ice age.', opts:['has frozen','froze','have frozen','freezes'], ans:1, hint:'H·ªì ƒë√≥ng bƒÉng th·ªùi k·ª≥ bƒÉng h√†.', explain:'"during the ice age" ‚Üí Past Simple' },
  { cat:'vs', q:'üåà It _____ rained 3 times this week!', opts:['has','did','was','is'], ans:0, hint:'Tr·ªùi m∆∞a 3 l·∫ßn tu·∫ßn n√†y!', explain:'"this week" (ch∆∞a k·∫øt th√∫c) ‚Üí Present Perfect' },
  { cat:'vs', q:'üêà The cat _____ a mouse and brought it inside just now!', opts:['has caught','caught','have caught','catches'], ans:0, hint:'M√®o v·ª´a b·∫Øt chu·ªôt mang v√†o nh√†!', explain:'"just now" ‚Üí Present Perfect' },
  { cat:'vs', q:'üè∞ They _____ that castle 500 years ago.', opts:['have built','built','has built','build'], ans:1, hint:'H·ªç x√¢y l√¢u ƒë√†i 500 nƒÉm tr∆∞·ªõc.', explain:'"500 years ago" ‚Üí Past Simple' },
  { cat:'vs', q:'üë®‚Äçüç≥ Dad _____ cooked dinner for us many times.', opts:['has','did','was','is'], ans:0, hint:'B·ªë n·∫•u c∆°m cho ch√∫ng t√¥i nhi·ªÅu l·∫ßn.', explain:'"many times" ‚Üí Present Perfect' },
  { cat:'vs', q:'üéä We _____ a big party for New Year\'s Eve in December.', opts:['have had','had','has had','have'], ans:1, hint:'Ch√∫ng t√¥i t·ªï ch·ª©c ti·ªác giao th·ª´a th√°ng 12.', explain:'"in December" ‚Üí Past Simple' },

  // === MEGA EXPANSION: NEGATIVE ===
  { cat:'neg', q:'üßä The ice cream _____ melted yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Kem ch∆∞a tan!', explain:'The ice cream = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üê¶ The birds _____ migrated yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Chim ch∆∞a di c∆∞!', explain:'The birds = They ‚Üí haven\'t' },
  { cat:'neg', q:'üßë‚Äçüéì He _____ graduated yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Anh ·∫•y ch∆∞a t·ªët nghi·ªáp!', explain:'He ‚Üí hasn\'t' },
  { cat:'neg', q:'üçï We _____ ordered the pizza yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Ch√∫ng t√¥i ch∆∞a ƒë·∫∑t pizza!', explain:'We ‚Üí haven\'t' },
  { cat:'neg', q:'üåô The sun _____ set yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'M·∫∑t tr·ªùi ch∆∞a l·∫∑n!', explain:'The sun = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üì¶ The package _____ arrived yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'G√≥i h√†ng ch∆∞a ƒë·∫øn!', explain:'The package = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üéπ She _____ practiced piano yet today!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'C√¥ ·∫•y ch∆∞a t·∫≠p piano h√¥m nay!', explain:'She ‚Üí hasn\'t' },
  { cat:'neg', q:'üßπ The kids _____ tidied their rooms yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'B·ªçn tr·∫ª ch∆∞a d·ªçn ph√≤ng!', explain:'The kids = They ‚Üí haven\'t' },
  { cat:'neg', q:'ü¶∑ I _____ brushed my teeth yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'T√¥i ch∆∞a ƒë√°nh rƒÉng!', explain:'I ‚Üí haven\'t' },
  { cat:'neg', q:'üöå The bus _____ arrived yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Xe bu√Ωt ch∆∞a ƒë·∫øn!', explain:'The bus = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üêï You _____ walked the dog yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'B·∫°n ch∆∞a d·∫Øt ch√≥ ƒëi d·∫°o!', explain:'You ‚Üí haven\'t' },
  { cat:'neg', q:'üé® The artist _____ finished the painting yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'H·ªça sƒ© ch∆∞a v·∫Ω xong!', explain:'The artist = He ‚Üí hasn\'t' },
  { cat:'neg', q:'üå∫ Spring _____ come yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'M√πa xu√¢n ch∆∞a ƒë·∫øn!', explain:'Spring = It ‚Üí hasn\'t' },
  { cat:'neg', q:'üìß They _____ replied to my email yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'H·ªç ch∆∞a tr·∫£ l·ªùi email!', explain:'They ‚Üí haven\'t' },
  { cat:'neg', q:'üé¨ He _____ seen the new movie yet!', opts:["hasn't","haven't","didn't","doesn't"], ans:0, hint:'Anh ·∫•y ch∆∞a xem phim m·ªõi!', explain:'He ‚Üí hasn\'t' },
  { cat:'neg', q:'üè† We _____ moved to the new house yet!', opts:["haven't","hasn't","didn't","don't"], ans:0, hint:'Ch√∫ng t√¥i ch∆∞a chuy·ªÉn nh√† m·ªõi!', explain:'We ‚Üí haven\'t' },

  // === MEGA EXPANSION: QUESTIONS ===
  { cat:'ques', q:'üé¢ _____ you ever been on a roller coaster?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù ƒëi t√†u l∆∞·ª£n ch∆∞a?', explain:'You ‚Üí Have' },
  { cat:'ques', q:'üêä _____ he ever held a crocodile?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù c·∫ßm c√° s·∫•u ch∆∞a?', explain:'He ‚Üí Has' },
  { cat:'ques', q:'üç£ _____ they ever cooked Japanese food?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù n·∫•u ƒë·ªì Nh·∫≠t ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'ques', q:'üéø _____ she ever tried skiing?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù tr∆∞·ª£t tuy·∫øt ch∆∞a?', explain:'She ‚Üí Has' },
  { cat:'ques', q:'üêç _____ you ever touched a snake?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù s·ªù r·∫Øn ch∆∞a?', explain:'You ‚Üí Have' },
  { cat:'ques', q:'üé∏ _____ he ever played in a band?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù ch∆°i trong ban nh·∫°c?', explain:'He ‚Üí Has' },
  { cat:'ques', q:'üåã _____ they ever seen a volcano?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù th·∫•y n√∫i l·ª≠a ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'ques', q:'üê´ _____ she ever ridden a camel?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù c∆∞·ª°i l·∫°c ƒë√† ch∆∞a?', explain:'She ‚Üí Has' },
  { cat:'ques', q:'üé≠ _____ you ever performed on stage?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù di·ªÖn tr√™n s√¢n kh·∫•u?', explain:'You ‚Üí Have' },
  { cat:'ques', q:'üèïÔ∏è _____ he ever slept in a tent?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù ng·ªß trong l·ªÅu?', explain:'He ‚Üí Has' },
  { cat:'ques', q:'üåä _____ they ever gone scuba diving?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù l·∫∑n bi·ªÉn ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'ques', q:'ü¶Å _____ she ever fed a lion?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù cho s∆∞ t·ª≠ ƒÉn?', explain:'She ‚Üí Has' },
  { cat:'ques', q:'üéª _____ you ever heard a live orchestra?', opts:['Have','Has','Did','Are'], ans:0, hint:'B·∫°n ƒë√£ bao gi·ªù nghe nh·∫°c giao h∆∞·ªüng?', explain:'You ‚Üí Have' },
  { cat:'ques', q:'üöÅ _____ he ever flown in a helicopter?', opts:['Have','Has','Did','Does'], ans:1, hint:'Anh ·∫•y ƒë√£ bao gi·ªù bay tr·ª±c thƒÉng?', explain:'He ‚Üí Has' },
  { cat:'ques', q:'üßó _____ they ever climbed a rock wall?', opts:['Have','Has','Did','Are'], ans:0, hint:'H·ªç ƒë√£ bao gi·ªù leo t∆∞·ªùng ƒë√° ch∆∞a?', explain:'They ‚Üí Have' },
  { cat:'ques', q:'üê¨ _____ she ever swum with dolphins?', opts:['Have','Has','Did','Does'], ans:1, hint:'C√¥ ·∫•y ƒë√£ bao gi·ªù b∆°i c√πng c√° heo?', explain:'She ‚Üí Has' },

  // === MORE V3 WITH LESS COMMON VERBS ===
  { cat:'v3', q:'üß§ She has _____ her gloves on the bus! (leave)', opts:['left','leaved','leave','leaving'], ans:0, hint:'C√¥ ·∫•y ƒë·ªÉ qu√™n gƒÉng tay tr√™n xe bu√Ωt!', explain:'leave ‚Üí left ‚Üí left' },
  { cat:'v3', q:'üéØ He has _____ the target perfectly! (hit)', opts:['hitted','hit','hitting','hits'], ans:1, hint:'Anh ·∫•y b·∫Øn tr√∫ng ƒë√≠ch!', explain:'hit ‚Üí hit ‚Üí hit (kh√¥ng ƒë·ªïi!)' },
  { cat:'v3', q:'üì∏ She has _____ 200 photos on the trip! (take)', opts:['took','taken','taked','taking'], ans:1, hint:'C√¥ ·∫•y ch·ª•p 200 ·∫£nh trong chuy·∫øn ƒëi!', explain:'take ‚Üí took ‚Üí taken' },
  { cat:'v3', q:'üé§ They have _____ that song together! (sing)', opts:['sang','sung','singed','singing'], ans:1, hint:'H·ªç ƒë√£ h√°t b√†i ƒë√≥ c√πng nhau!', explain:'sing ‚Üí sang ‚Üí sung' },
  { cat:'v3', q:'üßä The milk has _____ in the fridge! (freeze)', opts:['froze','frozen','freezed','freezing'], ans:1, hint:'S·ªØa ƒë√≥ng ƒë√° trong t·ªß l·∫°nh!', explain:'freeze ‚Üí froze ‚Üí frozen' },
  { cat:'v3', q:'üó£Ô∏è He has _____ to the principal! (speak)', opts:['spoke','spoken','speaked','speaking'], ans:1, hint:'Anh ·∫•y ƒë√£ n√≥i chuy·ªán v·ªõi hi·ªáu tr∆∞·ªüng!', explain:'speak ‚Üí spoke ‚Üí spoken' },
  { cat:'v3', q:'üèÉ The thief has _____ away! (run)', opts:['ran','run','runned','running'], ans:1, hint:'T√™n tr·ªôm ƒë√£ ch·∫°y m·∫•t!', explain:'run ‚Üí ran ‚Üí run' },
  { cat:'v3', q:'üìñ I have _____ this chapter 3 times! (read)', opts:['read','readed','reads','reading'], ans:0, hint:'T√¥i ƒë·ªçc ch∆∞∆°ng n√†y 3 l·∫ßn!', explain:'read ‚Üí read ‚Üí read (ph√°t √¢m kh√°c!)' },
  { cat:'v3', q:'üéÅ Grandma has _____ us cookies! (bring)', opts:['brought','bringed','brung','bringing'], ans:0, hint:'B√† mang cho ch√∫ng t√¥i b√°nh quy!', explain:'bring ‚Üí brought ‚Üí brought' },
  { cat:'v3', q:'üß† He has _____ of a great plan! (think)', opts:['thought','thinked','think','thinking'], ans:0, hint:'Anh ·∫•y nghƒ© ra k·∫ø ho·∫°ch tuy·ªát v·ªùi!', explain:'think ‚Üí thought ‚Üí thought' },
];

const ppCatNames = {
  'havhas':'Have / Has', 'v3':'Past Participle (V3)',
  'sinfor':'Since / For', 'signal':'Already / Just / Yet / Ever / Never',
  'vs':'Present Perfect vs Past Simple', 'neg':'Ph·ªß ƒë·ªãnh (Negative)',
  'ques':'C√¢u h·ªèi (Questions)', 'all':'T·∫•t c·∫£'
};
const ppCatIcons = {
  'havhas':'üîµ', 'v3':'üü£', 'sinfor':'üü¢', 'signal':'üü†',
  'vs':'ü©∑', 'neg':'üî¥', 'ques':'ü©µ', 'all':'üíé'
};

let ppState = { questions:[], current:0, score:0, answers:[], selectedCat:'all', answered:false };

function showPresentPerfectQuiz() {
  let html = '<div style="text-align:left;margin-bottom:10px"><button class="back-btn" onclick="goHome()">‚Üê Home</button></div>' +
    '<div style="text-align:center;padding-bottom:20px;">' +
    '<div style="font-size:3rem;margin-bottom:10px">üíé</div>' +
    '<h2 style="color:white;margin:0 0 5px">Present Perfect Tense</h2>' +
    '<p style="color:rgba(255,255,255,0.8);margin:0 0 20px">have/has + V3 ‚Äî Tr·ªôn t·∫•t c·∫£ d·∫°ng b√†i!</p>' +
    '</div>';
  
  html += '<div class="level-cards">' +
    '<div class="level-card easy" onclick="ppStartQuiz(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info"><div class="level-name">Nhanh</div>' +
    '<div class="level-desc">Luy·ªán t·∫≠p nh·∫π nh√†ng</div></div>' +
    '<div class="level-time">5 c√¢u ‚Ä¢ 3 ph√∫t</div></div>' +

    '<div class="level-card medium" onclick="ppStartQuiz(8)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info"><div class="level-name">V·ª´a ph·∫£i</div>' +
    '<div class="level-desc">√în t·∫≠p c∆° b·∫£n</div></div>' +
    '<div class="level-time">8 c√¢u ‚Ä¢ 5 ph√∫t</div></div>' +

    '<div class="level-card hard" onclick="ppStartQuiz(10)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info"><div class="level-name">Th·ª≠ th√°ch</div>' +
    '<div class="level-desc">Ki·ªÉm tra ki·∫øn th·ª©c</div></div>' +
    '<div class="level-time">10 c√¢u ‚Ä¢ 8 ph√∫t</div></div>' +

    '<div class="level-card" onclick="ppStartQuiz(15)" style="border-color:#9C27B0">' +
    '<div class="level-icon">üèÜ</div>' +
    '<div class="level-info"><div class="level-name" style="color:#7B1FA2">Si√™u sao</div>' +
    '<div class="level-desc">D√†nh cho cao th·ªß!</div></div>' +
    '<div class="level-time">15 c√¢u ‚Ä¢ 12 ph√∫t</div></div>' +

    '<div class="level-card" onclick="ppStartQuiz(20)" style="border-color:#FF6D00;background:linear-gradient(135deg,#FFF8E1,#FFECB3)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info"><div class="level-name" style="color:#E65100">Huy·ªÅn tho·∫°i</div>' +
    '<div class="level-desc">Boss cu·ªëi ƒë√¢y r·ªìi! üëæ</div></div>' +
    '<div class="level-time">20 c√¢u ‚Ä¢ 15 ph√∫t</div></div>' +

    '<div class="level-card" onclick="ppStartQuiz(30)" style="border-color:#D50000;background:linear-gradient(135deg,#FFEBEE,#FFCDD2)">' +
    '<div class="level-icon">üíÄ</div>' +
    '<div class="level-info"><div class="level-name" style="color:#B71C1C">B·∫•t kh·∫£ chi·∫øn b·∫°i</div>' +
    '<div class="level-desc">Ch·ªâ d√†nh cho ng∆∞·ªùi d≈©ng c·∫£m! ‚öîÔ∏è</div></div>' +
    '<div class="level-time">30 c√¢u ‚Ä¢ 20 ph√∫t</div></div>' +
    '</div>';

  // Growth mindset motivation
  var ppMotivMessages = [
    'üí™ M·ªói l·∫ßn luy·ªán t·∫≠p l√† m·ªói l·∫ßn n√£o b·ªô m·∫°nh h∆°n!',
    'üå± Sai kh√¥ng sao ‚Äî ƒë√≥ l√† c√°ch con h·ªçc ƒë∆∞·ª£c!',
    'üî• Con kh√¥ng c·∫ßn ho√†n h·∫£o, ch·ªâ c·∫ßn c·ªë g·∫Øng m·ªói ng√†y!',
    'üß† N√£o con ƒëang t·∫°o th√™m k·∫øt n·ªëi m·ªói khi con luy·ªán t·∫≠p!',
    '‚≠ê ƒêi·ªÅu quan tr·ªçng kh√¥ng ph·∫£i l√† ƒëi·ªÉm s·ªë ‚Äî m√† l√† s·ª± n·ªó l·ª±c!',
    'üöÄ M·ªói c√¢u h·ªèi l√† m·ªôt b∆∞·ªõc ti·∫øn ‚Äî d√π ƒë√∫ng hay sai!',
    'üåà Con ƒë√£ d≈©ng c·∫£m khi b·∫•m v√†o ƒë√¢y ‚Äî b·∫Øt ƒë·∫ßu th√¥i!',
    'üéØ Luy·ªán t·∫≠p ƒë·ªÅu ƒë·∫∑n quan tr·ªçng h∆°n l√†m ƒë√∫ng h·∫øt!',
    'üí° Khi con th·∫•y kh√≥, nghƒ©a l√† n√£o con ƒëang l·ªõn l√™n!',
    'üèÉ Kh√¥ng ai gi·ªèi ngay t·ª´ ƒë·∫ßu ‚Äî t·∫•t c·∫£ ƒë·ªÅu nh·ªù luy·ªán t·∫≠p!'
  ];
  var ppMotiv = ppMotivMessages[Math.floor(Math.random() * ppMotivMessages.length)];
  html += '<div style="text-align:center;margin-top:15px;padding:14px;background:rgba(255,255,255,0.15);border-radius:15px;color:white;font-size:0.95rem">' +
    ppMotiv + '</div>';

  document.getElementById('quizArea').innerHTML = html;
  showScreen('quizScreen');
}

function ppStartQuiz(numQ) {
  let pool = [...ppQuestions];
  
  // Shuffle
  for (let i = pool.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [pool[i], pool[j]] = [pool[j], pool[i]];
  }
  
  ppState.questions = pool.slice(0, Math.min(numQ, pool.length));
  ppState.current = 0;
  ppState.score = 0;
  ppState.answers = [];
  ppState.answered = false;
  
  ppRenderQuestion();
}

function ppRenderQuestion() {
  if (ppState.current >= ppState.questions.length) {
    ppShowResult();
    return;
  }
  
  let q = ppState.questions[ppState.current];
  let total = ppState.questions.length;
  
  // Extract emoji from start of question
  let qText = q.q;
  let sceneEmoji = '';
  let emojiMatch = qText.match(/^([\u{1F000}-\u{1FFFF}][\u{FE00}-\u{FE0F}]?[\u{200D}]?[\u{1F000}-\u{1FFFF}]?|[\u{2600}-\u{27BF}]|[\u{1F300}-\u{1F9FF}]+)\s*/u);
  if (emojiMatch) {
    sceneEmoji = emojiMatch[1];
    qText = qText.slice(emojiMatch[0].length);
  }
  
  // Build sentence with blank
  let sentence = qText.replace('_____', '<span class="pp-blank" id="ppBlank">?</span>');
  
  // Progress dots
  let dotsHtml = '';
  for (let i = 0; i < total; i++) {
    let dotClass = 'dot';
    if (i < ppState.current) dotClass += ' done';
    else if (i === ppState.current) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  let html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚≠ê ' + ppState.score + '</div>' +
    '</div>' +
    '<div class="story-scene">';
  
  if (sceneEmoji) {
    html += '<div class="scene-image">' + sceneEmoji + '</div>';
  }
  
  html += '<div class="scene-text">' + sentence + '</div>' +
    '<div class="choice-buttons" id="ppChoices">';
  
  q.opts.forEach((opt, i) => {
    html += '<button class="choice-btn" onclick="ppAnswer(' + i + ')" id="ppOpt' + i + '">' + opt + '</button>';
  });
  
  html += '</div><div id="ppFeedback"></div></div>';
  
  document.getElementById('quizArea').innerHTML = html;
  showScreen('quizScreen');
}

function ppAnswer(idx) {
  if (ppState.answered) return;
  ppState.answered = true;
  
  let q = ppState.questions[ppState.current];
  let correct = idx === q.ans;
  
  if (correct) {
    ppState.score++;
    playSound('correct');
  } else {
    playSound('wrong');
  }
  
  ppState.answers.push({ q: q, chosen: idx, correct: correct });
  
  // Show answer in blank
  let blank = document.getElementById('ppBlank');
  if (blank) {
    blank.textContent = q.opts[correct ? idx : q.ans];
    blank.className = correct ? 'pp-filled' : 'pp-filled pp-filled-wrong';
  }
  
  // Highlight buttons
  let chosen = document.getElementById('ppOpt' + idx);
  if (chosen) chosen.classList.add(correct ? 'correct' : 'wrong');
  if (!correct) {
    let correctBtn = document.getElementById('ppOpt' + q.ans);
    if (correctBtn) correctBtn.classList.add('correct');
  }
  
  // Disable all buttons
  q.opts.forEach((_, i) => {
    let btn = document.getElementById('ppOpt' + i);
    if (btn) btn.disabled = true;
  });
  
  // Feedback
  let fb = document.getElementById('ppFeedback');
  let total = ppState.questions.length;
  
  let feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="feedback-text">' + (correct ? '‚úÖ Ch√≠nh x√°c!' : '‚ùå Ch∆∞a ƒë√∫ng!') + '</div>' +
    '<div class="feedback-tip" style="text-align:left;line-height:1.6">üí° ' + q.explain + '</div>';
  
  if (!correct) {
    feedbackHtml += '<div style="margin-top:10px;padding:12px;background:#E8F5E9;border-radius:10px;color:#2E7D32;font-weight:600">' +
      '‚úÖ ƒê√°p √°n ƒë√∫ng: <strong>' + q.opts[q.ans] + '</strong></div>';
  }
  
  feedbackHtml += '<button class="next-btn" onclick="ppNext()">' +
    (ppState.current < total - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  fb.innerHTML = feedbackHtml;
  
  if (correct) {
    try { showConfetti(); } catch(e) {}
  }
}

function ppNext() {
  ppState.current++;
  ppState.answered = false;
  ppRenderQuestion();
}

function ppShowResult() {
  let total = ppState.questions.length;
  let score = ppState.score;
  let pct = Math.round(score / total * 100);
  
  // Save best score
  let best = parseInt(localStorage.getItem('ppBestScore') || '0');
  if (pct > best) {
    localStorage.setItem('ppBestScore', pct);
  }
  
  let stars = pct >= 90 ? '‚≠ê‚≠ê‚≠ê' : pct >= 70 ? '‚≠ê‚≠ê' : pct >= 50 ? '‚≠ê' : 'üí™';
  let ppMsgs90 = ['S·ª± ki√™n tr√¨ c·ªßa con c√≥ k·∫øt qu·∫£ r·ªìi! üéâ','Con ƒë√£ n·ªó l·ª±c h·∫øt m√¨nh! üéâ','Luy·ªán t·∫≠p chƒÉm ch·ªâ, con ti·∫øn b·ªô th·∫•y r√µ! üéâ'];let ppMsgs70 = ['Con ƒëang ti·∫øn b·ªô t·ª´ng ng√†y! üëè','M·ªói l·∫ßn luy·ªán, con l·∫°i v·ªØng h∆°n! üëè','C·ªë g·∫Øng c·ªßa con th·∫≠t ƒë√°ng khen! üëè'];let ppMsgs50 = ['Con ƒë√£ d≈©ng c·∫£m th·ª≠ s·ª©c! üìö','Sai l√† ƒë·ªÉ hi·ªÉu h∆°n, con l√†m t·ªët r·ªìi! üìö','Luy·ªán th√™m, con s·∫Ω nh·ªõ l√¢u h∆°n! üìö'];let ppMsgsLow = ['Ki√™n nh·∫´n luy·ªán th√™m, con s·∫Ω ti·∫øn b·ªô! üí™','M·ªói c√¢u sai l√† c∆° h·ªôi ƒë·ªÉ nh·ªõ! üí™','ƒê·ª´ng b·ªè cu·ªôc, con ƒëang tr√™n ƒë∆∞·ªùng ti·∫øn b·ªô! üí™'];let message = pct >= 90 ? ppMsgs90[Math.floor(Math.random()*3)] : pct >= 70 ? ppMsgs70[Math.floor(Math.random()*3)] : pct >= 50 ? ppMsgs50[Math.floor(Math.random()*3)] : ppMsgsLow[Math.floor(Math.random()*3)];
  
  let wrongCount = total - score;
  
  let html = '<div style="text-align:center;padding-bottom:15px">' +
    '<div style="font-size:3rem;margin-bottom:10px">üíé</div>' +
    '<h2 style="color:white;margin:0">K·∫øt qu·∫£</h2></div>';
  
  html += '<div class="pp-result-card">' +
    '<div class="pp-result-stars">' + stars + '</div>' +
    '<div class="pp-result-score">' + pct + '%</div>' +
    '<div class="pp-result-label">' + message + '</div>' +
    '<div class="pp-result-detail">' +
    '<div class="rd-item"><div class="rd-num" style="color:#4CAF50">' + score + '</div><div class="rd-label">ƒê√∫ng ‚úÖ</div></div>' +
    '<div class="rd-item"><div class="rd-num" style="color:#F44336">' + wrongCount + '</div><div class="rd-label">Sai ‚ùå</div></div>' +
    '<div class="rd-item"><div class="rd-num" style="color:#00BCD4">' + total + '</div><div class="rd-label">T·ªïng</div></div>' +
    '</div>';

  // Review wrong answers
  let wrongAnswers = ppState.answers.filter(a => !a.correct);
  if (wrongAnswers.length > 0) {
    html += '<div style="text-align:left;margin-top:20px"><h3 style="margin:0 0 12px;color:#333">üìù √în l·∫°i c√¢u sai:</h3>';
    wrongAnswers.forEach(a => {
      html += '<div class="pp-review-item rv-wrong">' +
        '<div class="rv-q">' + a.q.q + '</div>' +
        '<div class="rv-a">‚ùå B·∫°n ch·ªçn: <b>' + a.q.opts[a.chosen] + '</b> ‚Üí ‚úÖ ƒê√°p √°n: <b>' + a.q.opts[a.q.ans] + '</b></div>' +
        '<div class="rv-a" style="color:#888;margin-top:3px">üí° ' + a.q.explain + '</div></div>';
    });
    html += '</div>';
  }
  
  html += '<div style="margin-top:20px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap">' +
    '<button style="padding:12px 28px;border-radius:25px;border:none;background:linear-gradient(135deg,#00BCD4,#009688);color:white;font-size:1rem;font-weight:700;cursor:pointer;font-family:Nunito,sans-serif" onclick="showPresentPerfectQuiz()">üîÑ L√†m l·∫°i</button>' +
    '<button style="padding:12px 28px;border-radius:25px;border:none;background:linear-gradient(135deg,#FF9800,#F57C00);color:white;font-size:1rem;font-weight:700;cursor:pointer;font-family:Nunito,sans-serif" onclick="goHome()">üè† V·ªÅ trang ch·ªß</button>' +
    '</div></div>';
  
  document.getElementById('quizArea').innerHTML = html;
  
  if (pct >= 70) { try { showConfetti(); } catch(e) {} }
  playSound('complete');
  
  // Save to mistake tracking
  ppState.answers.filter(a => !a.correct).forEach(a => {
    try {
      let mistakes = JSON.parse(localStorage.getItem('mistakes') || '[]');
      mistakes.push({
        date: new Date().toLocaleDateString('vi-VN'),
        type: 'Present Perfect',
        question: a.q.q,
        yourAnswer: a.q.opts[a.chosen],
        correctAnswer: a.q.opts[a.q.ans]
      });
      if (mistakes.length > 100) mistakes = mistakes.slice(-100);
      localStorage.setItem('mistakes', JSON.stringify(mistakes));
    } catch(e) {}
  });
}
</script>
</body>
</html>
